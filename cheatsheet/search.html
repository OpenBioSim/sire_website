<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Documentation" href="../api/index.html" /><link rel="prev" title="Detailed Guides" href="index.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>Searching - openbiosim - sire</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_fonts.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_style.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_pygments.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --font-stack: Changa, sans-serif;
  --font-stack--monospace: Roboto Mono, monospace;
  --color-foreground-primary: #dddddd;
  --color-foreground-secondary: #cccccc;
  --color-foreground-muted: #d0d0d0;
  --color-foreground-border: #923eb1;
  --color-background-primary: #160f30;
  --color-background-secondary: #201146;
  --color-background-hover: #4f4fb0;
  --color-background-hover--transparent: #4f4fb000;
  --color-background-border: #403333;
  --color-background-item: #411a30;
  --color-announcement-background: #000000dd;
  --color-announcement-text: #eeebee;
  --color-admonition-title-background--note: #FFFFFF33;
  --color-admonition-title-background--warning: #FF000033;
  --color-admonition-background: #FFFFFF11;
  --color-brand-primary: #eeeeee;
  --color-brand-content: #00dfef;
  --color-highlight-on-target: #333300;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">openbiosim - sire</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div>
<div class="sidebar-search">
  <div class="version_container">
    <div class="version_label">Branch</div>
    <div id="version_box" class="version_box"></div>
  </div>
</div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Quick Start Guide</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorial/index.html">Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorial/index_part01.html">Part 1 - Loading and Saving</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part01/01_importing_sire.html">Importing sire</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part01/02_loading_a_molecule.html">Loading a molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part01/03_simple_indexing.html">Simple indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part01/04_saving_a_molecule.html">Saving a molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part01/05_loading_from_multiple_files.html">Loading from multiple files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part01/06_supported_file_formats.html">Supported file formats</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorial/index_part02.html">Part 2 - Indexing and Searching</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/01_indexing_atoms.html">Indexing Atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/02_indexing_residues.html">Indexing Residues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/03_indexing_chains.html">Indexing Chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/04_indexing_segments.html">Indexing Segments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/05_indexing_molecules.html">Indexing Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/06_indexing_bonds.html">Indexing Bonds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/07_indexing_angles.html">Indexing Angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/08_indexing_dihedrals.html">Indexing Dihedrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/09_indexing_impropers.html">Indexing Impropers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/10_searching.html">Searching</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorial/index_part03.html">Part 3 - Molecular Properties</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/01_atom_properties.html">Atom Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/02_cursors.html">Cursors and Editing Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/03_residue_properties.html">Residue, Chain and Segment Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/04_molecule_properties.html">Molecule Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/05_bond_properties.html">Bond Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/06_angle_properties.html">Angle Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/07_dihedral_properties.html">Dihedral Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/08_improper_properties.html">Improper Views and Properties</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorial/index_part04.html">Part 4 - Measurement, Trajectories and Movement</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part04/01_measure.html">Measuring Distances and Angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part04/02_trajectory.html">Measuring Trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part04/03_energies.html">Measuring Energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part04/04_energy_trajectories.html">Measuring Energies Across Trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part04/05_movement.html">Moving Atoms and Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part04/06_move_internals.html">Moving Bonds, Angles and Dihedrals</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Detailed Guides</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Searching</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/sire.html">sire module</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/sire_modules.html">Sub-modules</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_base.html">sire.base</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/base.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_cas.html">sire.cas</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/cas.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_io.html">sire.io</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/io.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_maths.html">sire.maths</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/maths.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_mm.html">sire.mm</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/mm.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_mol.html">sire.mol</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/mol.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_search.html">sire.search</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/search.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_stream.html">sire.stream</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/stream.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_system.html">sire.system</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/system.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_units.html">sire.units</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/units.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_utils.html">sire.utils</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_vol.html">sire.vol</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/vol.html">Public API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../support.html">How to ask for help</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contributing/index.html">Contributing</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/development.html">Developer’s guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/codestyle.html">Coding Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/packaging.html">Packaging releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/roadmap.html">Roadmap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code_of_conduct.html">Code of Conduct</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">Acknowledgements</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="searching">
<h1>Searching<a class="headerlink" href="#searching" title="Permalink to this heading">#</a></h1>
<section id="views">
<h2>Views<a class="headerlink" href="#views" title="Permalink to this heading">#</a></h2>
<p>Searches are based on the concept of “views”:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">atom</span></code> - an individual atom</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bond</span></code> - an individual bond. Pairs of atoms can (optionally) be connected
together via bonds.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">residue</span></code> - an individual residue. Atoms (optionally) belong to residues.
Also sometimes shortened to <code class="docutils literal notranslate"><span class="pre">res</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chain</span></code> - an individual chain. Residues (optionally) belong to chains.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">segment</span></code> - an individual collection of atoms.
Also sometimes shortened to <code class="docutils literal notranslate"><span class="pre">seg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">molecule</span></code> - a complete molecule
Also sometimes shortened to <code class="docutils literal notranslate"><span class="pre">mol</span></code>.</p></li>
</ul>
</section>
<section id="identifiers">
<h2>Identifiers<a class="headerlink" href="#identifiers" title="Permalink to this heading">#</a></h2>
<p>Searches then use the different types of identifiers for views:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - the name of the view, e.g. <code class="docutils literal notranslate"><span class="pre">atomname</span> <span class="pre">CA</span></code> would match atoms
that are called <code class="docutils literal notranslate"><span class="pre">CA</span></code>, while <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">ALA</span></code> matches residues called <code class="docutils literal notranslate"><span class="pre">ALA</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num</span></code> - the number of the view, e.g. <code class="docutils literal notranslate"><span class="pre">atomnum</span> <span class="pre">35</span></code> matches atoms with
number <code class="docutils literal notranslate"><span class="pre">35</span></code>, while <code class="docutils literal notranslate"><span class="pre">molnum</span> <span class="pre">1</span></code> matches molecule number <code class="docutils literal notranslate"><span class="pre">1</span></code>. Note that
only atoms, residues and molecules have numbers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">idx</span></code> - the index of the view within its container, e.g.
<code class="docutils literal notranslate"><span class="pre">chainidx</span> <span class="pre">0</span></code> would match the first chain in the molecule, while
<code class="docutils literal notranslate"><span class="pre">segidx</span> <span class="pre">-1</span></code> would match the last segment.</p></li>
</ul>
<p>The names of these identifiers for each view are shown in this table.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>View</p></th>
<th class="head"><p>name</p></th>
<th class="head"><p>number</p></th>
<th class="head"><p>index</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>atom</p></td>
<td><p>atomname</p></td>
<td><p>atomnum</p></td>
<td><p>atomidx</p></td>
</tr>
<tr class="row-odd"><td><p>bond</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
<td><p>N/A</p></td>
</tr>
<tr class="row-even"><td><p>residue</p></td>
<td><p>rename</p></td>
<td><p>resnum</p></td>
<td><p>residx</p></td>
</tr>
<tr class="row-odd"><td><p>chain</p></td>
<td><p>chainname</p></td>
<td><p>N/A</p></td>
<td><p>chainidx</p></td>
</tr>
<tr class="row-even"><td><p>segment</p></td>
<td><p>segname</p></td>
<td><p>N/A</p></td>
<td><p>segidx</p></td>
</tr>
<tr class="row-odd"><td><p>molecule</p></td>
<td><p>molname</p></td>
<td><p>molnum</p></td>
<td><p>molidx</p></td>
</tr>
</tbody>
</table>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">bond</span></code> views cannot be identified directly by name,
number or index.</p>
</section>
<section id="numbers">
<h2>Numbers<a class="headerlink" href="#numbers" title="Permalink to this heading">#</a></h2>
<p>Numbers used in searches can be:</p>
<ul class="simple">
<li><p>Individual, e.g. <code class="docutils literal notranslate"><span class="pre">resnum</span> <span class="pre">35</span></code> searches for the residue with number <code class="docutils literal notranslate"><span class="pre">35</span></code>.</p></li>
<li><p>A range, e.g. <code class="docutils literal notranslate"><span class="pre">atomidx</span> <span class="pre">0:10</span></code> searches for atoms with indicies in the
range from 0 to 9, i.e. the half-open range <code class="docutils literal notranslate"><span class="pre">[0-10)</span></code>.</p></li>
<li><p>A stepped range, e.g. <code class="docutils literal notranslate"><span class="pre">molidx</span> <span class="pre">0:10:2</span></code> would search for molecules with
indicies 0, 2, 4, 6, and 8, i.e. the half-open range from 0 to 10 in
steps of 2.</p></li>
<li><p>A reverse range, e.g. <code class="docutils literal notranslate"><span class="pre">residx</span> <span class="pre">3:0:-1</span></code> would search for residues with
indicies 3, 2, or 1, i.e. the half-open range from 3 to 0 in steps of -1</p></li>
<li><p>An unbounded range, e.g. <code class="docutils literal notranslate"><span class="pre">molidx</span> <span class="pre">10:</span></code> would search for molecules with
indicies 10 upwards. Similarly, <code class="docutils literal notranslate"><span class="pre">residx</span> <span class="pre">3::-1</span></code> search from 3 downwards,
in steps of -1, so would match 3, 2, 1, or 0.</p></li>
<li><p>A list of numbers, e.g. <code class="docutils literal notranslate"><span class="pre">resnum</span> <span class="pre">12,14,20</span></code> would search for residues
with numbers 12, 14 or 20.</p></li>
<li><p>Any combination of the above, e.g. <code class="docutils literal notranslate"><span class="pre">molidx</span> <span class="pre">1,3,5,10:15,100:</span></code> would search
for molecules with indicies 1, 3 or 5, or in the half-open range from
<code class="docutils literal notranslate"><span class="pre">[10,15)</span></code>, or from 100 upwards.</p></li>
</ul>
</section>
<section id="strings">
<h2>Strings<a class="headerlink" href="#strings" title="Permalink to this heading">#</a></h2>
<p>Strings used in searches can be:</p>
<ul class="simple">
<li><p>Individual, e.g. <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">ALA</span></code> searches only for residues with name <code class="docutils literal notranslate"><span class="pre">ALA</span></code>.</p></li>
<li><p>A regular expression glob pattern, e.g. <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">/AL*/</span></code> matches any residues whose
name starts with <code class="docutils literal notranslate"><span class="pre">AL</span></code>. Similarly, <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">/HI[ESDP]/</span></code> matches any
residues whose names are <code class="docutils literal notranslate"><span class="pre">HI</span></code> followed by a <code class="docutils literal notranslate"><span class="pre">E</span></code>, <code class="docutils literal notranslate"><span class="pre">S</span></code>, <code class="docutils literal notranslate"><span class="pre">D</span></code> or <code class="docutils literal notranslate"><span class="pre">P</span></code>, i.e.
<code class="docutils literal notranslate"><span class="pre">HIE</span></code>, <code class="docutils literal notranslate"><span class="pre">HIS</span></code>, <code class="docutils literal notranslate"><span class="pre">HID</span></code> or <code class="docutils literal notranslate"><span class="pre">HIP</span></code>. This is implemented using Qt’s
<a class="reference external" href="https://doc.qt.io/qt-5/qregularexpression.html#wildcardToRegularExpression">wildCardToRegularExpression</a>
function, the syntax of which is <a class="reference external" href="https://en.wikipedia.org/wiki/Glob_(programming)">further described here</a>.</p></li>
<li><p>A case-insensitive regular expression glob pattern, e.g. <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">/ala/i</span></code> matches any
residue whose name (in any case) matches <code class="docutils literal notranslate"><span class="pre">ala</span></code>.</p></li>
<li><p>A list of names, e.g. <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">ALA,ARG,ASP</span></code> would match any residue whose
name was <code class="docutils literal notranslate"><span class="pre">ALA</span></code> or <code class="docutils literal notranslate"><span class="pre">ARG</span></code> or <code class="docutils literal notranslate"><span class="pre">ASP</span></code>.</p></li>
<li><p>Any combination of the above, e.g. <code class="docutils literal notranslate"><span class="pre">atomname</span> <span class="pre">N,/C*/i</span></code> would match atoms
whose names were <code class="docutils literal notranslate"><span class="pre">N</span></code> or names that started with <code class="docutils literal notranslate"><span class="pre">C</span></code> or <code class="docutils literal notranslate"><span class="pre">c</span></code>.</p></li>
</ul>
</section>
<section id="comparisons">
<h2>Comparisons<a class="headerlink" href="#comparisons" title="Permalink to this heading">#</a></h2>
<p>Numbers (and other values as discussed below) can also be used in comparisons
using the standard comparison operators:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">==</span></code> - compare equal, e.g. <code class="docutils literal notranslate"><span class="pre">resnum</span> <span class="pre">==</span> <span class="pre">3</span></code> matches residues with number 3.
Note you can compare strings too, e.g. <code class="docutils literal notranslate"><span class="pre">atomname</span> <span class="pre">==</span> <span class="pre">CA</span></code> matches atoms
called <code class="docutils literal notranslate"><span class="pre">CA</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">!=</span></code> - compare not equal, e.g. <code class="docutils literal notranslate"><span class="pre">atomnum</span> <span class="pre">!=</span> <span class="pre">5</span></code> matches all atoms which
don’t have a number 5. You can compare strings too, e.g.
<code class="docutils literal notranslate"><span class="pre">resnam</span> <span class="pre">!=</span> <span class="pre">ALA</span></code> matches all residues with names that are not equal
to <code class="docutils literal notranslate"><span class="pre">ALA</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&gt;</span></code> - compare greater than, e.g. <code class="docutils literal notranslate"><span class="pre">molidx</span> <span class="pre">&gt;</span> <span class="pre">5</span></code> matches all molecule
indicies greater than 5.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&gt;=</span></code> - compare greater or equal to, e.g <code class="docutils literal notranslate"><span class="pre">atomidx</span> <span class="pre">&gt;=</span> <span class="pre">10</span></code> matches all
atom indicies greater or equal to 10.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;</span></code> - compare less than, e.g. <code class="docutils literal notranslate"><span class="pre">segidx</span> <span class="pre">&lt;</span> <span class="pre">2</span></code> matches all segment
indicies that are less than 2.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;=</span></code> - compare less than or equal to, e.g. <code class="docutils literal notranslate"><span class="pre">molnum</span> <span class="pre">&lt;=</span> <span class="pre">100</span></code> matches
all molecule numbers less than or equal to 100.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">=~</span></code> compare approximately equal to, e.g. <code class="docutils literal notranslate"><span class="pre">atom</span> <span class="pre">mass</span> <span class="pre">=~</span> <span class="pre">16</span></code> matches
all atoms whose mass is approximately 16.</p></li>
</ul>
</section>
<section id="logical-operators">
<h2>Logical operators<a class="headerlink" href="#logical-operators" title="Permalink to this heading">#</a></h2>
<p>Searches can be combined using the logical operators <code class="docutils literal notranslate"><span class="pre">and</span></code>, <code class="docutils literal notranslate"><span class="pre">or</span></code> and
<code class="docutils literal notranslate"><span class="pre">not</span></code>. You can combine as many searches as you want. It is best
to use round brackets to specify order when combining lots of searchers.</p>
<p>For example,</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">X</span></code> - return views that don’t match <code class="docutils literal notranslate"><span class="pre">X</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">atomname</span> <span class="pre">CA</span></code>
matches all atoms whose name is not <code class="docutils literal notranslate"><span class="pre">CA</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">and</span> <span class="pre">Y</span></code> - return views that match search <code class="docutils literal notranslate"><span class="pre">X</span></code> and search <code class="docutils literal notranslate"><span class="pre">Y</span></code>, e.g.
<code class="docutils literal notranslate"><span class="pre">atomname</span> <span class="pre">CA</span> <span class="pre">and</span> <span class="pre">resname</span> <span class="pre">ALA</span></code> or <code class="docutils literal notranslate"><span class="pre">atomname</span> <span class="pre">N</span> <span class="pre">and</span> <span class="pre">(not</span> <span class="pre">resname</span> <span class="pre">HIS)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">or</span> <span class="pre">Y</span></code> - return views that match search <code class="docutils literal notranslate"><span class="pre">X</span></code> or search <code class="docutils literal notranslate"><span class="pre">Y</span></code>, e.g.
<code class="docutils literal notranslate"><span class="pre">atomnum</span> <span class="pre">5</span> <span class="pre">or</span> <span class="pre">atomname</span> <span class="pre">C</span></code> or <code class="docutils literal notranslate"><span class="pre">atomname</span> <span class="pre">N</span> <span class="pre">and</span> <span class="pre">(resname</span> <span class="pre">HIS</span> <span class="pre">or</span> <span class="pre">resnum</span> <span class="pre">5)</span></code>.
Note that passing a list of names or numbers is equivalent to passing
the names or numbers via <code class="docutils literal notranslate"><span class="pre">or</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">ALA</span> <span class="pre">or</span> <span class="pre">resname</span> <span class="pre">ASP</span></code> is
the same as <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">ALA,ASP</span></code>.</p></li>
</ul>
</section>
<section id="returned-view-types">
<h2>Returned View Types<a class="headerlink" href="#returned-view-types" title="Permalink to this heading">#</a></h2>
<p>Every search has a default view return type. This is the type of view
that is returned by that search. Atom-based searches return
<a class="reference internal" href="../api/mol.html#sire.mol.Atom" title="sire.mol.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> views, residue-based searches return
<a class="reference internal" href="../api/mol.html#sire.mol.Residue" title="sire.mol.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a> views etc.</p>
<p>When two searches with different return view types are combined, the smallest
view type is returned. So a residue-based search combined with
an atom-based search will return <a class="reference internal" href="../api/mol.html#sire.mol.Atom" title="sire.mol.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> views.
A molecule-based search combined with a chain-based search will return
<a class="reference internal" href="../api/mol.html#sire.mol.Chain" title="sire.mol.Chain"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chain</span></code></a> views.</p>
<p>Segment-based searches introduce complications, because they sit outside
of the Atom &lt; Residue &lt; Chain &lt; Molecule hierarchy. As such, a segment-based
search combined with any smaller view-type search will always return
<a class="reference internal" href="../api/mol.html#sire.mol.Atom" title="sire.mol.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a> views.</p>
<p>This table shows the return view type for any combination of two
searches.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td></td>
<td><p>Atom</p></td>
<td><p>Bond</p></td>
<td><p>Residue</p></td>
<td><p>Chain</p></td>
<td><p>Segment</p></td>
<td><p>Molecule</p></td>
</tr>
<tr class="row-even"><td><p>Atom</p></td>
<td><p>Atom</p></td>
<td><p>Atom</p></td>
<td><p>Atom</p></td>
<td><p>Atom</p></td>
<td><p>Atom</p></td>
<td><p>Atom</p></td>
</tr>
<tr class="row-odd"><td><p>Bond</p></td>
<td><p>Atom</p></td>
<td><p>Bond</p></td>
<td><p>Bond</p></td>
<td><p>Bond</p></td>
<td><p>Bond</p></td>
<td><p>Bond</p></td>
</tr>
<tr class="row-even"><td><p>Residue</p></td>
<td><p>Atom</p></td>
<td><p>Bond</p></td>
<td><p>Residue</p></td>
<td><p>Residue</p></td>
<td><p>Atom</p></td>
<td><p>Residue</p></td>
</tr>
<tr class="row-odd"><td><p>Chain</p></td>
<td><p>Atom</p></td>
<td><p>Bond</p></td>
<td><p>Residue</p></td>
<td><p>Chain</p></td>
<td><p>Atom</p></td>
<td><p>Chain</p></td>
</tr>
<tr class="row-even"><td><p>Segment</p></td>
<td><p>Atom</p></td>
<td><p>Bond</p></td>
<td><p>Atom</p></td>
<td><p>Atom</p></td>
<td><p>Segment</p></td>
<td><p>Segment</p></td>
</tr>
<tr class="row-odd"><td><p>Molecule</p></td>
<td><p>Atom</p></td>
<td><p>Bond</p></td>
<td><p>Residue</p></td>
<td><p>Chain</p></td>
<td><p>Segment</p></td>
<td><p>Molecule</p></td>
</tr>
</tbody>
</table>
</div>
<p>Combinations of more than two searches are always decomposed into
pairs of searches, which are combined using the precedence rules
of the grammar, and with a return view type as described in the
above table. To avoid confusion, it is better to indicate
your preferred precedence using round brackets, e.g.
use brackets to choose between <code class="docutils literal notranslate"><span class="pre">(atomname</span> <span class="pre">CA</span> <span class="pre">or</span> <span class="pre">atomname</span> <span class="pre">C)</span> <span class="pre">and</span> <span class="pre">resname</span> <span class="pre">ALA</span></code>
or <code class="docutils literal notranslate"><span class="pre">atomname</span> <span class="pre">CA</span> <span class="pre">or</span> <span class="pre">(atomname</span> <span class="pre">C</span> <span class="pre">and</span> <span class="pre">resname</span> <span class="pre">ALA)</span></code>.</p>
</section>
<section id="expansive-with-and-contractive-in-searches">
<h2>Expansive (<em class="xref py py-obj">with</em>) and Contractive (<em class="xref py py-obj">in</em>) Searches<a class="headerlink" href="#expansive-with-and-contractive-in-searches" title="Permalink to this heading">#</a></h2>
<p>Expansive searches are those which return results that are
at least the same size or larger than the original view being searched. For example, searching
for the molecule from an atom view will give a molecule result. This
is at least the same size (for single-atom molecules), but likely larger
(for multi-atom molecules) than the searched atom.</p>
<p>Contractive searches are those which return results that are
at most the same size or smaller than the original view being searched.
For example, searching for an atom from a molecule view will give an atom
result. This is at least the same size (for single-atom molecules), but
likely smaller (for multi-atom molecules) than the searched molecule.</p>
<p>Whether a search is expansive  (<code class="docutils literal notranslate"><span class="pre">with</span></code>) or contractive (<code class="docutils literal notranslate"><span class="pre">in</span></code>) depends on the relative
size of the view being searched, and the view that is being returned
as the result. This can be summarised as a table.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td></td>
<td><p>Atom</p></td>
<td><p>Bond</p></td>
<td><p>Residue</p></td>
<td><p>Chain</p></td>
<td><p>Segment</p></td>
<td><p>Molecule</p></td>
</tr>
<tr class="row-even"><td><p>Atom</p></td>
<td><p>N/A</p></td>
<td><p>atoms in bond</p></td>
<td><p>atoms in residue</p></td>
<td><p>atoms in chain</p></td>
<td><p>atoms in segment</p></td>
<td><p>atoms in molecule</p></td>
</tr>
<tr class="row-odd"><td><p>Bond</p></td>
<td><p>bonds with atom</p></td>
<td><p>N/A</p></td>
<td><p>bonds in residue</p></td>
<td><p>bonds in chain</p></td>
<td><p>bonds in segment</p></td>
<td><p>bonds in molecule</p></td>
</tr>
<tr class="row-even"><td><p>Residue</p></td>
<td><p>residues with atom</p></td>
<td><p>residues with bond</p></td>
<td><p>N/A</p></td>
<td><p>residues in chain</p></td>
<td><p>residues in segment</p></td>
<td><p>residues in molecule</p></td>
</tr>
<tr class="row-odd"><td><p>Chain</p></td>
<td><p>chains with atom</p></td>
<td><p>chains with bond</p></td>
<td><p>chains with residue</p></td>
<td><p>N/A</p></td>
<td><p>chains in segment</p></td>
<td><p>chains in molecule</p></td>
</tr>
<tr class="row-even"><td><p>Segment</p></td>
<td><p>segments with atomv</p></td>
<td><p>segments with bond</p></td>
<td><p>segments with residue</p></td>
<td><p>segments with chain</p></td>
<td><p>N/A</p></td>
<td><p>segments in molecule</p></td>
</tr>
<tr class="row-odd"><td><p>Molecule</p></td>
<td><p>molecules with atom</p></td>
<td><p>molecules with bond</p></td>
<td><p>molecules with residue</p></td>
<td><p>molecules with chain</p></td>
<td><p>molecules with segment</p></td>
<td><p>N/A</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">in</span> <span class="pre">Y</span></code> is a contractive search that looks for the smaller views of
type <code class="docutils literal notranslate"><span class="pre">X</span></code> within the larger view <code class="docutils literal notranslate"><span class="pre">Y</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">Y</span> <span class="pre">with</span> <span class="pre">X</span></code> is an expansive search that returns larger views of type
<code class="docutils literal notranslate"><span class="pre">X</span></code> that contain the smaller views of type <code class="docutils literal notranslate"><span class="pre">Y</span></code>.</p>
</div>
<p>Another way to think of this is that contractive searches are looking
inside a view, while expansive searches are looking outside a view
(looking for results with the original searched view contained within).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">in</span></code> and <code class="docutils literal notranslate"><span class="pre">with</span></code> keywords enable you to be explicit about the
contractive or expansive nature of a search.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">view_type</span> <span class="pre">in</span> <span class="pre">X</span></code> - perform a contractive search returning views of type <code class="docutils literal notranslate"><span class="pre">view_type</span></code>
within the results of the search <code class="docutils literal notranslate"><span class="pre">X</span></code>. Examples include; <code class="docutils literal notranslate"><span class="pre">atoms</span> <span class="pre">in</span> <span class="pre">resname</span> <span class="pre">ALA</span></code>
(return all of the atom views in residues that have name <code class="docutils literal notranslate"><span class="pre">ALA</span></code>);
<code class="docutils literal notranslate"><span class="pre">residues</span> <span class="pre">in</span> <span class="pre">chainidx</span> <span class="pre">0</span></code> (return all of the residue views in the first
chain); and <code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">in</span> <span class="pre">*</span></code> (return all of the bonds in the current view).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">view_type</span> <span class="pre">with</span> <span class="pre">X</span></code> - perform an expansive search returning views of type <code class="docutils literal notranslate"><span class="pre">view_type</span></code>
that contain the results of the search <code class="docutils literal notranslate"><span class="pre">X</span></code>. Examples include;
<code class="docutils literal notranslate"><span class="pre">residues</span> <span class="pre">with</span> <span class="pre">atomname</span> <span class="pre">CA</span></code> (return all of the residues that contain
atoms called <code class="docutils literal notranslate"><span class="pre">CA</span></code>); <code class="docutils literal notranslate"><span class="pre">molecules</span> <span class="pre">with</span> <span class="pre">resname</span> <span class="pre">ALA`</span></code> (return all of the
molecules with residues called <code class="docutils literal notranslate"><span class="pre">ALA</span></code>); and <code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">with</span> <span class="pre">atomname</span> <span class="pre">H</span></code></p>
<p>(return all of the bonds that contain at least one atom called <code class="docutils literal notranslate"><span class="pre">H</span></code>)</p>
</li>
</ul>
</section>
<section id="match-all-atoms-residues-chains-etc">
<h2>Match All Atoms, Residues, Chains etc.<a class="headerlink" href="#match-all-atoms-residues-chains-etc" title="Permalink to this heading">#</a></h2>
<p>You can match everything, specifying the return view type using the
“match all” keywords:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">atoms</span></code> - return all of the atoms in the searched object. Also abbreviated
to <code class="docutils literal notranslate"><span class="pre">atom</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bonds</span></code> - return all of the bonds in the searched object. Also abbreviated
to <code class="docutils literal notranslate"><span class="pre">bond</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">residues</span></code> - return all of the residues in the searched object. Also
abbreviated to <code class="docutils literal notranslate"><span class="pre">residue</span></code> or <code class="docutils literal notranslate"><span class="pre">res</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">chains</span></code> - return all of the chains in the searched object. Also
abbreviated to <code class="docutils literal notranslate"><span class="pre">chain</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">segments</span></code> - return all of the segments in the searched object.
Also abbreviated to <code class="docutils literal notranslate"><span class="pre">segment</span></code>, <code class="docutils literal notranslate"><span class="pre">segs</span></code> and <code class="docutils literal notranslate"><span class="pre">seg</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">molecules</span></code> - return all of the molecules in the searched object.
Also abbreviated to <code class="docutils literal notranslate"><span class="pre">molecule</span></code>, <code class="docutils literal notranslate"><span class="pre">mols</span></code> and <code class="docutils literal notranslate"><span class="pre">mol</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">all</span></code> or <code class="docutils literal notranslate"><span class="pre">*</span></code> - everything in the current view being searched.</p></li>
</ul>
<p>Whether these are expansive or contractive depends on the view that
is searched, based on the same rules as for normal searches
(e.g. searching for <code class="docutils literal notranslate"><span class="pre">residues</span></code> on an atoms view will be expansive,
as it returns all residues that contain those atoms, while searching
for <code class="docutils literal notranslate"><span class="pre">residues</span></code> on a molecule view will be contractive, as it searches
for all residues in that molecule)</p>
</section>
<section id="advanced-with-and-in-searches">
<h2>Advanced <code class="docutils literal notranslate"><span class="pre">with</span></code> and <code class="docutils literal notranslate"><span class="pre">in</span></code> Searches<a class="headerlink" href="#advanced-with-and-in-searches" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">with</span></code> and <code class="docutils literal notranslate"><span class="pre">in</span></code> can be used for more than just <code class="docutils literal notranslate"><span class="pre">view_type</span> <span class="pre">in</span> <span class="pre">X</span></code> searches.
The general syntax is <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">in</span> <span class="pre">Y</span></code> or <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">with</span> <span class="pre">Y</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">in</span> <span class="pre">Y</span></code> - search for views that match <code class="docutils literal notranslate"><span class="pre">X</span></code> in the results of the views
that match <code class="docutils literal notranslate"><span class="pre">Y</span></code>. An example would be <code class="docutils literal notranslate"><span class="pre">atomname</span> <span class="pre">CA</span> <span class="pre">in</span> <span class="pre">resname</span> <span class="pre">ALA</span></code> (find
atoms called <code class="docutils literal notranslate"><span class="pre">CA</span></code> in residues called <code class="docutils literal notranslate"><span class="pre">ALA</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">with</span> <span class="pre">Y</span></code> - search for views that match <code class="docutils literal notranslate"><span class="pre">Y</span></code> in the results of the views
that match <code class="docutils literal notranslate"><span class="pre">X</span></code>. An example would be <code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">ALA</span> <span class="pre">with</span> <span class="pre">atomname</span> <span class="pre">CA</span></code>
(find residues called <code class="docutils literal notranslate"><span class="pre">ALA</span></code> in all of the residues that contain atoms
called <code class="docutils literal notranslate"><span class="pre">CA</span></code>)</p></li>
</ul>
<p>Understanding this, you can see that <code class="docutils literal notranslate"><span class="pre">residues</span> <span class="pre">with</span> <span class="pre">atomname</span> <span class="pre">CA</span></code> is a search
that finds all residues that are with (contain) the results of searching for atoms
with name <code class="docutils literal notranslate"><span class="pre">CA</span></code>. Similarly <code class="docutils literal notranslate"><span class="pre">atoms</span> <span class="pre">in</span> <span class="pre">resname</span> <span class="pre">ALA</span></code> is searching for all atoms
that are in the results of searching for residues with name <code class="docutils literal notranslate"><span class="pre">ALA</span></code>.
Similarly <code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">in</span> <span class="pre">*</span></code> means search for all bonds that are in the
current view (as <code class="docutils literal notranslate"><span class="pre">*</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code> is returns the view being searched).</p>
</section>
<section id="searching-for-bonds-using-in-with-from-and-to">
<h2>Searching for Bonds using <code class="docutils literal notranslate"><span class="pre">in</span></code>, <code class="docutils literal notranslate"><span class="pre">with</span></code>, <code class="docutils literal notranslate"><span class="pre">from</span></code> and <code class="docutils literal notranslate"><span class="pre">to</span></code><a class="headerlink" href="#searching-for-bonds-using-in-with-from-and-to" title="Permalink to this heading">#</a></h2>
<p>Searches involving bonds are more complex as they involve bridging
between (potentially) two views. At the most basic, they always
involve connecting two atoms. But this bond could be entirely within
a residue, or between pairs of residues (and similarly for chains
and segments).</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">with</span> <span class="pre">X</span></code> - an expansive search that finds all bonds that
contains the result of <code class="docutils literal notranslate"><span class="pre">X</span></code>. As the only view smaller than a bond
is an atom, <code class="docutils literal notranslate"><span class="pre">X</span></code> can only be a search that returns atom views.
For example, <code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">with</span> <span class="pre">atomname</span> <span class="pre">CA</span></code> would return all bonds
where at least one of the atoms in the bond was called <code class="docutils literal notranslate"><span class="pre">CA</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">in</span> <span class="pre">X</span></code> - a contractive search that finds all bonds that
are contained wholly within the result of searching for <code class="docutils literal notranslate"><span class="pre">X</span></code>,
e.g. <code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">in</span> <span class="pre">residx</span> <span class="pre">0</span></code> returns all bonds that are wholly
within (both atoms within) the first residue.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">with</span> <span class="pre">atoms</span> <span class="pre">in</span> <span class="pre">X</span></code> - an expansive search that finds all bonds</dt><dd><p>involving any atoms that is returned by the search <code class="docutils literal notranslate"><span class="pre">X</span></code>. For example,
<code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">with</span> <span class="pre">atoms</span> <span class="pre">in</span> <span class="pre">resname</span> <span class="pre">ALA</span></code> returns all bonds that have
any atoms in residues called <code class="docutils literal notranslate"><span class="pre">ALA</span></code>.</p>
</dd>
</dl>
</li>
</ul>
<p>The above two searches find either all the bonds inside <code class="docutils literal notranslate"><span class="pre">X</span></code>, or
all the bonds that involve atoms in <code class="docutils literal notranslate"><span class="pre">X</span></code>. We need other keywords
to find the bonds that specifically bridge between two views.
These are <code class="docutils literal notranslate"><span class="pre">to</span></code> and <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">..</span> <span class="pre">to</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">to</span> <span class="pre">X</span></code> - a search that returns all bonds that have one
atom contained in <code class="docutils literal notranslate"><span class="pre">X</span></code> and one atom that is not contained in <code class="docutils literal notranslate"><span class="pre">X</span></code>
(i.e. all bonds that connect <code class="docutils literal notranslate"><span class="pre">X</span></code> to another view). For example,
<code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">to</span> <span class="pre">resnum</span> <span class="pre">1</span></code> returns all bonds that connect residue number
1 to any other residue (or view).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">from</span> <span class="pre">X</span> <span class="pre">to</span> <span class="pre">Y</span></code> - a search that returns all bonds that have
one atom in <code class="docutils literal notranslate"><span class="pre">X</span></code> and one atom in <code class="docutils literal notranslate"><span class="pre">Y</span></code>, i.e. that connect <code class="docutils literal notranslate"><span class="pre">X</span></code>
and <code class="docutils literal notranslate"><span class="pre">Y</span></code>. For example, <code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">from</span> <span class="pre">resnum</span> <span class="pre">1</span> <span class="pre">to</span> <span class="pre">resnum</span> <span class="pre">2</span></code> returns
all the bonds between residue numbers 1 and 2.</p></li>
</ul>
</section>
<section id="searching-by-chemical-element">
<h2>Searching by Chemical Element<a class="headerlink" href="#searching-by-chemical-element" title="Permalink to this heading">#</a></h2>
<p>You can search for views that match or contain atoms with specified
chemical elements. You do this using <code class="docutils literal notranslate"><span class="pre">element</span></code>. This search
returns atom views. For example, <code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">C</span></code> would return all atom views
that have the chemical element carbon.</p>
<p>The chemical element can be specified in a number of different ways:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">C</span></code> - specify the chemical element by its IUPAC symbol, e.g.
<code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">H</span></code>, <code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">Na</span></code> etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">c</span></code> - specify the chemical element using its lowercase
symbol, e.g. <code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">h</span></code>, <code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">na</span></code> etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">carbon</span></code> - specify the chemical element using its lowercase
name, e.g. <code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">hydrogen</span></code>, <code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">sodium</span></code> etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">C,</span> <span class="pre">H,</span> <span class="pre">Na</span></code> - specify a list of elements. The atoms returned
are those that match any in the list. The list can use any of the
ways of specifying elements as above, e.g. <code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">carbon,</span> <span class="pre">hydrogen</span></code>
would be valid, as would <code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">carbon,</span> <span class="pre">H,</span> <span class="pre">na</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">biological</span></code> - specify the elements that are considered to
be “biological”, i.e. those in period 3 or less, which are not
halogens or noble gases (the same definition used by the
<a class="reference internal" href="../api/mol.html#sire.mol.Element.biological" title="sire.mol.Element.biological"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.mol.Element.biological()</span></code></a> function). Note you can use
the shorthand <code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">bio</span></code> to also match biological atoms.</p></li>
</ul>
</section>
<section id="searching-by-count-i-e-number-of-atoms">
<h2>Searching by Count (i.e. Number of Atoms)<a class="headerlink" href="#searching-by-count-i-e-number-of-atoms" title="Permalink to this heading">#</a></h2>
<p>You can search by counts, e.g. finding all molecules with more than
one residue, using <code class="docutils literal notranslate"><span class="pre">count</span></code>.</p>
<p>You can do simple searches of the form <code class="docutils literal notranslate"><span class="pre">view_type</span> <span class="pre">with/in</span> <span class="pre">count(view_type)</span> <span class="pre">compare</span> <span class="pre">number</span></code>, e.g.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">molecules</span> <span class="pre">with</span> <span class="pre">count(residues)</span> <span class="pre">&gt;</span> <span class="pre">1</span></code> - match all molecules that
contain more than on residue</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">atoms</span> <span class="pre">in</span> <span class="pre">count(residues)</span> <span class="pre">==</span> <span class="pre">1</span></code> - match all atoms that are in molecules
that contain just one residue</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">residues</span> <span class="pre">in</span> <span class="pre">molecules</span> <span class="pre">with</span> <span class="pre">count(atoms)</span> <span class="pre">&lt;</span> <span class="pre">20</span></code> - match all residues that
are in molecules with less than twenty atoms</p></li>
</ul>
<p>You can also use more advanced <code class="docutils literal notranslate"><span class="pre">with/in</span></code> searches, e.g.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">C</span> <span class="pre">in</span> <span class="pre">residues</span> <span class="pre">with</span> <span class="pre">count(atoms)</span> <span class="pre">&gt;</span> <span class="pre">5</span></code> - match all carbon atoms
in residues that have more than five atoms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">O</span> <span class="pre">in</span> <span class="pre">molecules</span> <span class="pre">with</span> <span class="pre">count(atoms)</span> <span class="pre">==</span> <span class="pre">3</span></code> - match all oxygen atoms
in molecules that have three atoms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">/ALA/i</span> <span class="pre">in</span> <span class="pre">molecules</span> <span class="pre">with</span> <span class="pre">count(residues)</span> <span class="pre">&gt;</span> <span class="pre">20</span></code> - match all
residues call <code class="docutils literal notranslate"><span class="pre">ALA</span></code> (in any case) in molecules that have more
than 20 residues.</p></li>
</ul>
<p>In the general case, the argument to <code class="docutils literal notranslate"><span class="pre">count</span></code> is actually a search too!
So the full syntax is <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">with/in</span> <span class="pre">count(Y)</span> <span class="pre">compare</span> <span class="pre">number</span></code>, which
returns views that match <code class="docutils literal notranslate"><span class="pre">X</span></code> where the count of views that match <code class="docutils literal notranslate"><span class="pre">Y</span></code>
in the view being searched compares true with the specified number.
For example;</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">residues</span> <span class="pre">with</span> <span class="pre">count(element</span> <span class="pre">C)</span> <span class="pre">&gt;</span> <span class="pre">2</span></code> - match all residues that contain
more than two carbon atoms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">atoms</span> <span class="pre">in</span> <span class="pre">residues</span> <span class="pre">with</span> <span class="pre">count(atomname</span> <span class="pre">CA)</span> <span class="pre">==</span> <span class="pre">1</span></code> - match all atoms
in residues that contain a single atom called <code class="docutils literal notranslate"><span class="pre">CA</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(molecules</span> <span class="pre">with</span> <span class="pre">count(element</span> <span class="pre">O)</span> <span class="pre">==</span> <span class="pre">1)</span> <span class="pre">and</span> <span class="pre">(molecules</span> <span class="pre">with</span> <span class="pre">count(element</span> <span class="pre">H)</span> <span class="pre">==</span> <span class="pre">2)</span> <span class="pre">and</span> <span class="pre">(molecules</span> <span class="pre">with</span> <span class="pre">count(atoms)</span> <span class="pre">==</span> <span class="pre">3)</span></code> -
match all molecules that contain there atoms, and that have one oxygen atom
and have two hydrogen atoms (i.e. are water molecules).</p></li>
</ul>
</section>
<section id="searching-by-charge-or-mass">
<h2>Searching by Charge or Mass<a class="headerlink" href="#searching-by-charge-or-mass" title="Permalink to this heading">#</a></h2>
<p>You can search for views by their charge or mass using the <code class="docutils literal notranslate"><span class="pre">charge</span></code> or
<code class="docutils literal notranslate"><span class="pre">mass</span></code> keywords. The grammar is <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">with</span> <span class="pre">charge</span> <span class="pre">compare</span> <span class="pre">number</span></code>
or <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">with</span> <span class="pre">mass</span> <span class="pre">Y</span> <span class="pre">compare</span> <span class="pre">number</span></code>, where <code class="docutils literal notranslate"><span class="pre">X</span></code> is the view (or views)
you want to calculate the mass or charge for, <code class="docutils literal notranslate"><span class="pre">compare</span></code> is the
comparison operator (e.g. <code class="docutils literal notranslate"><span class="pre">==</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code> etc.), and <code class="docutils literal notranslate"><span class="pre">number</span></code> is the
value of the charge or mass you want to compare to. For example,</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">atoms</span> <span class="pre">with</span> <span class="pre">charge</span> <span class="pre">&lt;</span> <span class="pre">0</span></code> - return all atoms that have a change that
is less than zero.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">atoms</span> <span class="pre">with</span> <span class="pre">mass</span> <span class="pre">&gt;</span> <span class="pre">4</span></code> - return all atoms that have a mass that is
greater than <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">g</span> <span class="pre">mol-1</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">residues</span> <span class="pre">with</span> <span class="pre">charge</span> <span class="pre">&gt;=</span> <span class="pre">0.8</span></code> - return all residues that have a total
charge of greater than or equal to <code class="docutils literal notranslate"><span class="pre">0.8</span> <span class="pre">|e|</span></code> (modulo electron charge units).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">molecules</span> <span class="pre">with</span> <span class="pre">mass</span> <span class="pre">&lt;</span> <span class="pre">50</span></code> - return all molecules whose total mass is
less than <code class="docutils literal notranslate"><span class="pre">50</span> <span class="pre">g</span> <span class="pre">mol-1</span></code>.</p></li>
</ul>
<p>In the general case, <code class="docutils literal notranslate"><span class="pre">X</span></code> can be any search. So you could use,</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">C</span> <span class="pre">with</span> <span class="pre">charge</span> <span class="pre">&gt;</span> <span class="pre">0.1</span></code> - return all carbon atoms with a charge
greater than <code class="docutils literal notranslate"><span class="pre">0.1</span> <span class="pre">|e|</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resname</span> <span class="pre">LIG</span> <span class="pre">with</span> <span class="pre">mass</span> <span class="pre">&gt;</span> <span class="pre">100</span></code> - return all residues called <code class="docutils literal notranslate"><span class="pre">LIG</span></code>
that have a mass greater than <code class="docutils literal notranslate"><span class="pre">100</span> <span class="pre">g</span> <span class="pre">mol-1</span></code>.</p></li>
</ul>
<p>You could also combine this with other searches, e.g.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mols</span> <span class="pre">with</span> <span class="pre">count(residues</span> <span class="pre">with</span> <span class="pre">charge</span> <span class="pre">&gt;</span> <span class="pre">0.5)</span> <span class="pre">&gt;</span> <span class="pre">5</span></code> - return all molecules
with more than five residues that have a charge of more than <code class="docutils literal notranslate"><span class="pre">0.5</span> <span class="pre">|e|</span></code>.</p></li>
</ul>
<p>Numerical imprecision can cause issues with <code class="docutils literal notranslate"><span class="pre">charge</span></code> searches.
This is because rounding errors can mean that the sum of charges across,
e.g. a residue or molecule, are non-integer. For example, for
the <code class="docutils literal notranslate"><span class="pre">aladip</span></code> example used in the tutorials, the charges of the first
two residues are <code class="docutils literal notranslate"><span class="pre">5.48778e-10</span></code> and <code class="docutils literal notranslate"><span class="pre">-1.09756e-09</span></code>. Searches for
residues with zero charge, or with negative charge would fail for
these two residues.</p>
</section>
<section id="searching-by-charge-using-approximate-comparisons">
<h2>Searching by Charge using Approximate Comparisons<a class="headerlink" href="#searching-by-charge-using-approximate-comparisons" title="Permalink to this heading">#</a></h2>
<p>The approximate comparison operators can help solve the numerical
imprecision issues experienced when searching for views by charge.</p>
<p>The approximate comparison operators are;</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">=~</span></code> - approximate equal to. <a class="reference internal" href="../api/search.html#sire.search.approx_equal" title="sire.search.approx_equal"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.approx_equal()</span></code></a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">!~</span></code> - not approximates equal to. <code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search_approx_not_equal()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&gt;~</span></code> - greater than (but not approximately equal to). <code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.approx_greater()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;~</span></code> - less than (but not approximately equal to). <code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.approx_less()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&gt;=~</span></code> - greater than or approximately equal to. <code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.approx_greater_equal()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;=~</span></code> - less than or approximatley equal to. <code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.approx_less_equal()</span></code></p></li>
</ul>
<p>These operators are logically consistent. They are built from
the approximately equal to operator (<code class="docutils literal notranslate"><span class="pre">=~</span></code>). This returns <code class="docutils literal notranslate"><span class="pre">True</span></code>
if the two values compared are equal, or are equal to within an
epsilon value. This is set via <a class="reference internal" href="../api/search.html#sire.search.set_approx_epsilon" title="sire.search.set_approx_epsilon"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.set_approx_epsilon()</span></code></a> and
can be retrieved using <a class="reference internal" href="../api/search.html#sire.search.get_approx_epsilon" title="sire.search.get_approx_epsilon"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.get_approx_epsilon()</span></code></a>.</p>
<p>These operators can be used to, e.g.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mols</span> <span class="pre">with</span> <span class="pre">charge</span> <span class="pre">=~</span> <span class="pre">0</span></code> - find all neutral molecules</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">residues</span> <span class="pre">with</span> <span class="pre">charge</span> <span class="pre">&gt;~</span> <span class="pre">0</span></code> - find all positively charged residues</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(molecules</span> <span class="pre">with</span> <span class="pre">count(atoms)</span> <span class="pre">==</span> <span class="pre">1)</span> <span class="pre">with</span> <span class="pre">charge</span> <span class="pre">=~</span> <span class="pre">1</span></code> - all <code class="docutils literal notranslate"><span class="pre">+1</span></code> charge ions</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Brackets were used for the last search to ensure that we look for
single-atom molecules first, and then, from these, find those that
have a charge of +1.</p>
</div>
</section>
<section id="searching-by-property">
<h2>Searching by Property<a class="headerlink" href="#searching-by-property" title="Permalink to this heading">#</a></h2>
<p>You can search for views based on any of the properties of those views.
There are several routes to do this;</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">with</span> <span class="pre">property</span> <span class="pre">name</span></code> - return all views that have a property
called <code class="docutils literal notranslate"><span class="pre">name</span></code>, and if so, the value of this property is not
<code class="docutils literal notranslate"><span class="pre">False</span></code> or <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">0.0</span></code>, or the string <code class="docutils literal notranslate"><span class="pre">false</span></code> in any case.
For example, <code class="docutils literal notranslate"><span class="pre">molecules</span> <span class="pre">with</span> <span class="pre">property</span> <span class="pre">is_perturbable</span></code> would
return all molecules that have the <code class="docutils literal notranslate"><span class="pre">is_perturbable</span></code> property
and that it wasn’t false. <code class="docutils literal notranslate"><span class="pre">atoms</span> <span class="pre">with</span> <span class="pre">property</span> <span class="pre">atomtype</span></code>
would return all atoms that have an <code class="docutils literal notranslate"><span class="pre">atomtype</span></code> property, t
and if so, that it wasn’t false.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">with</span> <span class="pre">property</span> <span class="pre">name</span> <span class="pre">compare</span> <span class="pre">value</span></code> - return all views that have
a property called <code class="docutils literal notranslate"><span class="pre">name</span></code>, and where the value of the property
compares truthfully using the comparison operator <code class="docutils literal notranslate"><span class="pre">compare</span></code>
against the value <code class="docutils literal notranslate"><span class="pre">value</span></code>. For example,
<code class="docutils literal notranslate"><span class="pre">residues</span> <span class="pre">with</span> <span class="pre">property</span> <span class="pre">is_default</span> <span class="pre">==</span> <span class="pre">False</span></code> would return
all residues that have an <code class="docutils literal notranslate"><span class="pre">is_default</span></code> property, and this
property is equal to <code class="docutils literal notranslate"><span class="pre">False</span></code>. Searching for
<code class="docutils literal notranslate"><span class="pre">atoms</span> <span class="pre">with</span> <span class="pre">property</span> <span class="pre">radius</span> <span class="pre">&gt;</span> <span class="pre">0.5</span></code> would return all atoms
that have a <code class="docutils literal notranslate"><span class="pre">residue</span></code> property, and the value of this is
greater than <code class="docutils literal notranslate"><span class="pre">0.5</span></code>, while <code class="docutils literal notranslate"><span class="pre">atoms</span> <span class="pre">with</span> <span class="pre">property</span> <span class="pre">atomtype</span> <span class="pre">==</span> <span class="pre">HA</span></code>
would return all atoms with an <code class="docutils literal notranslate"><span class="pre">atomtype</span></code> property which
is equal to <code class="docutils literal notranslate"><span class="pre">HA</span></code>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values in property searches should be in the default units
for the property being searched (e.g. <code class="docutils literal notranslate"><span class="pre">radius</span> <span class="pre">&gt;</span> <span class="pre">0.5</span></code> is in
units of Å as this is the default length unit). Remember this
if you change the default length unit, i.e. if the default
length unit is picometers, then the above search would be
<code class="docutils literal notranslate"><span class="pre">radius</span> <span class="pre">&gt;</span> <span class="pre">50</span></code>.</p>
</div>
</section>
<section id="finding-the-nth-view-that-matches">
<h2>Finding the Nth View that Matches<a class="headerlink" href="#finding-the-nth-view-that-matches" title="Permalink to this heading">#</a></h2>
<p>You can use subscripting to pick out the nth view that matches a particular
search. The grammar is <code class="docutils literal notranslate"><span class="pre">X[i]</span></code> where <code class="docutils literal notranslate"><span class="pre">X</span></code> is the search, and <code class="docutils literal notranslate"><span class="pre">i</span></code>
is the index of the result you want to match.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">element</span> <span class="pre">C[0]</span></code> - return the first carbon atom</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(resname</span> <span class="pre">ALA)[-1]</span></code> - return the last residue called <code class="docutils literal notranslate"><span class="pre">ALA</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(bonds</span> <span class="pre">with</span> <span class="pre">element</span> <span class="pre">H)[0:5]</span></code> - return the first five bonds that
contain hydrogen.</p></li>
</ul>
</section>
<section id="searching-by-distance">
<h2>Searching by Distance<a class="headerlink" href="#searching-by-distance" title="Permalink to this heading">#</a></h2>
<p>You can search for views based on their distances to either each other,
or to fixed points in space. There are a few variants of this search.</p>
<p>The first is <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">within</span> <span class="pre">D</span> <span class="pre">of</span> <span class="pre">Y</span></code>. This returns views that match <code class="docutils literal notranslate"><span class="pre">X</span></code> that are
within the specified distance <code class="docutils literal notranslate"><span class="pre">D</span></code> (in default length units) of views that match
<code class="docutils literal notranslate"><span class="pre">Y</span></code>. Examples include <code class="docutils literal notranslate"><span class="pre">waters</span> <span class="pre">within</span> <span class="pre">5</span> <span class="pre">of</span> <span class="pre">resname</span> <span class="pre">ALA</span></code>, which finds
all water molecules within 5 Å of residues called <code class="docutils literal notranslate"><span class="pre">ALA</span></code>. Or
<code class="docutils literal notranslate"><span class="pre">(element</span> <span class="pre">H</span> <span class="pre">in</span> <span class="pre">water)</span> <span class="pre">within</span> <span class="pre">3</span> <span class="pre">of</span> <span class="pre">(element</span> <span class="pre">O,</span> <span class="pre">Cl,</span> <span class="pre">F</span> <span class="pre">in</span> <span class="pre">protein)</span></code>
which finds all hydrogen atoms in water molecules that are within
3 Å of all oxygen, chlorine or fluorine atoms in protein molecules.</p>
<p>The distance criterion used is whether any atoms in the view <code class="docutils literal notranslate"><span class="pre">X</span></code> is
within the specified distance of any atom in the view <code class="docutils literal notranslate"><span class="pre">Y</span></code>.</p>
<p>You can specify the distance criterion using searches of form
<code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">where</span> <span class="pre">CRITERION</span> <span class="pre">within</span> <span class="pre">D</span> <span class="pre">of</span> <span class="pre">Y</span></code>. The <code class="docutils literal notranslate"><span class="pre">CRITERION</span></code> has many possible
values;</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">center</span></code> - the geometric center of the atoms in the two views will
be compared, e.g. <code class="docutils literal notranslate"><span class="pre">waters</span> <span class="pre">where</span> <span class="pre">center</span> <span class="pre">within</span> <span class="pre">5</span> <span class="pre">of</span> <span class="pre">resname</span> <span class="pre">ALA</span></code> finds
all waters whose geometric centers are within 5 Å of the geometric
centers of all <code class="docutils literal notranslate"><span class="pre">ALA</span></code> residues combined.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max</span></code> - the maximum coordinates of the two views will be compared,
e.g. <code class="docutils literal notranslate"><span class="pre">atoms</span> <span class="pre">where</span> <span class="pre">max</span> <span class="pre">within</span> <span class="pre">5</span> <span class="pre">of</span> <span class="pre">protein</span></code> finds all atoms that
are within 5 Å of the maximum coordinates of all proteins combined.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min</span></code> - the minimum coordinates.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">A.x</span></code>, <code class="docutils literal notranslate"><span class="pre">A.y</span></code>, <code class="docutils literal notranslate"><span class="pre">A.z</span></code> - compare specifically the x, y or z
dimensions only, e.g. <code class="docutils literal notranslate"><span class="pre">center.x</span></code> compares only the x dimension
of the centers of the views, while <code class="docutils literal notranslate"><span class="pre">max.y</span></code> would compare the
y dimension of the maximum, and <code class="docutils literal notranslate"><span class="pre">min.z</span></code> would be the z dimension
of the minimum.</p></li>
</ul>
<p>You can compare against fixed points in space by passing in a vector
in place of <code class="docutils literal notranslate"><span class="pre">Y</span></code>. For example, <code class="docutils literal notranslate"><span class="pre">atoms</span> <span class="pre">within</span> <span class="pre">10</span> <span class="pre">of</span> <span class="pre">(0,0,0)</span></code>
would find all atoms within 10 Å of the origin, while
<code class="docutils literal notranslate"><span class="pre">waters</span> <span class="pre">within</span> <span class="pre">3</span> <span class="pre">of</span> <span class="pre">(5.3,</span> <span class="pre">9.8,</span> <span class="pre">-2.1)</span></code> would find all water molecules
within 3 Å of the point <code class="docutils literal notranslate"><span class="pre">(5.3,</span> <span class="pre">9.8,</span> <span class="pre">-2.1)</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All distance searches use the first <code class="docutils literal notranslate"><span class="pre">space</span></code> property that can be
found in the views to calculate distances. This should ensure that
periodic boundaries are accounted for in the search. You can specify
the space to use by passing this in via a property map.</p>
</div>
</section>
<section id="searching-for-water-or-protein-molecules">
<h2>Searching for Water or Protein Molecules<a class="headerlink" href="#searching-for-water-or-protein-molecules" title="Permalink to this heading">#</a></h2>
<p>You can search for protein or water molecules using the <code class="docutils literal notranslate"><span class="pre">protein</span></code>
or <code class="docutils literal notranslate"><span class="pre">water</span></code> keywords.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">water</span></code> - search for all water molecules. These are defined as
molecules that contain one oxygen, two hydrogen and any number
of null-element (dummy) atoms.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">protein</span></code> - search for all protein molecules. These are defined
as molecules that contain a minimum number of residues whose
names are found in the list of possible protein residue names.</p></li>
</ul>
<p>You can get and set the minimum number of protein residues to match
using the <a class="reference internal" href="../api/search.html#sire.search.get_min_protein_residues" title="sire.search.get_min_protein_residues"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.get_min_protein_residues()</span></code></a> and
<a class="reference internal" href="../api/search.html#sire.search.set_min_protein_residues" title="sire.search.set_min_protein_residues"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.set_min_protein_residues()</span></code></a> functions. The default
minimum is 5.</p>
<p>You can get and set the list of protein residue names using the
<a class="reference internal" href="../api/search.html#sire.search.get_protein_residue_names" title="sire.search.get_protein_residue_names"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.get_protein_residue_names()</span></code></a> and
<a class="reference internal" href="../api/search.html#sire.search.set_protein_residue_names" title="sire.search.set_protein_residue_names"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.set_protein_residue_names()</span></code></a> functions. The names
are searched via a case-insensitive search. The default list
are the standard names of the biological amino acids, including
names commonly used for protonated or deprotonated residues.</p>
</section>
<section id="creating-custom-search-tokens">
<h2>Creating Custom Search Tokens<a class="headerlink" href="#creating-custom-search-tokens" title="Permalink to this heading">#</a></h2>
<p>You can create and use your own search tokens! You set new search tokens
using <a class="reference internal" href="../api/search.html#sire.search.set_token" title="sire.search.set_token"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.set_token()</span></code></a>, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sire</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">set_token</span><span class="p">(</span><span class="s2">&quot;CH-bonds&quot;</span><span class="p">,</span> <span class="s2">&quot;bonds from element C to element H&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>would create a new search token called <code class="docutils literal notranslate"><span class="pre">CH-bonds</span></code> that finds all bonds
between carbon and hydrogen atoms. You could then use this token just
like any other token, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;CH-bonds in protein&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>would return all the carbon-hydrogen bonds in protein molecules.</p>
<p>Token names cannot contain spaces, and must start with a letter (i.e.
that can’t start with numbers or symbols). Token names cannot be valid
search terms themselves - meaning you can’t use custom tokens to redefine
the above tokens or grammar. They also can’t start with any existing search
term or token. This means that, once set, you cannot
set the token again, or, indeed, set any token that starts with this token.
To change a token you first have to delete it
using the <a class="reference internal" href="../api/search.html#sire.search.delete_token" title="sire.search.delete_token"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.delete_token()</span></code></a> function, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sire</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">delete_token</span><span class="p">(</span><span class="s2">&quot;CH-bonds&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function will silently do nothing if the token doesn’t exist,
or if you attempt to delete an built-in token. You cannot delete
built-in tokens, e.g. like <code class="docutils literal notranslate"><span class="pre">protein</span></code> or <code class="docutils literal notranslate"><span class="pre">water</span></code>.</p>
</div>
<p>You can use <a class="reference internal" href="../api/search.html#sire.search.delete_all_tokens" title="sire.search.delete_all_tokens"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.delete_all_tokens()</span></code></a> to delete all
custom search tokens.</p>
<p>The function <a class="reference internal" href="../api/search.html#sire.search.has_token" title="sire.search.has_token"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.has_token()</span></code></a> will query whether or not
a particular token exists.</p>
<p>The function <a class="reference internal" href="../api/search.html#sire.search.get_token" title="sire.search.get_token"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.get_token()</span></code></a> will return the search term
that corresponds to the passed token, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sire</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">set_token</span><span class="p">(</span><span class="s2">&quot;CH-bonds&quot;</span><span class="p">,</span> <span class="s2">&quot;bonds from element C to element H&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sire</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="s2">&quot;CH-bonds&quot;</span><span class="p">))</span>
<span class="go">bonds from element C to element H</span>
</pre></div>
</div>
<p>Tokens are expanded when they are used as part of other tokens, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sire</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">set_token</span><span class="p">(</span><span class="s2">&quot;p-CH-bonds&quot;</span><span class="p">,</span> <span class="s2">&quot;CH-bonds in protein&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sire</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="s2">&quot;p-CH-bonds&quot;</span><span class="p">))</span>
<span class="go">({ CH-bonds =&gt; bonds from element C to element H }) in (protein)</span>
</pre></div>
</div>
<p>This shows that <code class="docutils literal notranslate"><span class="pre">CH-bonds</span></code> is <code class="docutils literal notranslate"><span class="pre">bonds</span> <span class="pre">from</span> <span class="pre">element</span> <span class="pre">C</span> <span class="pre">to</span> <span class="pre">element</span> <span class="pre">H</span></code>.</p>
<p>Deleting or changing the token later does not affect any pre-existing
tokens that used it, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sire</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">delete_token</span><span class="p">(</span><span class="s2">&quot;CH-bonds&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sire</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="s2">&quot;p-CH-bonds&quot;</span><span class="p">))</span>
<span class="go">({ CH-bonds =&gt; bonds from element C to element H }) in (protein)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sire</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">set_token</span><span class="p">(</span><span class="s2">&quot;CH-bonds&quot;</span><span class="p">,</span> <span class="s2">&quot;bonds to element C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sire</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="s2">&quot;p-CH-bonds&quot;</span><span class="p">))</span>
<span class="go">({ CH-bonds =&gt; bonds from element C to element H }) in (protein)</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../api/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Documentation</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Detailed Guides</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Jan 09, 2023</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Searching</a><ul>
<li><a class="reference internal" href="#views">Views</a></li>
<li><a class="reference internal" href="#identifiers">Identifiers</a></li>
<li><a class="reference internal" href="#numbers">Numbers</a></li>
<li><a class="reference internal" href="#strings">Strings</a></li>
<li><a class="reference internal" href="#comparisons">Comparisons</a></li>
<li><a class="reference internal" href="#logical-operators">Logical operators</a></li>
<li><a class="reference internal" href="#returned-view-types">Returned View Types</a></li>
<li><a class="reference internal" href="#expansive-with-and-contractive-in-searches">Expansive (<em class="xref py py-obj">with</em>) and Contractive (<em class="xref py py-obj">in</em>) Searches</a></li>
<li><a class="reference internal" href="#match-all-atoms-residues-chains-etc">Match All Atoms, Residues, Chains etc.</a></li>
<li><a class="reference internal" href="#advanced-with-and-in-searches">Advanced <code class="docutils literal notranslate"><span class="pre">with</span></code> and <code class="docutils literal notranslate"><span class="pre">in</span></code> Searches</a></li>
<li><a class="reference internal" href="#searching-for-bonds-using-in-with-from-and-to">Searching for Bonds using <code class="docutils literal notranslate"><span class="pre">in</span></code>, <code class="docutils literal notranslate"><span class="pre">with</span></code>, <code class="docutils literal notranslate"><span class="pre">from</span></code> and <code class="docutils literal notranslate"><span class="pre">to</span></code></a></li>
<li><a class="reference internal" href="#searching-by-chemical-element">Searching by Chemical Element</a></li>
<li><a class="reference internal" href="#searching-by-count-i-e-number-of-atoms">Searching by Count (i.e. Number of Atoms)</a></li>
<li><a class="reference internal" href="#searching-by-charge-or-mass">Searching by Charge or Mass</a></li>
<li><a class="reference internal" href="#searching-by-charge-using-approximate-comparisons">Searching by Charge using Approximate Comparisons</a></li>
<li><a class="reference internal" href="#searching-by-property">Searching by Property</a></li>
<li><a class="reference internal" href="#finding-the-nth-view-that-matches">Finding the Nth View that Matches</a></li>
<li><a class="reference internal" href="#searching-by-distance">Searching by Distance</a></li>
<li><a class="reference internal" href="#searching-for-water-or-protein-molecules">Searching for Water or Protein Molecules</a></li>
<li><a class="reference internal" href="#creating-custom-search-tokens">Creating Custom Search Tokens</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/js/custom.js"></script>
    </body>
</html>