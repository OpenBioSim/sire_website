<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Units" href="units.html" /><link rel="prev" title="Viewing Molecules" href="view.html" />

    <link rel="shortcut icon" href="../_static/favicon.png"/><!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>OpenMM Integration - openbiosim - sire</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_fonts.css?v=50da5bc0" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_style.css?v=094c566b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_pygments.css?v=c839eb9e" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --font-stack: Changa, sans-serif;
  --font-stack--monospace: Roboto Mono, monospace;
  --color-foreground-primary: #dddddd;
  --color-foreground-secondary: #cccccc;
  --color-foreground-muted: #d0d0d0;
  --color-foreground-border: #923eb1;
  --color-background-primary: #160f30;
  --color-background-secondary: #201146;
  --color-background-hover: #4f4fb0;
  --color-background-hover--transparent: #4f4fb000;
  --color-background-border: #403333;
  --color-background-item: #411a30;
  --color-announcement-background: #000000dd;
  --color-announcement-text: #eeebee;
  --color-admonition-title-background--note: #FFFFFF33;
  --color-admonition-title-background--warning: #FF000033;
  --color-admonition-background: #FFFFFF11;
  --color-brand-primary: #eeeeee;
  --color-brand-content: #00dfef;
  --color-highlight-on-target: #333300;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">openbiosim - sire</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div>
<div class="sidebar-search">
  <div class="version_container">
    <div class="version_label">Branch</div>
    <div id="version_box" class="version_box"></div>
  </div>
</div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Quick Start Guide</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorial/index.html">Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorial</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorial/index_part01.html">Part 1 - Loading and Saving</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Part 1 - Loading and Saving</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part01/01_importing_sire.html">Importing sire</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part01/02_loading_a_molecule.html">Loading a molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part01/03_simple_indexing.html">Simple indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part01/04_saving_a_molecule.html">Saving a molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part01/05_loading_from_multiple_files.html">Loading from multiple files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part01/06_trajectories.html">Loading and saving trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part01/07_supported_file_formats.html">Supported file formats</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorial/index_part02.html">Part 2 - Indexing and Searching</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Part 2 - Indexing and Searching</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/01_indexing_atoms.html">Indexing Atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/02_indexing_residues.html">Indexing Residues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/03_indexing_chains.html">Indexing Chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/04_indexing_segments.html">Indexing Segments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/05_indexing_molecules.html">Indexing Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/06_indexing_bonds.html">Indexing Bonds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/07_indexing_angles.html">Indexing Angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/08_indexing_dihedrals.html">Indexing Dihedrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/09_indexing_impropers.html">Indexing Impropers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part02/10_searching.html">Searching</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorial/index_part03.html">Part 3 - Molecular Properties</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Part 3 - Molecular Properties</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/01_atom_properties.html">Atom Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/02_cursors.html">Cursors and Editing Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/03_residue_properties.html">Residue, Chain and Segment Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/04_molecule_properties.html">Molecule Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/05_bond_properties.html">Bond Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/06_angle_properties.html">Angle Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/07_dihedral_properties.html">Dihedral Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part03/08_improper_properties.html">Improper Views and Properties</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorial/index_part04.html">Part 4 - Measurement, Trajectories and Movement</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Part 4 - Measurement, Trajectories and Movement</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part04/01_measure.html">Measuring Distances and Angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part04/02_trajectory.html">Measuring Trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part04/03_energies.html">Measuring Energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part04/04_energy_trajectories.html">Measuring Energies Across Trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part04/05_movement.html">Moving Atoms and Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part04/06_move_internals.html">Moving Bonds, Angles and Dihedrals</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorial/index_part05.html">Part 5 - Interconverting with other Packages</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Part 5 - Interconverting with other Packages</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part05/01_convert.html">Converting Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part05/02_view.html">Viewing Molecules in 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part05/03_smiles.html">Creating Molecules from Smiles Strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part05/04_smarts.html">Searching for Fragments using Smarts Strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part05/05_dynamics.html">Molecular Dynamics and Minimisation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorial/index_part06.html">Part 6 - Morphs and Alchemical Free Energies</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Part 6 - Morphs and Alchemical Free Energies</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part06/01_merge.html">Merged Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part06/02_alchemical_dynamics.html">Alchemical Dynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part06/03_restraints.html">Restraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part06/04_alchemical_restraints.html">Alchemical Restraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part06/05_free_energy_perturbation.html">Running a Free Energy Perturbation Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part06/06_faster_fep.html">Running Faster Free Energy Simulations</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorial/index_part07.html">Part 7 - Merged Molecules and Lambda Levers</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Part 7 - Merged Molecules and Lambda Levers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part07/01_perturbation.html">Perturbation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part07/02_levers.html">Lambda schedules and levers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part07/03_ghosts.html">Ghost Atoms and Softening Potentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part07/04_merge.html">Creating merge molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part07/05_pertfile.html">Perturbation Files (pertfiles)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part07/06_decouple.html">Annihilation and Decoupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorial/part07/07_residue.html">Residue mutations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../blogposts.html">Diaries</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Detailed Guides</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Detailed Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="search.html">Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="trajectory.html">Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="view.html">Viewing Molecules</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">OpenMM Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="units.html">Units</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/sire.html">sire module</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/sire_modules.html">Sub-modules</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Sub-modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_base.html">sire.base</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of sire.base</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/base.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_cas.html">sire.cas</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of sire.cas</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/cas.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_convert.html">sire.convert</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of sire.convert</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/convert.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_io.html">sire.io</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of sire.io</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/io.html">Public API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/io_parser.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_maths.html">sire.maths</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of sire.maths</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/maths.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_mm.html">sire.mm</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of sire.mm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/mm.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_mol.html">sire.mol</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of sire.mol</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/mol.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_morph.html">sire.morph</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of sire.morph</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/morph.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_restraints.html">sire.restraints</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of sire.restraints</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/restraints.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_search.html">sire.search</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of sire.search</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/search.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_stream.html">sire.stream</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of sire.stream</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/stream.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_system.html">sire.system</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of sire.system</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/system.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_units.html">sire.units</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of sire.units</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/units.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_utils.html">sire.utils</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of sire.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/utils.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_vol.html">sire.vol</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of sire.vol</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/vol.html">Public API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../support.html">How to ask for help</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contributing/index.html">Contributing</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Contributing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/development.html">Developer’s guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/codestyle.html">Coding Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/packaging.html">Packaging releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/roadmap.html">Roadmap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code_of_conduct.html">Code of Conduct</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">Acknowledgements</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="openmm-integration">
<h1>OpenMM Integration<a class="headerlink" href="#openmm-integration" title="Link to this heading">#</a></h1>
<p>The <a class="reference internal" href="../tutorial/part05/05_dynamics.html"><span class="doc">dynamics functionality in sire</span></a>
is based on tight integration with <a class="reference external" href="https://openmm.org">OpenMM</a>.</p>
<p>This is achieved via code in <a class="reference internal" href="../api/convert.html#module-sire.convert" title="sire.convert"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire.convert</span></code></a> that can convert
<a class="reference internal" href="../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> objects to their <a class="reference external" href="https://openmm.org">OpenMM</a>
equivalents.</p>
<p>You can convert any molecule, molecule view, collection of molecules or
system objects into an OpenMM object using <a class="reference internal" href="../api/convert.html#sire.convert.to" title="sire.convert.to"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.convert.to()</span></code></a>
and passing in <code class="docutils literal notranslate"><span class="pre">openmm</span></code> as the desired format.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sire</span> <span class="k">as</span> <span class="nn">sr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">tutorial_url</span><span class="p">,</span> <span class="s2">&quot;kigaki.gro&quot;</span><span class="p">,</span> <span class="s2">&quot;kigaki.top&quot;</span><span class="p">),</span>
<span class="gp">... </span>               <span class="n">show_warnings</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omm</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="s2">&quot;openmm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">omm</span><span class="p">)</span>
<span class="go">&lt;openmm.openmm.Context; proxy of &lt;Swig Object of type &#39;OpenMM::Context *&#39; at 0x2846e5cb0&gt; &gt;</span>
</pre></div>
</div>
<p>The result is an <a class="reference external" href="https://docs.openmm.org/latest/api-python/generated/openmm.openmm.Context.html#openmm.openmm.Context">OpenMM Context</a>
which can be used just like any other <code class="docutils literal notranslate"><span class="pre">Context</span></code> object.</p>
<p>For example, you can extract the
<a class="reference external" href="https://docs.openmm.org/latest/api-python/generated/openmm.openmm.System.html#openmm.openmm.System">OpenMM System</a>
via</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">omm</span><span class="o">.</span><span class="n">getSystem</span><span class="p">())</span>
<span class="go">&lt;openmm.openmm.System; proxy of &lt;Swig Object of type &#39;OpenMM::System *&#39; at 0x2846e5d40&gt; &gt;</span>
</pre></div>
</div>
<p>or the
<a class="reference external" href="https://docs.openmm.org/latest/api-python/library.html#integrators">OpenMM Integrator</a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">omm</span><span class="o">.</span><span class="n">getIntegrator</span><span class="p">())</span>
<span class="go">&lt;openmm.openmm.VerletIntegrator; proxy of &lt;Swig Object of type &#39;OpenMM::VerletIntegrator *&#39; at 0x2846e5a70&gt; &gt;</span>
</pre></div>
</div>
<p>or the
<a class="reference external" href="https://docs.openmm.org/latest/api-python/generated/openmm.openmm.Platform.html#openmm.openmm.Platform">OpenMM Platform</a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">omm</span><span class="o">.</span><span class="n">getPlatform</span><span class="p">())</span>
<span class="go">&lt;openmm.openmm.Platform; proxy of &lt;Swig Object of type &#39;OpenMM::Platform *&#39; at 0x2846e5ce0&gt; &gt;</span>
</pre></div>
</div>
<p>as you could for any other
<a class="reference external" href="https://docs.openmm.org/latest/api-python/generated/openmm.openmm.Context.html#openmm.openmm.Context">OpenMM Context</a>.</p>
<p>You could then recombine these with your own choice of <code class="docutils literal notranslate"><span class="pre">Integrator</span></code> or
<code class="docutils literal notranslate"><span class="pre">Platform</span></code> if you want to use something different to what was created
by <a class="reference internal" href="../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a>.</p>
<section id="choosing-options">
<h2>Choosing options<a class="headerlink" href="#choosing-options" title="Link to this heading">#</a></h2>
<p><a class="reference internal" href="../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> made a series of choices for various OpenMM options and parameters
when it created the OpenMM Context. These choices were based on sensible
defaults derived from what it could find within the molecules/system being
converted.</p>
<p>You can override these choices by passing in a dictionary of key-value pairs
as the <code class="docutils literal notranslate"><span class="pre">map</span></code> option to <a class="reference internal" href="../api/convert.html#sire.convert.to" title="sire.convert.to"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.convert.to()</span></code></a>.</p>
<p>For example, you can choose the integrator by setting a value
for the <code class="docutils literal notranslate"><span class="pre">integrator</span></code> key, and set the temperature and pressure
by setting values for the <code class="docutils literal notranslate"><span class="pre">temperature</span></code> and <code class="docutils literal notranslate"><span class="pre">pressure</span></code> keys.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;integrator&quot;</span><span class="p">:</span> <span class="s2">&quot;langevin_middle&quot;</span><span class="p">,</span>
<span class="gp">... </span>     <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="mi">25</span><span class="o">*</span><span class="n">sr</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">celsius</span><span class="p">,</span>
<span class="gp">... </span>     <span class="s2">&quot;pressure&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="o">*</span><span class="n">sr</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">atm</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omm</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="s2">&quot;openmm&quot;</span><span class="p">,</span> <span class="nb">map</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">omm</span><span class="o">.</span><span class="n">getIntegrator</span><span class="p">())</span>
<span class="go">&lt;openmm.openmm.LangevinMiddleIntegrator; proxy of &lt;Swig Object of type &#39;OpenMM::LangevinMiddleIntegrator *&#39; at 0x295a07cc0&gt; &gt;</span>
</pre></div>
</div>
<p>Available keys and allowable values are listed below.</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Key</p></th>
<th class="head"><p>Valid values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>auto_constraints_factor</p></td>
<td><p>The factor by which to multiply the timestep when
deciding whether or not an auto-constrained bond should
be constrained. The calculated period of a bond
vibration is compared to the simulation timestep
multiplied by this factor. If the period is less than
this, the bond is constrained. This defaults to 10.</p></td>
</tr>
<tr class="row-odd"><td><p>barostat_frequency</p></td>
<td><p>The frequency at which the barostat acts to perform
the MC moves to change the box volume when performing
constant pressure simulations (default 25).</p></td>
</tr>
<tr class="row-even"><td><p>check_for_h_by_ambertype</p></td>
<td><p>Boolean value, e.g. <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> as to whether
hydrogen atoms can be detected based on a H? amber type.
This is the default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>check_for_h_by_element</p></td>
<td><p>Boolean value, e.g. <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> as to whether
hydrogen atoms can be detected based on the element.
This is the default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>check_for_h_by_mass</p></td>
<td><p>Boolean value, e.g. <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> as to whether
hydrogen atoms can be detected based on their mass.
This is the default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p>check_for_h_by_max_mass</p></td>
<td><p>Boolean value, e.g. <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> as to whether
hydrogen atoms can be detected based on the maximum
mass of the end states. This is the default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>com_reset_frequency</p></td>
<td><p>The frequency at which the <code class="docutils literal notranslate"><span class="pre">CMMotionRemover</span></code> acts to
remove center of mass relative motion. If this is not
set (the default) then center of mass motion is not
removed.</p></td>
</tr>
<tr class="row-odd"><td><p>constraint</p></td>
<td><p>Type of constraint to use for bonds and/or angles.
Valid strings are <code class="docutils literal notranslate"><span class="pre">none</span></code>,
<code class="docutils literal notranslate"><span class="pre">auto-bonds</span></code>, <code class="docutils literal notranslate"><span class="pre">h-bonds</span></code>,
<code class="docutils literal notranslate"><span class="pre">h-bonds-not-perturbed</span></code>,
<code class="docutils literal notranslate"><span class="pre">h-bonds-not-heavy-perturbed</span></code>,
<code class="docutils literal notranslate"><span class="pre">bonds</span></code>, <code class="docutils literal notranslate"><span class="pre">bonds-not-perturbed</span></code>,
<code class="docutils literal notranslate"><span class="pre">bonds-not-heavy-perturbed</span></code>,
<code class="docutils literal notranslate"><span class="pre">h-bonds-h-angles</span></code>,
<code class="docutils literal notranslate"><span class="pre">h-bonds-h-angles-not-perturbed</span></code>,
<code class="docutils literal notranslate"><span class="pre">h-bonds-h-angles-not-heavy-perturbed</span></code>,
<code class="docutils literal notranslate"><span class="pre">bonds-h-angles</span></code>,
<code class="docutils literal notranslate"><span class="pre">bonds-h-angles-not-perturbed</span></code> and
<a href="#id1"><span class="problematic" id="id2">``</span></a>bonds-h-angles-not-heavy-perturbed</p></td>
</tr>
<tr class="row-even"><td><p>coulomb_power</p></td>
<td><p>The coulomb power parameter used by the softening
potential used to soften electrostatic interactions
involving ghost atoms. This defaults to 0.</p></td>
</tr>
<tr class="row-odd"><td><p>cutoff</p></td>
<td><p>Size of the non-bonded cutoff, e.g.
<code class="docutils literal notranslate"><span class="pre">7.5*sr.units.angstrom</span></code></p></td>
</tr>
<tr class="row-even"><td><p>cutoff_type</p></td>
<td><p>Type of cutoff, e.g. <code class="docutils literal notranslate"><span class="pre">PARTICLE_MESH_EWALD</span></code>, <code class="docutils literal notranslate"><span class="pre">PME</span></code>,
<code class="docutils literal notranslate"><span class="pre">NO_CUTOFF</span></code>, <code class="docutils literal notranslate"><span class="pre">REACTION_FIELD</span></code>, <code class="docutils literal notranslate"><span class="pre">RF</span></code>, <code class="docutils literal notranslate"><span class="pre">EWALD</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>cpu_pme</p></td>
<td><p>Boolean value, e.g. <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> as to whether
or not PME should be evaluated on the CPU rather than
on the GPU.</p></td>
</tr>
<tr class="row-even"><td><p>device</p></td>
<td><p>Any valid OpenMM device number or device string, e.g.
<code class="docutils literal notranslate"><span class="pre">0</span></code> would select device 0</p></td>
</tr>
<tr class="row-odd"><td><p>dielectric</p></td>
<td><p>Dielectric value if a reaction field cutoff is used,
e.g. <code class="docutils literal notranslate"><span class="pre">78.0</span></code></p></td>
</tr>
<tr class="row-even"><td><p>dynamic_constraints</p></td>
<td><p>Whether or not the constraints applied to perturbable
bonds should be updated with λ (defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>).</p></td>
</tr>
<tr class="row-odd"><td><p>fixed</p></td>
<td><p>The atoms in the system that should be fixed (not moved)</p></td>
</tr>
<tr class="row-even"><td><p>ignore_perturbations</p></td>
<td><p>Whether or not to ignore any perturbations and only set
up a perturbable molecule as a non-perurbable molecule
from only the reference state.</p></td>
</tr>
<tr class="row-odd"><td><p>include_constrained_energies</p></td>
<td><p>Whether or not to include the bond and angle energies
of bonds and angles that are constrained.
This defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>, as we normally do want
to calculate all of the energies of the internals,
even if they are constrained.</p></td>
</tr>
<tr class="row-even"><td><p>integrator</p></td>
<td><p>The MD integrator to use, e.g.
<code class="docutils literal notranslate"><span class="pre">verlet</span></code>, <code class="docutils literal notranslate"><span class="pre">leapfrog</span></code>, <code class="docutils literal notranslate"><span class="pre">langevin</span></code>,
<code class="docutils literal notranslate"><span class="pre">langevin_middle</span></code>, <code class="docutils literal notranslate"><span class="pre">nose_hoover</span></code>,
<code class="docutils literal notranslate"><span class="pre">brownian</span></code>, <code class="docutils literal notranslate"><span class="pre">andersen</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>friction</p></td>
<td><p>Friction value for the integrator, in inverse time, e.g.
<code class="docutils literal notranslate"><span class="pre">5.0</span> <span class="pre">/</span> <span class="pre">sr.units.picosecond</span></code></p></td>
</tr>
<tr class="row-even"><td><p>lambda</p></td>
<td><p>The λ-value at which to set up the system (assuming this
contains any perturbable molecules or restraints)</p></td>
</tr>
<tr class="row-odd"><td><p>perturbable_constraint</p></td>
<td><p>The constraint to use for perturbable molecules. These
are the same options as <code class="docutils literal notranslate"><span class="pre">constraint</span></code>, and will
override that choice for perturbable molecules if this
is set.</p></td>
</tr>
<tr class="row-even"><td><p>platform</p></td>
<td><p>Any valid OpenMM platform string, e.g. <code class="docutils literal notranslate"><span class="pre">CUDA</span></code>,
<code class="docutils literal notranslate"><span class="pre">OpenCL</span></code>, <code class="docutils literal notranslate"><span class="pre">Metal</span></code>, <code class="docutils literal notranslate"><span class="pre">`CPU</span></code>, <code class="docutils literal notranslate"><span class="pre">Reference</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>precision</p></td>
<td><p>Any valid OpenMM platform precision value, e.g.
<code class="docutils literal notranslate"><span class="pre">single</span></code>, <code class="docutils literal notranslate"><span class="pre">mixed</span></code> or <code class="docutils literal notranslate"><span class="pre">double</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>pressure</p></td>
<td><p>Any pressure value, e.g. <code class="docutils literal notranslate"><span class="pre">1*sr.units.atm</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>restraints</p></td>
<td><p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">Restraints</span></code> object (or list of
objects) that describe the restraints that should be
added to the system.</p></td>
</tr>
<tr class="row-even"><td><p>schedule</p></td>
<td><p>The <a class="reference internal" href="../api/cas.html#sire.cas.LambdaSchedule" title="sire.cas.LambdaSchedule"><code class="xref py py-class docutils literal notranslate"><span class="pre">LambdaSchedule</span></code></a> to use that
controls how parameters are modified with λ</p></td>
</tr>
<tr class="row-odd"><td><p>shift_coulomb</p></td>
<td><p>The coulomb delta parameter used by the softening
potential used to soften electrostatic interactions
involving ghost atoms. This defaults to 1.0 Å.</p></td>
</tr>
<tr class="row-even"><td><p>shift_delta</p></td>
<td><p>The shift_delta parameter to use for the softening
potential used to soften LJ interactions involving
ghost atoms. This defaults to 2.0 Å.</p></td>
</tr>
<tr class="row-odd"><td><p>space</p></td>
<td><p>Space in which the simulation should be conducted, e.g.
<em class="xref py py-obj">sr.vol.Cartesian</em></p></td>
</tr>
<tr class="row-even"><td><p>swap_end_states</p></td>
<td><p>Whether to swap the end states of a perturbable molecule
(i.e. treat the perturbed state as the reference state
and vice versa). This defaults to False.</p></td>
</tr>
<tr class="row-odd"><td><p>taylor_power</p></td>
<td><p>The taylor power parameter used by the taylor algorithm
for the softening potential used to soften LJ
interactions involving ghost atoms. This defaults to 1.</p></td>
</tr>
<tr class="row-even"><td><p>temperature</p></td>
<td><p>Any temperature value, e.g. <code class="docutils literal notranslate"><span class="pre">25*sr.units.celsius</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>threads</p></td>
<td><p>The number of threads to use in the CPU platform</p></td>
</tr>
<tr class="row-even"><td><p>timestep</p></td>
<td><p>Time between integration steps, e.g.
<code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">sr.units.femtosecond</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>tolerance</p></td>
<td><p>The tolerance to use for the PME calculation, e.g.
<code class="docutils literal notranslate"><span class="pre">0.0001</span></code></p></td>
</tr>
<tr class="row-even"><td><p>use_dispersion_correction</p></td>
<td><p>Whether or not to use the dispersion correction to
deal with cutoff issues. This is very expensive.</p></td>
</tr>
<tr class="row-odd"><td><p>use_taylor_softening</p></td>
<td><p>Whether or not to use the taylor algorithm to soften
interactions involving ghost atoms. This defaults to
False.</p></td>
</tr>
<tr class="row-even"><td><p>use_zacharias_softening</p></td>
<td><p>Whether or not to use the zacharias algorithm to soften
interactions involving ghost atoms. This defaults to
True. Note that one of zacharias or taylor softening
must be True, with zacharias taking precedence.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="higher-level-api">
<h2>Higher level API<a class="headerlink" href="#higher-level-api" title="Link to this heading">#</a></h2>
<p>The <a class="reference internal" href="../api/mol.html#sire.mol.Dynamics" title="sire.mol.Dynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dynamics</span></code></a> object and <a class="reference internal" href="../api/mol.html#sire.mol.SelectorMol.dynamics" title="sire.mol.SelectorMol.dynamics"><code class="xref py py-func docutils literal notranslate"><span class="pre">dynamics()</span></code></a>
function provides a higher level API for running molecular dynamics using the
<a class="reference external" href="https://docs.openmm.org/latest/api-python/generated/openmm.openmm.Context.html#openmm.openmm.Context">OpenMM Context</a>
created by <a class="reference internal" href="../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a>.</p>
<p>You create a <a class="reference internal" href="../api/mol.html#sire.mol.Dynamics" title="sire.mol.Dynamics"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dynamics</span></code></a> object by calling the
<a class="reference internal" href="../api/mol.html#sire.mol.SelectorMol.dynamics" title="sire.mol.SelectorMol.dynamics"><code class="xref py py-func docutils literal notranslate"><span class="pre">dynamics()</span></code></a> function on the molecule,
molecule view, collection or system that you want to simulate.
For example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">()</span>
</pre></div>
</div>
<p>You can use this object to query the options that were passed into OpenMM.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">ensemble</span><span class="p">())</span>
<span class="go">microcanonical (NVE) ensemble</span>
</pre></div>
</div>
<p>You can set most of the OpenMM options via arguments to the <a class="reference internal" href="../api/mol.html#sire.mol.SelectorMol.dynamics" title="sire.mol.SelectorMol.dynamics"><code class="xref py py-func docutils literal notranslate"><span class="pre">dynamics()</span></code></a>
function, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="s2">&quot;25oC&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">ensemble</span><span class="p">())</span>
<span class="go">canonical (NVT) ensemble { temperature = 298.15 C }</span>
</pre></div>
</div>
<p>… note:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>The function will automatically convert strings to units if these are
needed, e.g. ``25oC`` will automatically be converted to 25 Celsius.
</pre></div>
</div>
<p>or</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="s2">&quot;4fs&quot;</span><span class="p">,</span> <span class="n">lambda_value</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also set OpenMM options by passing the dictionary of key-value pairs
as the <code class="docutils literal notranslate"><span class="pre">map</span></code> option.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="s2">&quot;25oC&quot;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">ensemble</span><span class="p">())</span>
<span class="go">canonical (NVT) ensemble { temperature = 298.15 C }</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> automatically chooses the right OpenMM Integrator and
barostat options based on the ensemble parameters.</p>
</div>
<p>It is a mistake to use an OpenMM Integrator that is not suited
for the chosen ensemble.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="s2">&quot;25oC&quot;</span><span class="p">,</span> <span class="n">integrator</span><span class="o">=</span><span class="s2">&quot;verlet&quot;</span><span class="p">)</span>
<span class="go">ValueError: You cannot use a verlet integrator with the ensemble canonical (NVT) ensemble { temperature = 298.15 C }</span>
</pre></div>
</div>
<p>You can also query other parameters.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="s2">&quot;1fs&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">constraint</span><span class="p">())</span>
<span class="go">none</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="s2">&quot;5fs&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">constraint</span><span class="p">())</span>
<span class="go">bonds-h-angles</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">timestep</span><span class="p">())</span>
<span class="go">0.005 ps</span>
</pre></div>
</div>
<p>Forcefield properties are automatically set based on the properties
contained by the molecules. You can get a summary of these properties
using the <a class="reference internal" href="../api/mol.html#sire.mol.Dynamics.info" title="sire.mol.Dynamics.info"><code class="xref py py-func docutils literal notranslate"><span class="pre">info()</span></code></a> function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="go">ForceFieldInfo(</span>
<span class="go">  space=PeriodicBox( ( 48.3263, 48.3263, 48.3263 ) ),</span>
<span class="go">  cutoff_type=PME,</span>
<span class="go">  cutoff=7.5 Å,</span>
<span class="go">  params=Properties( tolerance =&gt; 0.0001 ),</span>
<span class="go">  detail=MM ForceField{ amber::ff,</span>
<span class="go">               combining_rules = arithmetic,</span>
<span class="go">               1-4 scaling = 0.833333, 0.5,</span>
<span class="go">               nonbonded = coulomb, lj,</span>
<span class="go">               bond = harmonic, angle = harmonic,</span>
<span class="go">               dihedral = cosine }</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Some of these properties, such as <code class="docutils literal notranslate"><span class="pre">detail</span></code>, come from the forcefield
parameters of the converted molecules. Others, such as the
<code class="docutils literal notranslate"><span class="pre">cutoff_type</span></code> and <code class="docutils literal notranslate"><span class="pre">cutoff</span></code> are passed from the options given
by the user (or derived as defaults). The <code class="docutils literal notranslate"><span class="pre">space</span></code> property is
extracted from the <a class="reference internal" href="../api/system.html#sire.system.System" title="sire.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> if that is passed,
or is found from the <code class="docutils literal notranslate"><span class="pre">space</span></code> property from the first molecule that
contains such a property. Sometimes, particularly if you aren’t using
a <a class="reference internal" href="../api/system.html#sire.system.System" title="sire.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>, it can be a good idea to manually
set the <code class="docutils literal notranslate"><span class="pre">space</span></code>, e.g. to <a class="reference internal" href="../api/vol.html#sire.vol.Cartesian" title="sire.vol.Cartesian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cartesian</span></code></a> if you are
running a gas-phase simulation. In this case setting the
<code class="docutils literal notranslate"><span class="pre">cutoff_type</span></code> to <code class="docutils literal notranslate"><span class="pre">NO_CUTOFF</span></code> will set the cutoff to a sufficiently
large value so that the effect is that there is no cutoff. Setting
the <code class="docutils literal notranslate"><span class="pre">space</span></code> to <a class="reference internal" href="../api/vol.html#sire.vol.Cartesian" title="sire.vol.Cartesian"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cartesian</span></code></a> will require disabling
<code class="docutils literal notranslate"><span class="pre">PME</span></code>, as this cutoff type requires a periodic space. Instead, choose
a cutoff type like reaction field.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;space&quot;</span><span class="p">:</span> <span class="n">sr</span><span class="o">.</span><span class="n">vol</span><span class="o">.</span><span class="n">Cartesian</span><span class="p">(),</span>
<span class="gp">... </span>                       <span class="s2">&quot;cutoff_type&quot;</span><span class="p">:</span> <span class="s2">&quot;NO_CUTOFF&quot;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="go">ForceFieldInfo(</span>
<span class="go">  space=Infinite cartesian space,</span>
<span class="go">  cutoff_type=NO_CUTOFF,</span>
<span class="go">  detail=MM ForceField{ amber::ff,</span>
<span class="go">               combining_rules = arithmetic,</span>
<span class="go">               1-4 scaling = 0.833333, 0.5,</span>
<span class="go">               nonbonded = coulomb, lj,</span>
<span class="go">               bond = harmonic, angle = harmonic,</span>
<span class="go">               dihedral = cosine }</span>
<span class="go">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;space&quot;</span><span class="p">:</span> <span class="n">sr</span><span class="o">.</span><span class="n">vol</span><span class="o">.</span><span class="n">Cartesian</span><span class="p">(),</span>
<span class="gp">... </span>                       <span class="s2">&quot;cutoff_type&quot;</span><span class="p">:</span> <span class="s2">&quot;RF&quot;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
<span class="go">ForceFieldInfo(</span>
<span class="go">  space=Infinite cartesian space,</span>
<span class="go">  cutoff_type=REACTION_FIELD,</span>
<span class="go">  cutoff=7.5 Å,</span>
<span class="go">  params=Properties( dielectric =&gt; 78.3 ),</span>
<span class="go">  detail=MM ForceField{ amber::ff,</span>
<span class="go">               combining_rules = arithmetic,</span>
<span class="go">               1-4 scaling = 0.833333, 0.5,</span>
<span class="go">               nonbonded = coulomb, lj,</span>
<span class="go">               bond = harmonic, angle = harmonic,</span>
<span class="go">               dihedral = cosine }</span>
<span class="go">)</span>
</pre></div>
</div>
</section>
<section id="running-dynamics-and-saving-frames-and-energies">
<h2>Running dynamics and saving frames and energies<a class="headerlink" href="#running-dynamics-and-saving-frames-and-energies" title="Link to this heading">#</a></h2>
<p>You can run dynamics via the <a class="reference internal" href="../api/mol.html#sire.mol.Dynamics.run" title="sire.mol.Dynamics.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">run()</span></code></a> function, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="s2">&quot;4fs&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="s2">&quot;25oC&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;100ps&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>would run 100 picoseconds of dynamics.</p>
<p>At the end, you can extract the final system using the
<a class="reference internal" href="../api/mol.html#sire.mol.Dynamics.commit" title="sire.mol.Dynamics.commit"><code class="xref py py-func docutils literal notranslate"><span class="pre">commit()</span></code></a> function, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>You can set the frequency at which trajectory frames and energies are saved
via the <code class="docutils literal notranslate"><span class="pre">save_frequency</span></code> argument, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;100ps&quot;</span><span class="p">,</span> <span class="n">save_frequency</span><span class="o">=</span><span class="s2">&quot;10ps&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>would save energies and trajectory frames every 10 picoseconds. You can
specifiy different frequencies for these via the
<code class="docutils literal notranslate"><span class="pre">energy_frequency</span></code> and/or <code class="docutils literal notranslate"><span class="pre">frame_frequency</span></code> arguments, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;1ns&quot;</span><span class="p">,</span> <span class="n">energy_frequency</span><span class="o">=</span><span class="s2">&quot;1ps&quot;</span><span class="p">,</span> <span class="n">frame_frequency</span><span class="o">=</span><span class="s2">&quot;100ps&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>would save energies every picosecond and frames every 100 picoseconds.</p>
<p>By default, only coordinates are saved. You can choose to save velocities
as well by setting <code class="docutils literal notranslate"><span class="pre">save_velocities=True</span></code>, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;10ps&quot;</span><span class="p">,</span> <span class="n">save_frequency</span><span class="o">=</span><span class="s2">&quot;1ps&quot;</span><span class="p">,</span> <span class="n">save_velocities</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>By default, energies are saved only for the simulated λ-value of the
system. You can request energies to be saved for other λ-values using
the <code class="docutils literal notranslate"><span class="pre">lambda_windows</span></code> argument, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;100ps&quot;</span><span class="p">,</span> <span class="n">energy_frequency</span><span class="o">=</span><span class="s2">&quot;1ps&quot;</span><span class="p">,</span> <span class="n">lambda_windows</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
</pre></div>
</div>
<p>would save the energies at λ-values 0.0, 0.5 and 1.0 for every picosecond
of the trajectory. You can pass in as many or few λ-windows as you wish.</p>
<p>The coordinate/velocity frames are saved to the <code class="docutils literal notranslate"><span class="pre">trajectory</span></code> property of
the molecules, and are accessible identically to trajectories loaded
from files (e.g. via that property of the <code class="docutils literal notranslate"><span class="pre">.trajectory()</span></code> function).</p>
<p>The energies are saved to the <code class="docutils literal notranslate"><span class="pre">energy_trajectory</span></code> property of the
returned molecules, and accessible via that property or the
<a class="reference internal" href="../api/system.html#sire.system.System.energy_trajectory" title="sire.system.System.energy_trajectory"><code class="xref py py-func docutils literal notranslate"><span class="pre">energy_trajectory()</span></code></a> function.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="units.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Units</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="view.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Viewing Molecules</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Apr 09, 2024</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">OpenMM Integration</a><ul>
<li><a class="reference internal" href="#choosing-options">Choosing options</a></li>
<li><a class="reference internal" href="#higher-level-api">Higher level API</a></li>
<li><a class="reference internal" href="#running-dynamics-and-saving-frames-and-energies">Running dynamics and saving frames and energies</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=9887e882"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/js/custom.js?v=c9df2d0f"></script>
    </body>
</html>