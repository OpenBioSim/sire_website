<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="How to ask for help" href="../../support.html" /><link rel="prev" title="Indexing Bonds" href="06_indexing_bonds.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>Searching - Sire Molecular Modelling</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Sire Molecular Modelling</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../features.html">Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing Sire</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Quick Start Guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Tutorial</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part01.html">Part 1 - Loading and Saving</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part01/01_importing_sire.html">Importing sire</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/02_loading_a_molecule.html">Loading a molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/03_simple_indexing.html">Simple indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/04_saving_a_molecule.html">Saving a molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/05_loading_from_multiple_files.html">Loading from multiple files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/06_supported_file_formats.html">Supported file formats</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../index_part02.html">Part 2 - Indexing and Searching</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="01_indexing_atoms.html">Indexing Atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="02_indexing_residues.html">Indexing Residues</a></li>
<li class="toctree-l3"><a class="reference internal" href="03_indexing_chains.html">Indexing Chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="04_indexing_segments.html">Indexing Segments</a></li>
<li class="toctree-l3"><a class="reference internal" href="05_indexing_molecules.html">Indexing Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="06_indexing_bonds.html">Indexing Bonds</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Searching</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">How to ask for help</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../packaging.html">Packaging releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development.html">Developer’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../snaglist.html">Snag list</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/index.html">Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire.html">Sire</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire.html">sire API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/generated/sire.load.html">sire.load</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/generated/sire.save.html">sire.save</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/generated/sire.atomid.html">sire.atomid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/generated/sire.chainid.html">sire.chainid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/generated/sire.molid.html">sire.molid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/generated/sire.resid.html">sire.resid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/generated/sire.segid.html">sire.segid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/generated/sire.thumbs_up.html">sire.thumbs_up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/generated/sire.disable_thumbs_up.html">sire.disable_thumbs_up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/generated/sire.get_thumbs_up_info.html">sire.get_thumbs_up_info</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_Analysis.html">Sire.Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_Analysis.html">sire.analysis API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_Base.html">Sire.Base</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_Base.html">sire.base API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_CAS.html">Sire.CAS</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_CAS.html">sire.cas API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_Error.html">Sire.Error</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_Error.html">sire.error API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_FF.html">Sire.FF</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_FF.html">sire.ff API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_ID.html">Sire.ID</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_ID.html">sire.id API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_IO.html">Sire.IO</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_IO.html">sire.io API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_Maths.html">Sire.Maths</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_Maths.html">sire.maths API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_MM.html">Sire.MM</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_MM.html">sire.mm API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_Mol.html">Sire.Mol</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_Mol.html">sire.mol API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_Move.html">Sire.Move</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_Move.html">sire.move API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_Squire.html">Sire.Squire</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_Squire.html">sire.squire API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_Stream.html">Sire.Stream</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_Stream.html">sire.stream API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_System.html">Sire.System</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_System.html">sire.system API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_Units.html">Sire.Units</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_Units.html">sire.units API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/index_Sire_Vol.html">Sire.Vol</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_api_Sire_Vol.html">sire.vol API Detail</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgements.html">Acknowledgements</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="searching">
<h1>Searching<a class="headerlink" href="#searching" title="Permalink to this heading">#</a></h1>
<p>Sire has a powerful search system. You have already used this to search
for atoms, residues etc by their name, number, index or element.
It is even more powerful, supporting searching by other metadata or
properties.</p>
<p>To explore this, let’s load up the <code class="docutils literal notranslate"><span class="pre">kigaki</span></code> system.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sire</span> <span class="k">as</span> <span class="nn">sr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">tutorial_url</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;kigaki.gro&quot;</span><span class="p">,</span> <span class="s2">&quot;kigaki.top&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<section id="searching-by-count">
<h2>Searching by count<a class="headerlink" href="#searching-by-count" title="Permalink to this heading">#</a></h2>
<p>You can search for all atoms in the loaded molecules using</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;atoms&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=11120</span>
<span class="go">0: MolNum(6) Atom( N:1     [  23.28,   13.14,   22.39] )</span>
<span class="go">1: MolNum(6) Atom( H1:2    [  22.66,   13.10,   21.60] )</span>
<span class="go">2: MolNum(6) Atom( H2:3    [  23.57,   14.09,   22.53] )</span>
<span class="go">3: MolNum(6) Atom( H3:4    [  24.08,   12.57,   22.21] )</span>
<span class="go">4: MolNum(6) Atom( CA:5    [  22.58,   12.65,   23.60] )</span>
<span class="gp">...</span>
<span class="go">11115: MolNum(3622) Atom( CL:11116 [  30.22,   39.31,   33.39] )</span>
<span class="go">11116: MolNum(3623) Atom( CL:11117 [  40.21,    0.35,   38.95] )</span>
<span class="go">11117: MolNum(3624) Atom( CL:11118 [  42.28,   19.12,   17.40] )</span>
<span class="go">11118: MolNum(3625) Atom( CL:11119 [  47.26,   45.20,   12.38] )</span>
<span class="go">11119: MolNum(3626) Atom( CL:11120 [  42.51,   39.80,   21.90] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>or all bonds</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;bonds&quot;</span><span class="p">])</span>
<span class="go">SelectorBond( size=301</span>
<span class="go">0: Bond( N:1 =&gt; CA:5 )</span>
<span class="go">1: Bond( N:1 =&gt; H1:2 )</span>
<span class="go">2: Bond( N:1 =&gt; H2:3 )</span>
<span class="go">3: Bond( N:1 =&gt; H3:4 )</span>
<span class="go">4: Bond( CA:5 =&gt; HA:6 )</span>
<span class="gp">...</span>
<span class="go">296: Bond( CD:294 =&gt; HD2:296 )</span>
<span class="go">297: Bond( C:298 =&gt; O:299 )</span>
<span class="go">298: Bond( C:298 =&gt; N:300 )</span>
<span class="go">299: Bond( N:300 =&gt; H2:302 )</span>
<span class="go">300: Bond( N:300 =&gt; H1:301 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>(and you could do the same for <em class="xref py py-obj">residues</em>, <em class="xref py py-obj">chains</em>, <em class="xref py py-obj">segments</em> or
<em class="xref py py-obj">molecules</em>).</p>
<p>You can search for things that match specified numbers of atoms, residues
etc using <em class="xref py py-obj">count( X )</em>. This counts the number of things within the
contained search, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;count(atoms) == 3&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=10797</span>
<span class="go">0: MolNum(7) Atom( OW:303  [   2.30,    6.28,    1.13] )</span>
<span class="go">1: MolNum(7) Atom( HW1:304 [   1.37,    6.26,    1.50] )</span>
<span class="go">2: MolNum(7) Atom( HW2:305 [   2.31,    5.89,    0.21] )</span>
<span class="go">3: MolNum(8) Atom( OW:306  [   2.25,    2.75,    9.96] )</span>
<span class="go">4: MolNum(8) Atom( HW1:307 [   2.60,    2.58,   10.88] )</span>
<span class="gp">...</span>
<span class="go">10792: MolNum(3604) Atom( HW1:11095 [  41.82,   40.76,   41.82] )</span>
<span class="go">10793: MolNum(3604) Atom( HW2:11096 [  41.13,   41.08,   43.27] )</span>
<span class="go">10794: MolNum(3605) Atom( OW:11097 [  37.63,   48.01,   40.24] )</span>
<span class="go">10795: MolNum(3605) Atom( HW1:11098 [  38.62,   47.90,   40.15] )</span>
<span class="go">10796: MolNum(3605) Atom( HW2:11099 [  37.23,   47.15,   40.56] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>This has given all of the atoms in all of the molecules where the number
of atoms was equal to 3. Typically you would want the molecules which
had this number of atoms. You can search for them using</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;molecules with count(atoms) == 3&quot;</span><span class="p">])</span>
<span class="go">SelectorMol( size=3599</span>
<span class="go">0: Molecule( SOL:7   num_atoms=3 num_residues=1 )</span>
<span class="go">1: Molecule( SOL:8   num_atoms=3 num_residues=1 )</span>
<span class="go">2: Molecule( SOL:9   num_atoms=3 num_residues=1 )</span>
<span class="go">3: Molecule( SOL:10  num_atoms=3 num_residues=1 )</span>
<span class="go">4: Molecule( SOL:11  num_atoms=3 num_residues=1 )</span>
<span class="gp">...</span>
<span class="go">3594: Molecule( SOL:3601 num_atoms=3 num_residues=1 )</span>
<span class="go">3595: Molecule( SOL:3602 num_atoms=3 num_residues=1 )</span>
<span class="go">3596: Molecule( SOL:3603 num_atoms=3 num_residues=1 )</span>
<span class="go">3597: Molecule( SOL:3604 num_atoms=3 num_residues=1 )</span>
<span class="go">3598: Molecule( SOL:3605 num_atoms=3 num_residues=1 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Any comparison operator and any type of search is allowed, e.g. you can find all
molecules with more than 5 residues using</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;molecules with count(residues) &gt; 5&quot;</span><span class="p">])</span>
<span class="go">Molecule( Protein:6 num_atoms=302 num_residues=19 )</span>
</pre></div>
</div>
<p>or all residues with more than 10 atoms</p>
<p>THIS DOESN’T WORK, BUT IT SHOULD</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;residues with count(atoms) &gt; 10&quot;</span><span class="p">])</span>
<span class="go">XXX</span>
</pre></div>
</div>
</section>
<section id="searching-by-property">
<h2>Searching by property<a class="headerlink" href="#searching-by-property" title="Permalink to this heading">#</a></h2>
<p>You can search for atoms, residues, molecules etc by some of
their properties. Currently supported properties are mass, coordinates and charge.</p>
</section>
<section id="searching-by-mass">
<h2>Searching by mass<a class="headerlink" href="#searching-by-mass" title="Permalink to this heading">#</a></h2>
<p>For example;</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;atom mass &lt; 2&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=7370</span>
<span class="go">0: MolNum(6) Atom( H1:2    [  22.66,   13.10,   21.60] )</span>
<span class="go">1: MolNum(6) Atom( H2:3    [  23.57,   14.09,   22.53] )</span>
<span class="go">2: MolNum(6) Atom( H3:4    [  24.08,   12.57,   22.21] )</span>
<span class="go">3: MolNum(6) Atom( HA:6    [  22.30,   11.70,   23.49] )</span>
<span class="go">4: MolNum(6) Atom( HB1:8   [  23.66,   13.69,   25.02] )</span>
<span class="gp">...</span>
<span class="go">7365: MolNum(3603) Atom( HW2:11093 [  45.51,   47.49,   46.51] )</span>
<span class="go">7366: MolNum(3604) Atom( HW1:11095 [  41.82,   40.76,   41.82] )</span>
<span class="go">7367: MolNum(3604) Atom( HW2:11096 [  41.13,   41.08,   43.27] )</span>
<span class="go">7368: MolNum(3605) Atom( HW1:11098 [  38.62,   47.90,   40.15] )</span>
<span class="go">7369: MolNum(3605) Atom( HW2:11099 [  37.23,   47.15,   40.56] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>which can be shortened to</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;mass &lt; 2&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=7370</span>
<span class="go">0: MolNum(6) Atom( H1:2    [  22.66,   13.10,   21.60] )</span>
<span class="go">1: MolNum(6) Atom( H2:3    [  23.57,   14.09,   22.53] )</span>
<span class="go">2: MolNum(6) Atom( H3:4    [  24.08,   12.57,   22.21] )</span>
<span class="go">3: MolNum(6) Atom( HA:6    [  22.30,   11.70,   23.49] )</span>
<span class="go">4: MolNum(6) Atom( HB1:8   [  23.66,   13.69,   25.02] )</span>
<span class="gp">...</span>
<span class="go">7365: MolNum(3603) Atom( HW2:11093 [  45.51,   47.49,   46.51] )</span>
<span class="go">7366: MolNum(3604) Atom( HW1:11095 [  41.82,   40.76,   41.82] )</span>
<span class="go">7367: MolNum(3604) Atom( HW2:11096 [  41.13,   41.08,   43.27] )</span>
<span class="go">7368: MolNum(3605) Atom( HW1:11098 [  38.62,   47.90,   40.15] )</span>
<span class="go">7369: MolNum(3605) Atom( HW2:11099 [  37.23,   47.15,   40.56] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>will find all atoms that have a mass of less than <em class="xref py py-obj">2 g mol-1</em>. You can
add the units, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;mass &lt; 2 g_per_mol&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=7370</span>
<span class="go">0: MolNum(6) Atom( H1:2    [  22.66,   13.10,   21.60] )</span>
<span class="go">1: MolNum(6) Atom( H2:3    [  23.57,   14.09,   22.53] )</span>
<span class="go">2: MolNum(6) Atom( H3:4    [  24.08,   12.57,   22.21] )</span>
<span class="go">3: MolNum(6) Atom( HA:6    [  22.30,   11.70,   23.49] )</span>
<span class="go">4: MolNum(6) Atom( HB1:8   [  23.66,   13.69,   25.02] )</span>
<span class="gp">...</span>
<span class="go">7365: MolNum(3603) Atom( HW2:11093 [  45.51,   47.49,   46.51] )</span>
<span class="go">7366: MolNum(3604) Atom( HW1:11095 [  41.82,   40.76,   41.82] )</span>
<span class="go">7367: MolNum(3604) Atom( HW2:11096 [  41.13,   41.08,   43.27] )</span>
<span class="go">7368: MolNum(3605) Atom( HW1:11098 [  38.62,   47.90,   40.15] )</span>
<span class="go">7369: MolNum(3605) Atom( HW2:11099 [  37.23,   47.15,   40.56] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>can use any comparison you want, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;mass &gt;= 16&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=3638</span>
<span class="go">0: MolNum(6) Atom( O:24    [  21.52,   14.78,   23.75] )</span>
<span class="go">1: MolNum(6) Atom( O:43    [  19.51,   14.27,   26.56] )</span>
<span class="go">2: MolNum(6) Atom( O:50    [  19.97,   18.72,   26.98] )</span>
<span class="go">3: MolNum(6) Atom( O:60    [  22.63,   18.62,   24.67] )</span>
<span class="go">4: MolNum(6) Atom( O:82    [  26.57,   19.61,   26.69] )</span>
<span class="gp">...</span>
<span class="go">3633: MolNum(3622) Atom( CL:11116 [  30.22,   39.31,   33.39] )</span>
<span class="go">3634: MolNum(3623) Atom( CL:11117 [  40.21,    0.35,   38.95] )</span>
<span class="go">3635: MolNum(3624) Atom( CL:11118 [  42.28,   19.12,   17.40] )</span>
<span class="go">3636: MolNum(3625) Atom( CL:11119 [  47.26,   45.20,   12.38] )</span>
<span class="go">3637: MolNum(3626) Atom( CL:11120 [  42.51,   39.80,   21.90] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>and also search for larger units by mass, e.g. finding all residues
that are greater than <em class="xref py py-obj">100 g_per_mol</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;residue mass &gt; 50 g_per_mol&quot;</span><span class="p">])</span>
<span class="go">Selector&lt;SireMol::Residue&gt;( size=18</span>
<span class="go">0:  Residue( LYS:1   num_atoms=24 )</span>
<span class="go">1:  Residue( ILE:2   num_atoms=19 )</span>
<span class="go">2:  Residue( GLY:3   num_atoms=7 )</span>
<span class="go">3:  Residue( ALA:4   num_atoms=10 )</span>
<span class="go">4:  Residue( LYS:5   num_atoms=22 )</span>
<span class="gp">...</span>
<span class="go">13:  Residue( ILE:14  num_atoms=19 )</span>
<span class="go">14:  Residue( GLY:15  num_atoms=7 )</span>
<span class="go">15:  Residue( ALA:16  num_atoms=10 )</span>
<span class="go">16:  Residue( LYS:17  num_atoms=22 )</span>
<span class="go">17:  Residue( ILE:18  num_atoms=19 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>or molecules that are less than <em class="xref py py-obj">20 g_per_mol</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;molecule mass &lt; 20 g_per_mol&quot;</span><span class="p">])</span>
<span class="go">SelectorMol( size=3599</span>
<span class="go">0: Molecule( SOL:7   num_atoms=3 num_residues=1 )</span>
<span class="go">1: Molecule( SOL:8   num_atoms=3 num_residues=1 )</span>
<span class="go">2: Molecule( SOL:9   num_atoms=3 num_residues=1 )</span>
<span class="go">3: Molecule( SOL:10  num_atoms=3 num_residues=1 )</span>
<span class="go">4: Molecule( SOL:11  num_atoms=3 num_residues=1 )</span>
<span class="gp">...</span>
<span class="go">3594: Molecule( SOL:3601 num_atoms=3 num_residues=1 )</span>
<span class="go">3595: Molecule( SOL:3602 num_atoms=3 num_residues=1 )</span>
<span class="go">3596: Molecule( SOL:3603 num_atoms=3 num_residues=1 )</span>
<span class="go">3597: Molecule( SOL:3604 num_atoms=3 num_residues=1 )</span>
<span class="go">3598: Molecule( SOL:3605 num_atoms=3 num_residues=1 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>or bonds where the two atoms in the bond have a total mass of greater than
25 g_per_mol</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;bond mass &gt; 25 g_per_mol&quot;</span><span class="p">])</span>
<span class="go">SelectorBond( size=60</span>
<span class="go">0: Bond( N:1 =&gt; CA:5 )</span>
<span class="go">1: Bond( CE:16 =&gt; NZ:19 )</span>
<span class="go">2: Bond( C:23 =&gt; O:24 )</span>
<span class="go">3: Bond( C:23 =&gt; N:25 )</span>
<span class="go">4: Bond( N:25 =&gt; CA:27 )</span>
<span class="gp">...</span>
<span class="go">55: Bond( C:279 =&gt; O:280 )</span>
<span class="go">56: Bond( C:279 =&gt; N:281 )</span>
<span class="go">57: Bond( N:281 =&gt; CA:283 )</span>
<span class="go">58: Bond( C:298 =&gt; N:300 )</span>
<span class="go">59: Bond( C:298 =&gt; O:299 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Writing</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;mass 1.008&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=7370</span>
<span class="go">0: MolNum(6) Atom( H1:2    [  22.66,   13.10,   21.60] )</span>
<span class="go">1: MolNum(6) Atom( H2:3    [  23.57,   14.09,   22.53] )</span>
<span class="go">2: MolNum(6) Atom( H3:4    [  24.08,   12.57,   22.21] )</span>
<span class="go">3: MolNum(6) Atom( HA:6    [  22.30,   11.70,   23.49] )</span>
<span class="go">4: MolNum(6) Atom( HB1:8   [  23.66,   13.69,   25.02] )</span>
<span class="gp">...</span>
<span class="go">7365: MolNum(3603) Atom( HW2:11093 [  45.51,   47.49,   46.51] )</span>
<span class="go">7366: MolNum(3604) Atom( HW1:11095 [  41.82,   40.76,   41.82] )</span>
<span class="go">7367: MolNum(3604) Atom( HW2:11096 [  41.13,   41.08,   43.27] )</span>
<span class="go">7368: MolNum(3605) Atom( HW1:11098 [  38.62,   47.90,   40.15] )</span>
<span class="go">7369: MolNum(3605) Atom( HW2:11099 [  37.23,   47.15,   40.56] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>is equivalent to writing</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="p">[</span><span class="s2">&quot;mass =~ 1.008&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=7370</span>
<span class="go">0: MolNum(6) Atom( H1:2    [  22.66,   13.10,   21.60] )</span>
<span class="go">1: MolNum(6) Atom( H2:3    [  23.57,   14.09,   22.53] )</span>
<span class="go">2: MolNum(6) Atom( H3:4    [  24.08,   12.57,   22.21] )</span>
<span class="go">3: MolNum(6) Atom( HA:6    [  22.30,   11.70,   23.49] )</span>
<span class="go">4: MolNum(6) Atom( HB1:8   [  23.66,   13.69,   25.02] )</span>
<span class="gp">...</span>
<span class="go">7365: MolNum(3603) Atom( HW2:11093 [  45.51,   47.49,   46.51] )</span>
<span class="go">7366: MolNum(3604) Atom( HW1:11095 [  41.82,   40.76,   41.82] )</span>
<span class="go">7367: MolNum(3604) Atom( HW2:11096 [  41.13,   41.08,   43.27] )</span>
<span class="go">7368: MolNum(3605) Atom( HW1:11098 [  38.62,   47.90,   40.15] )</span>
<span class="go">7369: MolNum(3605) Atom( HW2:11099 [  37.23,   47.15,   40.56] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>where <em class="xref py py-obj">=~</em> means “approximately equal to”. The
<a class="reference external" href="https://docs.pytest.org/en/latest/reference/reference.html#pytest-approx">pytest algorithm</a>
is used for approximate comparison. You can get the epsilon for
comparison via</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">get_approx_epsilon</span><span class="p">())</span>
<span class="go">1e-06</span>
</pre></div>
</div>
<p>and set it via</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">set_approx_epsilon</span><span class="p">(</span><span class="mf">1e-6</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="searching-by-charge">
<h2>Searching by charge<a class="headerlink" href="#searching-by-charge" title="Permalink to this heading">#</a></h2>
<p>You can also do the same thing with charge, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;charge &gt; 0&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=7411</span>
<span class="go">0: MolNum(6) Atom( N:1     [  23.28,   13.14,   22.39] )</span>
<span class="go">1: MolNum(6) Atom( H1:2    [  22.66,   13.10,   21.60] )</span>
<span class="go">2: MolNum(6) Atom( H2:3    [  23.57,   14.09,   22.53] )</span>
<span class="go">3: MolNum(6) Atom( H3:4    [  24.08,   12.57,   22.21] )</span>
<span class="go">4: MolNum(6) Atom( HA:6    [  22.30,   11.70,   23.49] )</span>
<span class="gp">...</span>
<span class="go">7406: MolNum(3608) Atom( NA:11102 [   9.73,   27.52,   34.34] )</span>
<span class="go">7407: MolNum(3609) Atom( NA:11103 [  14.34,   30.50,   37.65] )</span>
<span class="go">7408: MolNum(3610) Atom( NA:11104 [  10.83,   47.08,    0.87] )</span>
<span class="go">7409: MolNum(3611) Atom( NA:11105 [  37.64,   24.06,   29.76] )</span>
<span class="go">7410: MolNum(3612) Atom( NA:11106 [  45.27,   32.64,   46.48] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>gives all of the positively charged atoms, while</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;charge &lt; -0.5&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=3631</span>
<span class="go">0: MolNum(6) Atom( O:24    [  21.52,   14.78,   23.75] )</span>
<span class="go">1: MolNum(6) Atom( O:43    [  19.51,   14.27,   26.56] )</span>
<span class="go">2: MolNum(6) Atom( O:50    [  19.97,   18.72,   26.98] )</span>
<span class="go">3: MolNum(6) Atom( O:60    [  22.63,   18.62,   24.67] )</span>
<span class="go">4: MolNum(6) Atom( O:82    [  26.57,   19.61,   26.69] )</span>
<span class="gp">...</span>
<span class="go">3626: MolNum(3622) Atom( CL:11116 [  30.22,   39.31,   33.39] )</span>
<span class="go">3627: MolNum(3623) Atom( CL:11117 [  40.21,    0.35,   38.95] )</span>
<span class="go">3628: MolNum(3624) Atom( CL:11118 [  42.28,   19.12,   17.40] )</span>
<span class="go">3629: MolNum(3625) Atom( CL:11119 [  47.26,   45.20,   12.38] )</span>
<span class="go">3630: MolNum(3626) Atom( CL:11120 [  42.51,   39.80,   21.90] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>gives all of the atoms whose charges are less than -0.5.</p>
<p>The units are unit electron charges, which you can specify,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;charge &gt; 0.5 e&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=25</span>
<span class="go">0: MolNum(6) Atom( C:23    [  21.37,   13.56,   23.79] )</span>
<span class="go">1: MolNum(6) Atom( C:42    [  19.00,   14.64,   25.50] )</span>
<span class="go">2: MolNum(6) Atom( C:49    [  19.98,   17.58,   26.53] )</span>
<span class="go">3: MolNum(6) Atom( C:59    [  22.96,   18.55,   25.85] )</span>
<span class="go">4: MolNum(6) Atom( C:81    [  26.04,   20.38,   25.89] )</span>
<span class="gp">...</span>
<span class="go">20: MolNum(3608) Atom( NA:11102 [   9.73,   27.52,   34.34] )</span>
<span class="go">21: MolNum(3609) Atom( NA:11103 [  14.34,   30.50,   37.65] )</span>
<span class="go">22: MolNum(3610) Atom( NA:11104 [  10.83,   47.08,    0.87] )</span>
<span class="go">23: MolNum(3611) Atom( NA:11105 [  37.64,   24.06,   29.76] )</span>
<span class="go">24: MolNum(3612) Atom( NA:11106 [  45.27,   32.64,   46.48] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>You can also use the same <em class="xref py py-obj">residue</em>, <em class="xref py py-obj">molecule</em> etc terms to search
based on the total charge on a residue, molecule etc.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;residue charge 0&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Residue&gt;( size=3612</span>
<span class="go">0: MolNum(6) Residue( ILE:2   num_atoms=19 )</span>
<span class="go">1: MolNum(6) Residue( GLY:3   num_atoms=7 )</span>
<span class="go">2: MolNum(6) Residue( ALA:4   num_atoms=10 )</span>
<span class="go">3: MolNum(6) Residue( ILE:6   num_atoms=19 )</span>
<span class="go">4: MolNum(6) Residue( ILE:8   num_atoms=19 )</span>
<span class="gp">...</span>
<span class="go">3607: MolNum(3601) Residue( SOL:3614 num_atoms=3 )</span>
<span class="go">3608: MolNum(3602) Residue( SOL:3615 num_atoms=3 )</span>
<span class="go">3609: MolNum(3603) Residue( SOL:3616 num_atoms=3 )</span>
<span class="go">3610: MolNum(3604) Residue( SOL:3617 num_atoms=3 )</span>
<span class="go">3611: MolNum(3605) Residue( SOL:3618 num_atoms=3 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>finds all of the neutral residues, and</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;bond charge &lt; -0.5&quot;</span><span class="p">])</span>
<span class="go">SelectorBond( size=5</span>
<span class="go">0: Bond( N:61 =&gt; CA:63 )</span>
<span class="go">1: Bond( N:102 =&gt; CA:104 )</span>
<span class="go">2: Bond( N:160 =&gt; CA:162 )</span>
<span class="go">3: Bond( N:201 =&gt; CA:203 )</span>
<span class="go">4: Bond( N:259 =&gt; CA:261 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>finds all of the bonds where the total charge on the two atoms is
less than <em class="xref py py-obj">-0.5 e</em>.</p>
</section>
<section id="searching-by-coordinates">
<h2>Searching by coordinates<a class="headerlink" href="#searching-by-coordinates" title="Permalink to this heading">#</a></h2>
<p>To search by coordinates, you can look for atoms that are within
specified distances of points or other atoms. For example,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;atoms within 2.0 angstrom of element C&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=268</span>
<span class="go">0: MolNum(6) Atom( N:1     [  23.28,   13.14,   22.39] )</span>
<span class="go">1: MolNum(6) Atom( CA:5    [  22.58,   12.65,   23.60] )</span>
<span class="go">2: MolNum(6) Atom( HA:6    [  22.30,   11.70,   23.49] )</span>
<span class="go">3: MolNum(6) Atom( CB:7    [  23.52,   12.72,   24.79] )</span>
<span class="go">4: MolNum(6) Atom( HB1:8   [  23.66,   13.69,   25.02] )</span>
<span class="gp">...</span>
<span class="go">263: MolNum(6) Atom( C:298   [  20.38,   27.34,   16.01] )</span>
<span class="go">264: MolNum(6) Atom( O:299   [  19.53,   26.50,   15.69] )</span>
<span class="go">265: MolNum(6) Atom( N:300   [  20.91,   28.17,   15.12] )</span>
<span class="go">266: MolNum(271) Atom( HW1:1096 [  17.33,   10.51,   26.59] )</span>
<span class="go">267: MolNum(827) Atom( HW1:2764 [  14.66,   29.74,   19.60] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>finds all atoms that are within <em class="xref py py-obj">2 angstrom</em> of any carbon atom.
The default unit of distance is angstrom, so you could also write</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;atoms within 2 of element C&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=268</span>
<span class="go">0: MolNum(6) Atom( N:1     [  23.28,   13.14,   22.39] )</span>
<span class="go">1: MolNum(6) Atom( CA:5    [  22.58,   12.65,   23.60] )</span>
<span class="go">2: MolNum(6) Atom( HA:6    [  22.30,   11.70,   23.49] )</span>
<span class="go">3: MolNum(6) Atom( CB:7    [  23.52,   12.72,   24.79] )</span>
<span class="go">4: MolNum(6) Atom( HB1:8   [  23.66,   13.69,   25.02] )</span>
<span class="gp">...</span>
<span class="go">263: MolNum(6) Atom( C:298   [  20.38,   27.34,   16.01] )</span>
<span class="go">264: MolNum(6) Atom( O:299   [  19.53,   26.50,   15.69] )</span>
<span class="go">265: MolNum(6) Atom( N:300   [  20.91,   28.17,   15.12] )</span>
<span class="go">266: MolNum(271) Atom( HW1:1096 [  17.33,   10.51,   26.59] )</span>
<span class="go">267: MolNum(827) Atom( HW1:2764 [  14.66,   29.74,   19.60] )</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that we used <em class="xref py py-obj">atoms</em> in this search rather than <em class="xref py py-obj">atom</em>. Both are
equivalent and can be used interchangeably. In this case, it feels better
to write <em class="xref py py-obj">atoms within</em> rather than <em class="xref py py-obj">atom within</em>, but both will
do the same thing.</p>
</div>
<p>You can also search by residue or other units, such as</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;residues within 3 angstrom of resnum 1&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Residue&gt;( size=18</span>
<span class="go">0: MolNum(6) Residue( LYS:1   num_atoms=24 )</span>
<span class="go">1: MolNum(6) Residue( ILE:2   num_atoms=19 )</span>
<span class="go">2: MolNum(6) Residue( ALA:4   num_atoms=10 )</span>
<span class="go">3: MolNum(1604) Residue( SOL:1617 num_atoms=3 )</span>
<span class="go">4: MolNum(1624) Residue( SOL:1637 num_atoms=3 )</span>
<span class="gp">...</span>
<span class="go">13: MolNum(1769) Residue( SOL:1782 num_atoms=3 )</span>
<span class="go">14: MolNum(1781) Residue( SOL:1794 num_atoms=3 )</span>
<span class="go">15: MolNum(1800) Residue( SOL:1813 num_atoms=3 )</span>
<span class="go">16: MolNum(1809) Residue( SOL:1822 num_atoms=3 )</span>
<span class="go">17: MolNum(1812) Residue( SOL:1825 num_atoms=3 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>returns all residues where any atom in that residue is within
<em class="xref py py-obj">3 angstrom</em> of any atom in the residue with <em class="xref py py-obj">resnum 1</em>.</p>
<p>You can also search for atoms within a point in space, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;atoms within 5.0 of (0, 0, 0)&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=9</span>
<span class="go">0: MolNum(82) Atom( OW:528  [   2.97,    0.35,    1.71] )</span>
<span class="go">1: MolNum(82) Atom( HW1:529 [   3.46,    1.19,    1.50] )</span>
<span class="go">2: MolNum(82) Atom( HW2:530 [   3.59,   -0.30,    2.16] )</span>
<span class="go">3: MolNum(183) Atom( OW:831  [   0.75,    3.45,    0.33] )</span>
<span class="go">4: MolNum(183) Atom( HW1:832 [  -0.17,    3.17,    0.04] )</span>
<span class="go">5: MolNum(183) Atom( HW2:833 [   1.06,    4.22,   -0.23] )</span>
<span class="go">6: MolNum(185) Atom( OW:837  [   0.72,    1.66,    3.18] )</span>
<span class="go">7: MolNum(185) Atom( HW1:838 [   0.55,    2.49,    2.64] )</span>
<span class="go">8: MolNum(185) Atom( HW2:839 [   1.62,    1.29,    2.96] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>finds all atoms within <em class="xref py py-obj">5 angstroms</em> of the point <em class="xref py py-obj">(0, 0, 0)</em>, while</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;molecules within 5.0 of (0, 0, 0)&quot;</span><span class="p">])</span>
<span class="go">SelectorMol( size=3</span>
<span class="go">0: Molecule( SOL:82  num_atoms=3 num_residues=1 )</span>
<span class="go">1: Molecule( SOL:183 num_atoms=3 num_residues=1 )</span>
<span class="go">2: Molecule( SOL:185 num_atoms=3 num_residues=1 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>finds all molecules which have any atom that is within <em class="xref py py-obj">5 angstroms</em>
of the point <em class="xref py py-obj">(0, 0, 0)</em>.</p>
</section>
<section id="searching-by-molecule-type">
<h2>Searching by molecule type<a class="headerlink" href="#searching-by-molecule-type" title="Permalink to this heading">#</a></h2>
<p>There are some high-level search terms that provide quick access
to searches for common types of molecules.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;water&quot;</span><span class="p">])</span>
<span class="go">SelectorMol( size=3599</span>
<span class="go">0: Molecule( SOL:7   num_atoms=3 num_residues=1 )</span>
<span class="go">1: Molecule( SOL:8   num_atoms=3 num_residues=1 )</span>
<span class="go">2: Molecule( SOL:9   num_atoms=3 num_residues=1 )</span>
<span class="go">3: Molecule( SOL:10  num_atoms=3 num_residues=1 )</span>
<span class="go">4: Molecule( SOL:11  num_atoms=3 num_residues=1 )</span>
<span class="gp">...</span>
<span class="go">3594: Molecule( SOL:3601 num_atoms=3 num_residues=1 )</span>
<span class="go">3595: Molecule( SOL:3602 num_atoms=3 num_residues=1 )</span>
<span class="go">3596: Molecule( SOL:3603 num_atoms=3 num_residues=1 )</span>
<span class="go">3597: Molecule( SOL:3604 num_atoms=3 num_residues=1 )</span>
<span class="go">3598: Molecule( SOL:3605 num_atoms=3 num_residues=1 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>returns all water molecules. These are searched for by finding all molecules
that contain one oxygen, two hydrogens and any number of null (dummy)
atoms.</p>
<p>You can combine this with other searches, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;water and element O&quot;</span><span class="p">])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=3599</span>
<span class="go">0: MolNum(7) Atom( OW:303  [   2.30,    6.28,    1.13] )</span>
<span class="go">1: MolNum(8) Atom( OW:306  [   2.25,    2.75,    9.96] )</span>
<span class="go">2: MolNum(9) Atom( OW:309  [   0.19,    3.68,    6.47] )</span>
<span class="go">3: MolNum(10) Atom( OW:312  [   5.69,   12.75,   11.65] )</span>
<span class="go">4: MolNum(11) Atom( OW:315  [  15.55,   15.11,    7.03] )</span>
<span class="gp">...</span>
<span class="go">3594: MolNum(3601) Atom( OW:11085 [  49.49,   40.49,   41.73] )</span>
<span class="go">3595: MolNum(3602) Atom( OW:11088 [  43.18,   44.69,   43.76] )</span>
<span class="go">3596: MolNum(3603) Atom( OW:11091 [  45.83,   46.80,   45.85] )</span>
<span class="go">3597: MolNum(3604) Atom( OW:11094 [  41.52,   41.48,   42.44] )</span>
<span class="go">3598: MolNum(3605) Atom( OW:11097 [  37.63,   48.01,   40.24] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>gives all of the oxygen atoms in water molecules.</p>
<p>There is a similar search term to find protein molecules.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;protein&quot;</span><span class="p">])</span>
<span class="go">Molecule( Protein:6 num_atoms=302 num_residues=19 )</span>
</pre></div>
</div>
<p>This returns all molecules that contain at least 5 residues that have
names that are in a set of protein residue names.</p>
<p>You can get the set of protein residue names using;</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">get_protein_residue_names</span><span class="p">())</span>
<span class="go">[&#39;hip&#39;, &#39;his&#39;, &#39;tyr&#39;, &#39;ile&#39;, &#39;trp&#39;, &#39;ala&#39;, &#39;pro&#39;, &#39;glh&#39;, &#39;ash&#39;,</span>
<span class="go"> &#39;lys&#39;, &#39;ser&#39;, &#39;gln&#39;, &#39;arg&#39;, &#39;asn&#39;, &#39;asp&#39;, &#39;cys&#39;, &#39;met&#39;, &#39;phe&#39;,</span>
<span class="go"> &#39;leu&#39;, &#39;glu&#39;, &#39;hid&#39;, &#39;hie&#39;, &#39;cyx&#39;, &#39;gly&#39;, &#39;val&#39;, &#39;thr&#39;]</span>
</pre></div>
</div>
<p>Names are matched ignoring case, so <em class="xref py py-obj">ALA</em> will be identified as a
protein residue. You can set protein residue names using</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">set_protein_residue_names</span><span class="p">([</span><span class="s2">&quot;ala&quot;</span><span class="p">,</span> <span class="s2">&quot;ash&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">get_protein_residue_names</span><span class="p">())</span>
<span class="go">[&#39;ala&#39;, &#39;ash&#39;]</span>
</pre></div>
</div>
<p>You can reset the names using</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">set_protein_residue_names</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="s1">&#39;hip&#39;</span><span class="p">,</span> <span class="s1">&#39;his&#39;</span><span class="p">,</span> <span class="s1">&#39;tyr&#39;</span><span class="p">,</span> <span class="s1">&#39;ile&#39;</span><span class="p">,</span> <span class="s1">&#39;trp&#39;</span><span class="p">,</span> <span class="s1">&#39;ala&#39;</span><span class="p">,</span> <span class="s1">&#39;pro&#39;</span><span class="p">,</span> <span class="s1">&#39;glh&#39;</span><span class="p">,</span> <span class="s1">&#39;ash&#39;</span><span class="p">,</span>
<span class="gp">... </span>     <span class="s1">&#39;lys&#39;</span><span class="p">,</span> <span class="s1">&#39;ser&#39;</span><span class="p">,</span> <span class="s1">&#39;gln&#39;</span><span class="p">,</span> <span class="s1">&#39;arg&#39;</span><span class="p">,</span> <span class="s1">&#39;asn&#39;</span><span class="p">,</span> <span class="s1">&#39;asp&#39;</span><span class="p">,</span> <span class="s1">&#39;cys&#39;</span><span class="p">,</span> <span class="s1">&#39;met&#39;</span><span class="p">,</span> <span class="s1">&#39;phe&#39;</span><span class="p">,</span>
<span class="gp">... </span>     <span class="s1">&#39;leu&#39;</span><span class="p">,</span> <span class="s1">&#39;glu&#39;</span><span class="p">,</span> <span class="s1">&#39;hid&#39;</span><span class="p">,</span> <span class="s1">&#39;hie&#39;</span><span class="p">,</span> <span class="s1">&#39;cyx&#39;</span><span class="p">,</span> <span class="s1">&#39;gly&#39;</span><span class="p">,</span> <span class="s1">&#39;val&#39;</span><span class="p">,</span> <span class="s1">&#39;thr&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Similarly, you can get the minimum number of protein residues to match
using</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">get_min_protein_residues</span><span class="p">())</span>
<span class="go">5</span>
</pre></div>
</div>
<p>and can set it via</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">set_min_protein_residues</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="searching-by-custom-tokens">
<h2>Searching by custom tokens<a class="headerlink" href="#searching-by-custom-tokens" title="Permalink to this heading">#</a></h2>
<p>It is common when searching that you will have a term that you will
want to repeat. For example, you can match proteins using <em class="xref py py-obj">protein</em>,
and water molecules using <em class="xref py py-obj">water</em>. You could thus match all
other molecules using</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;not (protein or water)&quot;</span><span class="p">])</span>
<span class="go">SelectorMol( size=21</span>
<span class="go">0: Molecule( NA:3606 num_atoms=1 num_residues=1 )</span>
<span class="go">1: Molecule( NA:3607 num_atoms=1 num_residues=1 )</span>
<span class="go">2: Molecule( NA:3608 num_atoms=1 num_residues=1 )</span>
<span class="go">3: Molecule( NA:3609 num_atoms=1 num_residues=1 )</span>
<span class="go">4: Molecule( NA:3610 num_atoms=1 num_residues=1 )</span>
<span class="gp">...</span>
<span class="go">16: Molecule( CL:3622 num_atoms=1 num_residues=1 )</span>
<span class="go">17: Molecule( CL:3623 num_atoms=1 num_residues=1 )</span>
<span class="go">18: Molecule( CL:3624 num_atoms=1 num_residues=1 )</span>
<span class="go">19: Molecule( CL:3625 num_atoms=1 num_residues=1 )</span>
<span class="go">20: Molecule( CL:3626 num_atoms=1 num_residues=1 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>You can create your own search token that represents this search
using <code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.set_token()</span></code>, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">set_token</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">,</span> <span class="s2">&quot;not (protein or water)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This creates the token <em class="xref py py-obj">other</em> that represents the search
<em class="xref py py-obj">not (protein or water)</em>. You can now use <em class="xref py py-obj">other</em> as a search term, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;other&quot;</span><span class="p">])</span>
<span class="go">SelectorMol( size=21</span>
<span class="go">0: Molecule( NA:3606 num_atoms=1 num_residues=1 )</span>
<span class="go">1: Molecule( NA:3607 num_atoms=1 num_residues=1 )</span>
<span class="go">2: Molecule( NA:3608 num_atoms=1 num_residues=1 )</span>
<span class="go">3: Molecule( NA:3609 num_atoms=1 num_residues=1 )</span>
<span class="go">4: Molecule( NA:3610 num_atoms=1 num_residues=1 )</span>
<span class="gp">...</span>
<span class="go">16: Molecule( CL:3622 num_atoms=1 num_residues=1 )</span>
<span class="go">17: Molecule( CL:3623 num_atoms=1 num_residues=1 )</span>
<span class="go">18: Molecule( CL:3624 num_atoms=1 num_residues=1 )</span>
<span class="go">19: Molecule( CL:3625 num_atoms=1 num_residues=1 )</span>
<span class="go">20: Molecule( CL:3626 num_atoms=1 num_residues=1 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>This enables you to more easily find all of the positive and negative ions,
e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;other and charge &gt; 0&quot;</span><span class="p">])</span>
<span class="go">SelectorMol( size=7</span>
<span class="go">0: Molecule( NA:3606 num_atoms=1 num_residues=1 )</span>
<span class="go">1: Molecule( NA:3607 num_atoms=1 num_residues=1 )</span>
<span class="go">2: Molecule( NA:3608 num_atoms=1 num_residues=1 )</span>
<span class="go">3: Molecule( NA:3609 num_atoms=1 num_residues=1 )</span>
<span class="go">4: Molecule( NA:3610 num_atoms=1 num_residues=1 )</span>
<span class="go">5: Molecule( NA:3611 num_atoms=1 num_residues=1 )</span>
<span class="go">6: Molecule( NA:3612 num_atoms=1 num_residues=1 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Tokens can build on one another, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">set_token</span><span class="p">(</span><span class="s2">&quot;positive_ions&quot;</span><span class="p">,</span> <span class="s2">&quot;other and charge &gt; 0&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;positive_ions&quot;</span><span class="p">])</span>
<span class="go">SelectorMol( size=7</span>
<span class="go">0: Molecule( NA:3606 num_atoms=1 num_residues=1 )</span>
<span class="go">1: Molecule( NA:3607 num_atoms=1 num_residues=1 )</span>
<span class="go">2: Molecule( NA:3608 num_atoms=1 num_residues=1 )</span>
<span class="go">3: Molecule( NA:3609 num_atoms=1 num_residues=1 )</span>
<span class="go">4: Molecule( NA:3610 num_atoms=1 num_residues=1 )</span>
<span class="go">5: Molecule( NA:3611 num_atoms=1 num_residues=1 )</span>
<span class="go">6: Molecule( NA:3612 num_atoms=1 num_residues=1 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>You can find out what a token refers to via
<code class="xref py py-func docutils literal notranslate"><span class="pre">sire.search.get_token()</span></code>, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">get_token</span><span class="p">(</span><span class="s2">&quot;positive_ions&quot;</span><span class="p">))</span>
<span class="go">({ other =&gt; not ((protein or water)) } and charge &gt; 0 |e|)</span>
</pre></div>
</div>
<p>Note how the <em class="xref py py-obj">other</em> token has been expanded into its parts.
This is because the token is expanded when it is created.
This means that the token is unaffected by what you do to
the <em class="xref py py-obj">other</em> token, e.g. deleting it via</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span><span class="o">.</span><span class="n">search</span><span class="o">.</span><span class="n">delete_token</span><span class="p">(</span><span class="s2">&quot;other&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>will not affect <em class="xref py py-obj">positive_ions</em></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;positive_ions&quot;</span><span class="p">])</span>
<span class="go">SelectorMol( size=7</span>
<span class="go">0: Molecule( NA:3606 num_atoms=1 num_residues=1 )</span>
<span class="go">1: Molecule( NA:3607 num_atoms=1 num_residues=1 )</span>
<span class="go">2: Molecule( NA:3608 num_atoms=1 num_residues=1 )</span>
<span class="go">3: Molecule( NA:3609 num_atoms=1 num_residues=1 )</span>
<span class="go">4: Molecule( NA:3610 num_atoms=1 num_residues=1 )</span>
<span class="go">5: Molecule( NA:3611 num_atoms=1 num_residues=1 )</span>
<span class="go">6: Molecule( NA:3612 num_atoms=1 num_residues=1 )</span>
<span class="go">)</span>
</pre></div>
</div>
</section>
<section id="indexing-within-searches">
<h2>Indexing within searches<a class="headerlink" href="#indexing-within-searches" title="Permalink to this heading">#</a></h2>
<p>It is often the case that multiple items will match your search. You
can request only a sub-set by indexing your search, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">{positive_ions}</span><span class="s2">[0]&quot;</span><span class="p">])</span>
<span class="go">Molecule( NA:3606 num_atoms=1 num_residues=1 )</span>
</pre></div>
</div>
<p>returns the first item that matched the custom <em class="xref py py-obj">positive_ions</em> token
you created above.</p>
<p>Indexing can be used with any search term. The general format is
<em class="xref py py-obj">{search_term}[index]</em>. The index behaves like a python index, so can
be negative indexed or sliced, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">{positive_ions}</span><span class="s2">[-1]&quot;</span><span class="p">])</span>
<span class="go">Molecule( NA:3612 num_atoms=1 num_residues=1 )</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">{positive_ions}</span><span class="s2">[0:6:2]&quot;</span><span class="p">])</span>
<span class="go">SelectorMol( size=3</span>
<span class="go">0: Molecule( NA:3606 num_atoms=1 num_residues=1 )</span>
<span class="go">1: Molecule( NA:3608 num_atoms=1 num_residues=1 )</span>
<span class="go">2: Molecule( NA:3610 num_atoms=1 num_residues=1 )</span>
<span class="go">)</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../../support.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">How to ask for help</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="06_indexing_bonds.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Indexing Bonds</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Dec 27, 2022</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Searching</a><ul>
<li><a class="reference internal" href="#searching-by-count">Searching by count</a></li>
<li><a class="reference internal" href="#searching-by-property">Searching by property</a></li>
<li><a class="reference internal" href="#searching-by-mass">Searching by mass</a></li>
<li><a class="reference internal" href="#searching-by-charge">Searching by charge</a></li>
<li><a class="reference internal" href="#searching-by-coordinates">Searching by coordinates</a></li>
<li><a class="reference internal" href="#searching-by-molecule-type">Searching by molecule type</a></li>
<li><a class="reference internal" href="#searching-by-custom-tokens">Searching by custom tokens</a></li>
<li><a class="reference internal" href="#indexing-within-searches">Indexing within searches</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    </body>
</html>