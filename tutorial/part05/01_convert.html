<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Viewing Molecules in 2D" href="02_view.html" /><link rel="prev" title="Part 5 - Interconverting with other Packages" href="../index_part05.html" />

    <link rel="shortcut icon" href="../../_static/favicon.png"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>Converting Molecules - openbiosim - sire</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom_fonts.css?v=50da5bc0" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom_style.css?v=094c566b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom_pygments.css?v=c839eb9e" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --font-stack: Changa, sans-serif;
  --font-stack--monospace: Roboto Mono, monospace;
  --color-foreground-primary: #dddddd;
  --color-foreground-secondary: #cccccc;
  --color-foreground-muted: #d0d0d0;
  --color-foreground-border: #923eb1;
  --color-background-primary: #160f30;
  --color-background-secondary: #201146;
  --color-background-hover: #4f4fb0;
  --color-background-hover--transparent: #4f4fb000;
  --color-background-border: #403333;
  --color-background-item: #411a30;
  --color-announcement-background: #000000dd;
  --color-announcement-text: #eeebee;
  --color-admonition-title-background--note: #FFFFFF33;
  --color-admonition-title-background--warning: #FF000033;
  --color-admonition-background: #FFFFFF11;
  --color-brand-primary: #eeeeee;
  --color-brand-content: #00dfef;
  --color-highlight-on-target: #333300;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">openbiosim - sire</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div>
<div class="sidebar-search">
  <div class="version_container">
    <div class="version_label">Branch</div>
    <div id="version_box" class="version_box"></div>
  </div>
</div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Quick Start Guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Tutorial</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorial</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part01.html">Part 1 - Loading and Saving</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Part 1 - Loading and Saving</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part01/01_importing_sire.html">Importing sire</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/02_loading_a_molecule.html">Loading a molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/03_simple_indexing.html">Simple indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/04_saving_a_molecule.html">Saving a molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/05_loading_from_multiple_files.html">Loading from multiple files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/06_trajectories.html">Loading and saving trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/07_supported_file_formats.html">Supported file formats</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part02.html">Part 2 - Indexing and Searching</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Part 2 - Indexing and Searching</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part02/01_indexing_atoms.html">Indexing Atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/02_indexing_residues.html">Indexing Residues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/03_indexing_chains.html">Indexing Chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/04_indexing_segments.html">Indexing Segments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/05_indexing_molecules.html">Indexing Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/06_indexing_bonds.html">Indexing Bonds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/07_indexing_angles.html">Indexing Angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/08_indexing_dihedrals.html">Indexing Dihedrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/09_indexing_impropers.html">Indexing Impropers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/10_searching.html">Searching</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part03.html">Part 3 - Molecular Properties</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Part 3 - Molecular Properties</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part03/01_atom_properties.html">Atom Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/02_cursors.html">Cursors and Editing Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/03_residue_properties.html">Residue, Chain and Segment Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/04_molecule_properties.html">Molecule Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/05_bond_properties.html">Bond Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/06_angle_properties.html">Angle Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/07_dihedral_properties.html">Dihedral Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/08_improper_properties.html">Improper Views and Properties</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part04.html">Part 4 - Measurement, Trajectories and Movement</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Part 4 - Measurement, Trajectories and Movement</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part04/01_measure.html">Measuring Distances and Angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part04/02_trajectory.html">Measuring Trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part04/03_energies.html">Measuring Energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part04/04_energy_trajectories.html">Measuring Energies Across Trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part04/05_movement.html">Moving Atoms and Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part04/06_move_internals.html">Moving Bonds, Angles and Dihedrals</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../index_part05.html">Part 5 - Interconverting with other Packages</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Part 5 - Interconverting with other Packages</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Converting Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="02_view.html">Viewing Molecules in 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="03_smiles.html">Creating Molecules from Smiles Strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="04_smarts.html">Searching for Fragments using Smarts Strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="05_dynamics.html">Molecular Dynamics and Minimisation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part06.html">Part 6 - Morphs and Alchemical Free Energies</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Part 6 - Morphs and Alchemical Free Energies</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part06/01_merge.html">Merged Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part06/02_alchemical_dynamics.html">Alchemical Dynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part06/03_restraints.html">Restraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part06/04_alchemical_restraints.html">Alchemical Restraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part06/05_free_energy_perturbation.html">Running a Free Energy Perturbation Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part06/06_faster_fep.html">Running Faster Free Energy Simulations</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part07.html">Part 7 - Merged Molecules and Lambda Levers</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Part 7 - Merged Molecules and Lambda Levers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part07/01_perturbation.html">Perturbation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part07/02_levers.html">Lambda schedules and levers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part07/03_ghosts.html">Ghost Atoms and Softening Potentials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part07/04_merge.html">Creating merge molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part07/05_pertfile.html">Perturbation Files (pertfiles)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part07/06_decouple.html">Annihilation and Decoupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part07/07_residue.html">Residue mutations</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part08.html">Part 08 - QM/MM</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Part 08 - QM/MM</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part08/01_intro.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part08/02_emle.html">Sire-EMLE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part08/03_adp_pmf.html">Alanine-dipeptide conformational landscape</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part08/04_diels_alder.html">Diels-Alder reaction</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../blogposts.html">Diaries</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cheatsheet/index.html">Detailed Guides</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Detailed Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cheatsheet/search.html">Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cheatsheet/trajectory.html">Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cheatsheet/view.html">Viewing Molecules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cheatsheet/openmm.html">OpenMM Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cheatsheet/units.html">Units</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/index.html">Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/sire.html">sire module</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/sire_modules.html">Sub-modules</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Sub-modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_base.html">sire.base</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of sire.base</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/base.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_cas.html">sire.cas</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of sire.cas</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/cas.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_convert.html">sire.convert</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of sire.convert</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/convert.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_io.html">sire.io</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of sire.io</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/io.html">Public API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/io_parser.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_maths.html">sire.maths</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of sire.maths</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/maths.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_mm.html">sire.mm</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of sire.mm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/mm.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_mol.html">sire.mol</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of sire.mol</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/mol.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_morph.html">sire.morph</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of sire.morph</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/morph.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_restraints.html">sire.restraints</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of sire.restraints</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/restraints.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_search.html">sire.search</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of sire.search</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/search.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_stream.html">sire.stream</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of sire.stream</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/stream.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_system.html">sire.system</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of sire.system</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/system.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_units.html">sire.units</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of sire.units</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/units.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_utils.html">sire.utils</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of sire.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/utils.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_vol.html">sire.vol</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of sire.vol</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/vol.html">Public API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">How to ask for help</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../contributing/index.html">Contributing</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Contributing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/development.html">Developer’s guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/codestyle.html">Coding Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/packaging.html">Packaging releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/roadmap.html">Roadmap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html">Contributors</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code_of_conduct.html">Code of Conduct</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgements.html">Acknowledgements</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="converting-molecules">
<h1>Converting Molecules<a class="headerlink" href="#converting-molecules" title="Link to this heading">¶</a></h1>
<p>There are many available excellent molecular modelling packages for Python.
Rather than re-implementing their functionality, a design goal of
<a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> is to support easy interconversion so that functionality
from those packages can be built on and re-used.</p>
<p>The <a class="reference internal" href="../../api/convert.html#module-sire.convert" title="sire.convert"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire.convert</span></code></a> module contains functions that support the
conversion of the <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> molecular objects into their equivalents
in a number of other packages.</p>
<section id="biosimspace">
<h2>BioSimSpace<a class="headerlink" href="#biosimspace" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://biosimspace.openbiosim.org">BioSimSpace</a>
is an interoperable Python framework for biomolecular simulation that
makes it easy for you to write simulation workflow components for, e.g.
parameterising molecules, solvating systems, or running molecular
dynamics or free energy simulations using a number of different
backends (e.g. Amber, Gromacs, Namd etc.).</p>
<p>To convert a <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> object to a BioSimSpace object, you need to
ensure that you have imported BioSimSpace first in your script, before
you import <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">BioSimSpace</span> <span class="k">as</span> <span class="nn">BSS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sire</span> <span class="k">as</span> <span class="nn">sr</span>
</pre></div>
</div>
<p>To convert to BioSimSpace, you just need to pass the <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> molecular
object to the function <a class="reference internal" href="../../api/convert.html#sire.convert.to" title="sire.convert.to"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.convert.to()</span></code></a>, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">tutorial_url</span><span class="p">,</span> <span class="s2">&quot;ala.crd&quot;</span><span class="p">,</span> <span class="s2">&quot;ala.top&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">mols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bss_mol</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="s2">&quot;BioSimSpace&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bss_mol</span><span class="p">)</span>
<span class="go">&lt;BioSimSpace.Molecule: number=2, nAtoms=22, nResidues=3&gt;</span>
</pre></div>
</div>
<p>You can now use the BioSimSpace Molecule exactly as you would any other
BioSimSpace Molecule, e.g. calling BioSimSpace functions to generate
forcefield parameters, solvate it, or run molecular dynamics or
free energy simulations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the format argument to <code class="docutils literal notranslate"><span class="pre">sr.convert.to</span></code> is case-insensitive.
You could have use <code class="docutils literal notranslate"><span class="pre">bss_mol</span> <span class="pre">=</span> <span class="pre">sr.convert.to(mol,</span> <span class="pre">&quot;biosimspace&quot;)</span></code>.</p>
</div>
<p><a class="reference internal" href="../../api/convert.html#sire.convert.to" title="sire.convert.to"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.convert.to()</span></code></a> will convert any sub-view of a
molecule (e.g. a <a class="reference internal" href="../../api/mol.html#sire.mol.Residue" title="sire.mol.Residue"><code class="xref py py-class docutils literal notranslate"><span class="pre">Residue</span></code></a> or <a class="reference internal" href="../../api/mol.html#sire.mol.Atom" title="sire.mol.Atom"><code class="xref py py-class docutils literal notranslate"><span class="pre">Atom</span></code></a>)
into the BioSimSpace Molecule that contains that view.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span> <span class="o">=</span> <span class="n">mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bss_mol</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="s2">&quot;BioSimSpace&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bss_mol</span><span class="p">)</span>
<span class="go">&lt;BioSimSpace.Molecule: number=2, nAtoms=22, nResidues=3&gt;</span>
</pre></div>
</div>
<p>It will convert a list of <a class="reference internal" href="../../api/mol.html#sire.mol.Molecule" title="sire.mol.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> or sub-view
objects into a list of equivalent BioSimSpace Molecules, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bss_mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="s2">&quot;BioSimSpace&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bss_mols</span><span class="p">)</span>
<span class="go">[&lt;BioSimSpace.Molecule: number=2, nAtoms=22, nResidues=3&gt;,</span>
<span class="go"> &lt;BioSimSpace.Molecule: number=3, nAtoms=3, nResidues=1&gt;,</span>
<span class="go"> &lt;BioSimSpace.Molecule: number=4, nAtoms=3, nResidues=1&gt;,</span>
<span class="go"> &lt;BioSimSpace.Molecule: number=5, nAtoms=3, nResidues=1&gt;,</span>
<span class="go"> &lt;BioSimSpace.Molecule: number=6, nAtoms=3, nResidues=1&gt;,</span>
<span class="go"> &lt;BioSimSpace.Molecule: number=7, nAtoms=3, nResidues=1&gt;,</span>
<span class="go"> &lt;BioSimSpace.Molecule: number=8, nAtoms=3, nResidues=1&gt;,</span>
<span class="go"> &lt;BioSimSpace.Molecule: number=9, nAtoms=3, nResidues=1&gt;,</span>
<span class="go"> &lt;BioSimSpace.Molecule: number=10, nAtoms=3, nResidues=1&gt;,</span>
<span class="go"> &lt;BioSimSpace.Molecule: number=11, nAtoms=3, nResidues=1&gt;]</span>
</pre></div>
</div>
<blockquote>
<div><p>There is also logic to convert a <a class="reference internal" href="../../api/system.html#sire.system.System" title="sire.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> object,
which is the collection of molecules plus associated metadata read
from an input file, into the equivalent BioSimSpace System class.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bss_sys</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="s2">&quot;BioSimSpace&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bss_sys</span><span class="p">)</span>
<span class="go">&lt;BioSimSpace.System: nMolecules=631&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p>You can convert back from BioSimSpace to <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> using the same
function. For example,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">bss_mol</span><span class="p">,</span> <span class="s2">&quot;sire&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">Molecule( ACE:2   num_atoms=22 num_residues=3 )</span>
</pre></div>
</div>
<p>Note that any sub-view of a BioSimSpace object will be converted to the
<a class="reference internal" href="../../api/mol.html#sire.mol.Molecule" title="sire.mol.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> that contains that view, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">bss_mol</span><span class="o">.</span><span class="n">getAtoms</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;sire&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">Molecule( ACE:2   num_atoms=22 num_residues=3 )</span>
</pre></div>
</div>
<p>A list of BioSimSpace molecule (or sub-view) objects will be converted to
a list of <a class="reference internal" href="../../api/mol.html#sire.mol.Molecule" title="sire.mol.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> objects.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">bss_mols</span><span class="p">,</span> <span class="s2">&quot;sire&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
<span class="go">SelectorMol( size=10</span>
<span class="go">0: Molecule( ACE:2   num_atoms=22 num_residues=3 )</span>
<span class="go">1: Molecule( WAT:3   num_atoms=3 num_residues=1 )</span>
<span class="go">2: Molecule( WAT:4   num_atoms=3 num_residues=1 )</span>
<span class="go">3: Molecule( WAT:5   num_atoms=3 num_residues=1 )</span>
<span class="go">4: Molecule( WAT:6   num_atoms=3 num_residues=1 )</span>
<span class="go">5: Molecule( WAT:7   num_atoms=3 num_residues=1 )</span>
<span class="go">6: Molecule( WAT:8   num_atoms=3 num_residues=1 )</span>
<span class="go">7: Molecule( WAT:9   num_atoms=3 num_residues=1 )</span>
<span class="go">8: Molecule( WAT:10  num_atoms=3 num_residues=1 )</span>
<span class="go">9: Molecule( WAT:11  num_atoms=3 num_residues=1 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>And a BioSimSpace System will be automatically converted to a
<a class="reference internal" href="../../api/system.html#sire.system.System" title="sire.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> object.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">bss_sys</span><span class="p">,</span> <span class="s2">&quot;sire&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
<span class="go">System( name=ACE num_molecules=631 num_residues=633 num_atoms=1912 )</span>
</pre></div>
</div>
</section>
<section id="rdkit">
<h2>RDKit<a class="headerlink" href="#rdkit" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://rdkit.org">RDKit</a> is a collection of cheminformatics and
machine-learning software written in C++ and Python. Assuming you have
RDKit installed, you can convert <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> molecule and molecule view
objects to and from RDKit Molecule objects.</p>
<p>The <a class="reference internal" href="../../api/convert.html#sire.convert.supported_formats" title="sire.convert.supported_formats"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.convert.supported_formats()</span></code></a> function lists the formats that
<a class="reference internal" href="../../api/convert.html#module-sire.convert" title="sire.convert"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire.convert</span></code></a> supports for the current installation. This will
depend on whether or not you have the package installed in the same conda
environment as <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a>, and whether or not <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> was compiled
with support for that package.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">supported_formats</span><span class="p">())</span>
<span class="go">[&#39;biosimspace&#39;, &#39;gemmi&#39;, &#39;openmm&#39;, &#39;rdkit&#39;, &#39;sire&#39;]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> isn’t listed, then you should quit Python and install
it, e.g. using the command <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">conda-forge</span> <span class="pre">rdkit</span></code>.
If it still isn’t listed then please raise an issue on the
<a class="reference external" href="https://github.com/OpenBioSim/sire/issues">sire GitHub repository</a>.</p>
</div>
<p>You can convert to RDKit by passing <code class="docutils literal notranslate"><span class="pre">rdkit</span></code> as the format argument to
<a class="reference internal" href="../../api/convert.html#sire.convert.to" title="sire.convert.to"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.convert.to()</span></code></a>, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdkit_mol</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="s2">&quot;rdkit&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rdkit_mol</span><span class="p">)</span>
<span class="go">&lt;rdkit.Chem.rdchem.Mol object at 0x10283da10&gt;</span>
</pre></div>
</div>
<p>You can now use this RDKit Mol object identically to any other
RDKit Mol object, e.g. generating smiles strings, performing
sub-structure searches, maximum common substructure alignments,
generating 2D views etc.</p>
<p>Just as for BioSimSpace, <a class="reference internal" href="../../api/convert.html#sire.convert.to" title="sire.convert.to"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.convert.to()</span></code></a> will return the RDKit Mol
for the entire molecule that contains any sub-views that are passed.
For example,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdkit_mol</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;rdkit&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rdkit_mol</span><span class="o">.</span><span class="n">GetNumAtoms</span><span class="p">())</span>
<span class="go">22</span>
</pre></div>
</div>
<p>Passing in a list of molecules or molecule views to convert will return
a list of RDKit Mol objects.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdkit_mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="s2">&quot;rdkit&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rdkit_mols</span><span class="p">)</span>
<span class="go">[&lt;rdkit.Chem.rdchem.Mol object at 0x102c6a180&gt;, &lt;rdkit.Chem.rdchem.Mol object at 0x102c6a340&gt;,</span>
<span class="go">&lt;rdkit.Chem.rdchem.Mol object at 0x102c6a3b0&gt;, &lt;rdkit.Chem.rdchem.Mol object at 0x102c69d90&gt;,</span>
<span class="go">&lt;rdkit.Chem.rdchem.Mol object at 0x102c6a1f0&gt;, &lt;rdkit.Chem.rdchem.Mol object at 0x102c69af0&gt;,</span>
<span class="go">&lt;rdkit.Chem.rdchem.Mol object at 0x102c698c0&gt;, &lt;rdkit.Chem.rdchem.Mol object at 0x102c69bd0&gt;,</span>
<span class="go">&lt;rdkit.Chem.rdchem.Mol object at 0x102c69e00&gt;, &lt;rdkit.Chem.rdchem.Mol object at 0x102c69cb0&gt;]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>RDKit does not have an equivalent of a <a class="reference internal" href="../../api/system.html#sire.system.System" title="sire.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> object,
so these will be converted to a list of RDKit Mol objects.</p>
</div>
<p>You can also convert RDKit Mol objects back to <a class="reference internal" href="../../api/mol.html#sire.mol.Molecule" title="sire.mol.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a>
objects, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rdkit_mol</span><span class="p">,</span> <span class="s2">&quot;sire&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go">Molecule( ACE:633 num_atoms=22 num_residues=1 )</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rdkit_mols</span><span class="p">,</span> <span class="s2">&quot;sire&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
<span class="go">SelectorMol( size=10</span>
<span class="go">0: Molecule( ACE:634 num_atoms=22 num_residues=1 )</span>
<span class="go">1: Molecule( WAT:635 num_atoms=3 num_residues=1 )</span>
<span class="go">2: Molecule( WAT:636 num_atoms=3 num_residues=1 )</span>
<span class="go">3: Molecule( WAT:637 num_atoms=3 num_residues=1 )</span>
<span class="go">4: Molecule( WAT:638 num_atoms=3 num_residues=1 )</span>
<span class="go">5: Molecule( WAT:639 num_atoms=3 num_residues=1 )</span>
<span class="go">6: Molecule( WAT:640 num_atoms=3 num_residues=1 )</span>
<span class="go">7: Molecule( WAT:641 num_atoms=3 num_residues=1 )</span>
<span class="go">8: Molecule( WAT:642 num_atoms=3 num_residues=1 )</span>
<span class="go">9: Molecule( WAT:643 num_atoms=3 num_residues=1 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>This is useful, e.g. if you have created the molecule using RDKit’s
smiles functionality, and then want to convert to a <a class="reference internal" href="../../api/mol.html#sire.mol.Molecule" title="sire.mol.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a>
object for continued manipulation.</p>
</section>
<section id="openmm">
<h2>OpenMM<a class="headerlink" href="#openmm" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://openmm.org">OpenMM</a> is a high-performance toolkit for molecular
simulation, which is particularly suited to running GPU-accelerated
molecular dynamics (and related) simulations.</p>
<p>The <a class="reference internal" href="../../api/convert.html#sire.convert.supported_formats" title="sire.convert.supported_formats"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.convert.supported_formats()</span></code></a> function lists the formats that
<a class="reference internal" href="../../api/convert.html#module-sire.convert" title="sire.convert"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire.convert</span></code></a> supports for the current installation. This will
depend on whether or not you have the package installed in the same conda
environment as <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a>, and whether or not <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> was compiled
with support for that package.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">supported_formats</span><span class="p">())</span>
<span class="go">[&#39;biosimspace&#39;, &#39;gemmi&#39;, &#39;openmm&#39;, &#39;rdkit&#39;, &#39;sire&#39;]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">openmm</span></code> isn’t listed, then you should quit Python and install
it, e.g. using the command <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">conda-forge</span> <span class="pre">openmm</span></code>.
If it still isn’t listed then please raise an issue on the
<a class="reference external" href="https://github.com/OpenBioSim/sire/issues">sire GitHub repository</a>.</p>
</div>
<p><a class="reference internal" href="../../api/convert.html#sire.convert.to" title="sire.convert.to"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.convert.to()</span></code></a> can convert a <a class="reference internal" href="../../api/mol.html#sire.mol.Molecule" title="sire.mol.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a> or
molecule view into the equivalent for OpenMM.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">tutorial_url</span><span class="p">,</span> <span class="s2">&quot;ala.crd&quot;</span><span class="p">,</span> <span class="s2">&quot;ala.top&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omm</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;openmm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">omm</span><span class="p">)</span>
<span class="go">&lt;openmm.openmm.Context; proxy of &lt;Swig Object of type &#39;OpenMM::Context *&#39; at 0x14e95b510&gt; &gt;</span>
</pre></div>
</div>
<p>The result is an OpenMM Context object which contains just the first molecule
from <code class="docutils literal notranslate"><span class="pre">mols</span></code>. This can be used just like any
other OpenMM Context object, e.g. for running minimisation or dynamics.</p>
<p>An OpenMM Context object is returned because it contains within it:</p>
<ul class="simple">
<li><p>Representations of the potentials and connectivity of the molecule(s)
in the OpenMM System object (obtained via <code class="docutils literal notranslate"><span class="pre">omm.getSystem()</span></code>)</p></li>
<li><p>The current coordinates and (optionally) the velocities of the
molecule(s) in the OpenMM Integrator object (obtained via
<code class="docutils literal notranslate"><span class="pre">omm.getIntegrator()</span></code>).</p></li>
</ul>
<p>The context has placed these two object onto an OpenMM Platform object
(obtained via <code class="docutils literal notranslate"><span class="pre">omm.getPlatform()</span></code>), so that the Context is ready for
simulation. You can change the platform or choose a new Integrator by
using the <code class="docutils literal notranslate"><span class="pre">omm.getSystem()</span></code> or <code class="docutils literal notranslate"><span class="pre">omm.getIntegrator()</span></code> to extract these
objects and then recombine them with the platform or integrator of your choice.</p>
<p>More detail on how you can control what platform and integrator is chosen
for this conversion is <a class="reference internal" href="../../cheatsheet/openmm.html"><span class="doc">available here</span></a>.</p>
<p>You can convert a single molecule, list of molecules or an entire
<a class="reference internal" href="../../api/system.html#sire.system.System" title="sire.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> to an OpenMM context in the same way, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">omm</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="s2">&quot;openmm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">omm</span><span class="p">)</span>
<span class="go">&lt;openmm.openmm.Context; proxy of &lt;Swig Object of type &#39;OpenMM::Context *&#39; at 0x14e9ee220&gt; &gt;</span>
</pre></div>
</div>
<p>We do plan to add code to allow conversion back from an OpenMM Context to
the equivalent <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> object, but this is not yet ready for release.</p>
<p>Instead, we have lower-level functions that extract coordinates, velocities
and <code class="xref py py-class docutils literal notranslate"><span class="pre">Space</span></code> objects from OpenMM State objects that are
extracted from the Context. Please do get in touch with us if you would like
to learn about these functions, and would like to contribute to coding
a more complete OpenMM to sire converter.</p>
</section>
<section id="gemmi">
<h2>Gemmi<a class="headerlink" href="#gemmi" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://gemmi.readthedocs.io/en/latest/">Gemmi</a> is a Python library
developed primarily for use in macromolecular crystallography (MX).
In particular it can be used to parse PDBx/mmCIF files, refinement
restraints, reflection data, 3D grid data and dealing with
crystallographic symmetry. This is useful for structural bioinformatics.</p>
<p>The <a class="reference internal" href="../../api/convert.html#sire.convert.supported_formats" title="sire.convert.supported_formats"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.convert.supported_formats()</span></code></a> function lists the formats that
<a class="reference internal" href="../../api/convert.html#module-sire.convert" title="sire.convert"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire.convert</span></code></a> supports for the current installation. This will
depend on whether or not you have the package installed in the same conda
environment as <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a>, and whether or not <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> was compiled
with support for that package.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">supported_formats</span><span class="p">())</span>
<span class="go">[&#39;biosimspace&#39;, &#39;gemmi&#39;, &#39;openmm&#39;, &#39;rdkit&#39;, &#39;sire&#39;]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">gemmi</span></code> isn’t listed, then you should quit Python and install
it, e.g. using the command <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">-c</span> <span class="pre">conda-forge</span> <span class="pre">gemmi</span></code>.
If it still isn’t listed then please raise an issue on the
<a class="reference external" href="https://github.com/OpenBioSim/sire/issues">sire GitHub repository</a>.</p>
</div>
<p><a class="reference internal" href="../../api/convert.html#sire.convert.to" title="sire.convert.to"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.convert.to()</span></code></a> can convert a <a class="reference internal" href="../../api/system.html#sire.system.System" title="sire.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>, list
of molecules, or single molecule into a
<a class="reference external" href="https://gemmi.readthedocs.io/en/latest/mol.html#structure">Gemmi Structure</a>
object.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">tutorial_url</span><span class="p">,</span> <span class="s2">&quot;ala.crd&quot;</span><span class="p">,</span> <span class="s2">&quot;ala.top&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gemmi_struct</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="s2">&quot;gemmi&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">gemmi_struct</span><span class="p">)</span>
<span class="go">&lt;gemmi.Structure  with 1 model(s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">gemmi_struct</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_all_residue_names</span><span class="p">())</span>
<span class="go">[&#39;ACE&#39;, &#39;ALA&#39;, &#39;NME&#39;, &#39;WAT&#39;]</span>
</pre></div>
</div>
<p>Passing in a single molecule or subset of molecules will return a
<a class="reference external" href="https://gemmi.readthedocs.io/en/latest/mol.html#structure">Gemmi Structure</a>
with just those molecules, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gemmi_struct</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;gemmi&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">gemmi_struct</span><span class="p">)</span>
<span class="go">&lt;gemmi.Structure  with 1 model(s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">gemmi_struct</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_all_residue_names</span><span class="p">())</span>
<span class="go">[&#39;ACE&#39;, &#39;ALA&#39;, &#39;NME&#39;]</span>
</pre></div>
</div>
<p>You can convert a
<a class="reference external" href="https://gemmi.readthedocs.io/en/latest/mol.html#structure">Gemmi Structure</a>
back to a <a class="reference internal" href="../../api/system.html#sire.system.System" title="sire.system.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> object, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">gemmi_struct</span><span class="p">,</span> <span class="s2">&quot;sire&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="p">)</span>
<span class="go">System( name= num_molecules=1 num_residues=3 num_atoms=22 )</span>
</pre></div>
</div>
<p>This conversion also preserves user-supplied System metadata, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;alanine dipeptide&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="s2">&quot;residues&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;ACE&quot;</span><span class="p">,</span> <span class="s2">&quot;ALA&quot;</span><span class="p">,</span> <span class="s2">&quot;NME&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span><span class="o">.</span><span class="n">set_metadata</span><span class="p">(</span><span class="s2">&quot;atoms&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;element&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s2">&quot;x_coords&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s2">&quot;y_coords&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="s2">&quot;z_coords&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">6.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="s2">&quot;test.pdbx&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>would add the following to the PDBx/mmCIF file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>data_sire
loop_
_atoms.element
_atoms.x_coords
_atoms.y_coords
_atoms.z_coords
C 0 3 6
N 1 4 7
O 2 5 8

_name &quot;alanine dipeptide&quot;

loop_
_residues.value
ACE
ALA
NME
</pre></div>
</div>
<p>which could be recovered when loading the file…</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;test.pdbx&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="o">.</span><span class="n">metadata</span><span class="p">())</span>
<span class="go">Properties(</span>
<span class="go">    residues =&gt; [ ACE,ALA,NME ],</span>
<span class="go">    name =&gt; alanine dipeptide,</span>
<span class="go">    atoms =&gt; Properties(</span>
<span class="go">    element =&gt; SireBase::StringArrayProperty( size=3</span>
<span class="go">0: C</span>
<span class="go">1: N</span>
<span class="go">2: O</span>
<span class="go">),</span>
<span class="go">    x_coords =&gt; SireBase::StringArrayProperty( size=3</span>
<span class="go">0: 0</span>
<span class="go">1: 1</span>
<span class="go">2: 2</span>
<span class="go">),</span>
<span class="go">    y_coords =&gt; SireBase::StringArrayProperty( size=3</span>
<span class="go">0: 3</span>
<span class="go">1: 4</span>
<span class="go">2: 5</span>
<span class="go">),</span>
<span class="go">    z_coords =&gt; SireBase::StringArrayProperty( size=3</span>
<span class="go">0: 6</span>
<span class="go">1: 7</span>
<span class="go">2: 8</span>
<span class="go">)</span>
<span class="go">)</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that metadata values loaded from a PDBx/mmCIF file are always
stored as strings. You may need to convert them to the appropriate
type for your application (e.g., here the coordinate values are
the strings “0”, “1”, “2” etc. rather than the numbers 0, 1, 2 etc.).</p>
</div>
</section>
<section id="anything-to-anything">
<h2>Anything to Anything<a class="headerlink" href="#anything-to-anything" title="Link to this heading">¶</a></h2>
<p>Above you have seen how <a class="reference internal" href="../../api/convert.html#sire.convert.to" title="sire.convert.to"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.convert.to()</span></code></a> can convert to and from
<a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> objects and other molecular modelling package objects.</p>
<p>It is actually more powerful than that! It recognises the object being
passed and can convert between any two object types that are supported
by <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a>, using the <a class="reference internal" href="../../api/sire.html#module-sire" title="sire"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire</span></code></a> object format as an
intermediary.</p>
<p>For example, you can convert RDKit objects to BioSimSpace objects…</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">BioSimSpace</span> <span class="k">as</span> <span class="nn">BSS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sire</span> <span class="k">as</span> <span class="nn">sr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdkit_mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;Cc1ccccc1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bss_mol</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">rdkit_mol</span><span class="p">,</span> <span class="s2">&quot;BioSimSpace&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bss_mol</span>
<span class="go">&lt;BioSimSpace.Molecule: number=2, nAtoms=7, nResidues=1&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Remember that you may need to exit Python and then restart to ensure
that BioSimSpace is imported before sire.</p>
</div>
<p>Or you could convert BioSimSpace molecules back to RDKit…</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rdkit_mol</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">bss_mol</span><span class="p">,</span> <span class="s2">&quot;rdkit&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">rdkit_mol</span><span class="p">))</span>
<span class="go">[C-3]c1[c][c][c][c][c]1</span>
</pre></div>
</div>
<p>or you could setup and parameterise a molecule in BioSimSpace and
convert it to an OpenMM Context ready for minimisation or dynamics…</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">tutorialUrl</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bss_system</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">readMolecules</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">/ala.top&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s2">/ala.crd&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omm</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">bss_system</span><span class="p">,</span> <span class="s2">&quot;openmm&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integrator</span> <span class="o">=</span> <span class="n">omm</span><span class="o">.</span><span class="n">getIntegrator</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integrator</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">omm</span><span class="o">.</span><span class="n">getState</span><span class="p">()</span><span class="o">.</span><span class="n">getTime</span><span class="p">())</span>
<span class="go">0.010000000000000002 ps</span>
</pre></div>
</div>
<p>or you could load a PDBx file from Gemmi and convert a “MAN” moelcule within it
into an RDKit structure…</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">gemmi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sire</span> <span class="k">as</span> <span class="nn">sr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">rdkit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">urllib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="s2">&quot;https://files.rcsb.org/download/3NSS.cif.gz&quot;</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;3NSS.cif.gz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">struct</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">read_structure</span><span class="p">(</span><span class="s2">&quot;3NSS.cif.gz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">gemmi</span><span class="o">.</span><span class="n">Selection</span><span class="p">(</span><span class="s2">&quot;(MAN)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">copy_structure_selection</span><span class="p">(</span><span class="n">struct</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rdkit_mol</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mol</span><span class="p">,</span> <span class="s2">&quot;rdkit&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">rdkit_mol</span><span class="p">))</span>
<span class="go">O=C=C1OC(OC2=C(=O)C(=C=O)O[C-]=C2[O-])=C(=O)=C(=O)C1=O</span>
</pre></div>
</div>
</section>
<section id="supporting-other-formats">
<h2>Supporting other formats<a class="headerlink" href="#supporting-other-formats" title="Link to this heading">¶</a></h2>
<p>We are actively looking for other molecular modelling packages to support.
Please get in touch if you would like to suggest a package we should
look at, or if you want to provide some help with implementation.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="02_view.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Viewing Molecules in 2D</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../index_part05.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Part 5 - Interconverting with other Packages</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Oct 23, 2024</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Converting Molecules</a><ul>
<li><a class="reference internal" href="#biosimspace">BioSimSpace</a></li>
<li><a class="reference internal" href="#rdkit">RDKit</a></li>
<li><a class="reference internal" href="#openmm">OpenMM</a></li>
<li><a class="reference internal" href="#gemmi">Gemmi</a></li>
<li><a class="reference internal" href="#anything-to-anything">Anything to Anything</a></li>
<li><a class="reference internal" href="#supporting-other-formats">Supporting other formats</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=7b2d7c30"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/js/custom.js?v=c9df2d0f"></script>
    </body>
</html>