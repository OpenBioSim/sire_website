<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Alchemical Restraints" href="04_alchemical_restraints.html" /><link rel="prev" title="Alchemical Dynamics" href="02_alchemical_dynamics.html" />

    <link rel="shortcut icon" href="../../_static/favicon.png"/><!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Restraints - openbiosim - sire</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom_fonts.css?v=50da5bc0" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom_style.css?v=094c566b" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom_pygments.css?v=c839eb9e" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --font-stack: Changa, sans-serif;
  --font-stack--monospace: Roboto Mono, monospace;
  --color-foreground-primary: #dddddd;
  --color-foreground-secondary: #cccccc;
  --color-foreground-muted: #d0d0d0;
  --color-foreground-border: #923eb1;
  --color-background-primary: #160f30;
  --color-background-secondary: #201146;
  --color-background-hover: #4f4fb0;
  --color-background-hover--transparent: #4f4fb000;
  --color-background-border: #403333;
  --color-background-item: #411a30;
  --color-announcement-background: #000000dd;
  --color-announcement-text: #eeebee;
  --color-admonition-title-background--note: #FFFFFF33;
  --color-admonition-title-background--warning: #FF000033;
  --color-admonition-background: #FFFFFF11;
  --color-brand-primary: #eeeeee;
  --color-brand-content: #00dfef;
  --color-highlight-on-target: #333300;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">openbiosim - sire</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div>
<div class="sidebar-search">
  <div class="version_container">
    <div class="version_label">Branch</div>
    <div id="version_box" class="version_box"></div>
  </div>
</div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Quick Start Guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Tutorial</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorial</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part01.html">Part 1 - Loading and Saving</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Part 1 - Loading and Saving</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part01/01_importing_sire.html">Importing sire</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/02_loading_a_molecule.html">Loading a molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/03_simple_indexing.html">Simple indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/04_saving_a_molecule.html">Saving a molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/05_loading_from_multiple_files.html">Loading from multiple files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/06_trajectories.html">Loading and saving trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/07_supported_file_formats.html">Supported file formats</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part02.html">Part 2 - Indexing and Searching</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Part 2 - Indexing and Searching</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part02/01_indexing_atoms.html">Indexing Atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/02_indexing_residues.html">Indexing Residues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/03_indexing_chains.html">Indexing Chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/04_indexing_segments.html">Indexing Segments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/05_indexing_molecules.html">Indexing Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/06_indexing_bonds.html">Indexing Bonds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/07_indexing_angles.html">Indexing Angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/08_indexing_dihedrals.html">Indexing Dihedrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/09_indexing_impropers.html">Indexing Impropers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/10_searching.html">Searching</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part03.html">Part 3 - Molecular Properties</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Part 3 - Molecular Properties</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part03/01_atom_properties.html">Atom Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/02_cursors.html">Cursors and Editing Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/03_residue_properties.html">Residue, Chain and Segment Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/04_molecule_properties.html">Molecule Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/05_bond_properties.html">Bond Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/06_angle_properties.html">Angle Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/07_dihedral_properties.html">Dihedral Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/08_improper_properties.html">Improper Views and Properties</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part04.html">Part 4 - Measurement, Trajectories and Movement</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Part 4 - Measurement, Trajectories and Movement</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part04/01_measure.html">Measuring Distances and Angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part04/02_trajectory.html">Measuring Trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part04/03_energies.html">Measuring Energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part04/04_energy_trajectories.html">Measuring Energies Across Trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part04/05_movement.html">Moving Atoms and Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part04/06_move_internals.html">Moving Bonds, Angles and Dihedrals</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part05.html">Part 5 - Interconverting with other Packages</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Part 5 - Interconverting with other Packages</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part05/01_convert.html">Converting Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part05/02_view.html">Viewing Molecules in 2D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part05/03_smiles.html">Creating Molecules from Smiles Strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part05/04_smarts.html">Searching for Fragments using Smarts Strings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part05/05_dynamics.html">Molecular Dynamics and Minimisation</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../index_part06.html">Part 6 - Morphs and Alchemical Free Energies</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Part 6 - Morphs and Alchemical Free Energies</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="01_merge.html">Merged Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="02_alchemical_dynamics.html">Alchemical Dynamics</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Restraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="04_alchemical_restraints.html">Alchemical Restraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="05_free_energy_perturbation.html">Running a Free Energy Perturbation Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="06_faster_fep.html">Running Faster Free Energy Simulations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../blogposts.html">Diaries</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cheatsheet/index.html">Detailed Guides</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Detailed Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cheatsheet/search.html">Searching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cheatsheet/trajectory.html">Trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cheatsheet/view.html">Viewing Molecules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cheatsheet/openmm.html">OpenMM Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cheatsheet/units.html">Units</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/index.html">Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/sire.html">sire module</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/sire_modules.html">Sub-modules</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Sub-modules</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_base.html">sire.base</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of sire.base</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/base.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_cas.html">sire.cas</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of sire.cas</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/cas.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_convert.html">sire.convert</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of sire.convert</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/convert.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_io.html">sire.io</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of sire.io</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/io.html">Public API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/io_parser.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_maths.html">sire.maths</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of sire.maths</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/maths.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_mm.html">sire.mm</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of sire.mm</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/mm.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_mol.html">sire.mol</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of sire.mol</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/mol.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_morph.html">sire.morph</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of sire.morph</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/morph.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_restraints.html">sire.restraints</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of sire.restraints</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/restraints.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_search.html">sire.search</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of sire.search</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/search.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_stream.html">sire.stream</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of sire.stream</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/stream.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_system.html">sire.system</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of sire.system</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/system.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_units.html">sire.units</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of sire.units</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/units.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_utils.html">sire.utils</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of sire.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/utils.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_vol.html">sire.vol</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of sire.vol</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/vol.html">Public API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">How to ask for help</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../contributing/index.html">Contributing</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Contributing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/development.html">Developer’s guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/codestyle.html">Coding Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/packaging.html">Packaging releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/roadmap.html">Roadmap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html">Contributors</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code_of_conduct.html">Code of Conduct</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgements.html">Acknowledgements</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="restraints">
<h1>Restraints<a class="headerlink" href="#restraints" title="Link to this heading">#</a></h1>
<p>It can be useful to add restraints to the system to hold things in place.  For
example, you might want to hold the protein fixed while allowing the ligand to
move around. Or you may want to hold a ligand in place while it is being
decoupled from the simulation. Or you may want to use restraints to control
the distances between atoms or pull a molecule into a particular conformation.</p>
<p>You can specify the restraints you want to add to a system via the functions
in the <a class="reference internal" href="../../api/restraints.html#module-sire.restraints" title="sire.restraints"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire.restraints</span></code></a> module. These functions return
<code class="xref py py-class docutils literal notranslate"><span class="pre">Restraints</span></code> objects that contain all of the information that
needs to be passed to OpenMM to add the restraints to the system.</p>
<section id="positional-restraints">
<h2>Positional Restraints<a class="headerlink" href="#positional-restraints" title="Link to this heading">#</a></h2>
<p>The simplest type of restraint is a positional restraint, which holds a set of
atoms at a fixed position.  You can create a positional restraint using the
<a class="reference internal" href="../../api/restraints.html#sire.restraints.positional" title="sire.restraints.positional"><code class="xref py py-func docutils literal notranslate"><span class="pre">positional()</span></code></a> function.  This function takes the
set of molecules or system you want to simulate, together with a search
string, list of atom indexes, or molecule views holding the atoms that
you want to restrain. For example,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sire</span> <span class="k">as</span> <span class="nn">sr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">tutorial_url</span><span class="p">,</span> <span class="s2">&quot;ala.top&quot;</span><span class="p">,</span> <span class="s2">&quot;ala.crd&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">positional</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="s2">&quot;resname ALA and element C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">restraints</span><span class="p">)</span>
<span class="go">PositionalRestraints( size=3</span>
<span class="go">0: PositionalRestraint( 8 =&gt; ( 16.5371, 5.02707, 15.812 ), k=150 kcal mol-1 Å-2 : r0=0 Å )</span>
<span class="go">1: PositionalRestraint( 10 =&gt; ( 16.0464, 6.38937, 15.2588 ), k=150 kcal mol-1 Å-2 : r0=0 Å )</span>
<span class="go">2: PositionalRestraint( 14 =&gt; ( 15.3698, 4.19397, 16.434 ), k=150 kcal mol-1 Å-2 : r0=0 Å )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>will create positional restraints for the three carbon atoms in the alanine
residue. These carbon atoms are at indexes 8, 10 and 14 in <code class="docutils literal notranslate"><span class="pre">mols.atoms()</span></code>,
e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="o">.</span><span class="n">atoms</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">]))</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=3</span>
<span class="go">0: MolNum(6) Atom( CA:9    [  16.54,    5.03,   15.81] )</span>
<span class="go">1: MolNum(6) Atom( CB:11   [  16.05,    6.39,   15.26] )</span>
<span class="go">2: MolNum(6) Atom( C:15    [  15.37,    4.19,   16.43] )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>You could have specified these indicies directly, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">positional</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">restraints</span><span class="p">)</span>
<span class="go">PositionalRestraints( size=3</span>
<span class="go">0: PositionalRestraint( 8 =&gt; ( 16.5371, 5.02707, 15.812 ), k=150 kcal mol-1 Å-2 : r0=0 Å )</span>
<span class="go">1: PositionalRestraint( 10 =&gt; ( 16.0464, 6.38937, 15.2588 ), k=150 kcal mol-1 Å-2 : r0=0 Å )</span>
<span class="go">2: PositionalRestraint( 14 =&gt; ( 15.3698, 4.19397, 16.434 ), k=150 kcal mol-1 Å-2 : r0=0 Å )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>or just passed in the atoms directly, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">atoms</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">positional</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">restraints</span><span class="p">)</span>
<span class="go">PositionalRestraints( size=3</span>
<span class="go">0: PositionalRestraint( 8 =&gt; ( 16.5371, 5.02707, 15.812 ), k=150 kcal mol-1 Å-2 : r0=0 Å )</span>
<span class="go">1: PositionalRestraint( 10 =&gt; ( 16.0464, 6.38937, 15.2588 ), k=150 kcal mol-1 Å-2 : r0=0 Å )</span>
<span class="go">2: PositionalRestraint( 14 =&gt; ( 15.3698, 4.19397, 16.434 ), k=150 kcal mol-1 Å-2 : r0=0 Å )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>The default force constant is 150 kcal mol-1 Å-2. By default, the
atoms are restrained to their current positions, and are held exactly in
those positions (hence why the <code class="docutils literal notranslate"><span class="pre">r0=0</span> <span class="pre">Å</span></code> in the output above).</p>
<p>You can set the force constant and width of the half-harmonic restraint
used to hold the atoms in position using the <code class="docutils literal notranslate"><span class="pre">k</span></code> and <code class="docutils literal notranslate"><span class="pre">r0</span></code> arguments, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">positional</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="s2">&quot;resname ALA and element C&quot;</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">k</span><span class="o">=</span><span class="s2">&quot;100 kcal mol-1 A-2&quot;</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="s2">&quot;1.5 A&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">restraints</span><span class="p">)</span>
<span class="go">PositionalRestraints( size=3</span>
<span class="go">0: PositionalRestraint( 8 =&gt; ( 16.5371, 5.02707, 15.812 ), k=100 kcal mol-1 Å-2 : r0=1.5 Å )</span>
<span class="go">1: PositionalRestraint( 10 =&gt; ( 16.0464, 6.38937, 15.2588 ), k=100 kcal mol-1 Å-2 : r0=1.5 Å )</span>
<span class="go">2: PositionalRestraint( 14 =&gt; ( 15.3698, 4.19397, 16.434 ), k=100 kcal mol-1 Å-2 : r0=1.5 Å )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>By default, the atoms are restrained to their current positions. You can
specify a different position using the <code class="docutils literal notranslate"><span class="pre">position</span></code> argument, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">positional</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="s2">&quot;resname ALA and element C&quot;</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">position</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">restraints</span><span class="p">)</span>
<span class="go">PositionalRestraints( size=3</span>
<span class="go">0: PositionalRestraint( 8 =&gt; ( 0, 0, 0 ), k=150 kcal mol-1 Å-2 : r0=0 Å )</span>
<span class="go">1: PositionalRestraint( 10 =&gt; ( 1, 1, 1 ), k=150 kcal mol-1 Å-2 : r0=0 Å )</span>
<span class="go">2: PositionalRestraint( 14 =&gt; ( 2, 2, 2 ), k=150 kcal mol-1 Å-2 : r0=0 Å )</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of positions must equal the number of atoms to be restrained,
or equal to 1. If you only pass in a single position then this will be used
for all of the restraints.</p>
</div>
<p>Sometimes it can be useful to use the same position for all of the restraints,
e.g. in the case of a spherical half-harmonic restraint that holds molecules
within a spherical bubble, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">center</span> <span class="o">=</span> <span class="n">mols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">positional</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">atoms</span><span class="o">=</span><span class="n">mols</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;atoms within 10 of </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],</span>
<span class="gp">... </span>                                      <span class="n">position</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">r0</span><span class="o">=</span><span class="s2">&quot;10 A&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">restraints</span><span class="p">)</span>
<span class="go">PositionalRestraints( size=358</span>
<span class="go">0: PositionalRestraint( 0 =&gt; ( 16.5471, 4.50102, 15.6589 ), k=150 kcal mol-1 Å-2 : r0=10 Å )</span>
<span class="go">1: PositionalRestraint( 1 =&gt; ( 16.5471, 4.50102, 15.6589 ), k=150 kcal mol-1 Å-2 : r0=10 Å )</span>
<span class="go">2: PositionalRestraint( 2 =&gt; ( 16.5471, 4.50102, 15.6589 ), k=150 kcal mol-1 Å-2 : r0=10 Å )</span>
<span class="go">3: PositionalRestraint( 3 =&gt; ( 16.5471, 4.50102, 15.6589 ), k=150 kcal mol-1 Å-2 : r0=10 Å )</span>
<span class="go">4: PositionalRestraint( 4 =&gt; ( 16.5471, 4.50102, 15.6589 ), k=150 kcal mol-1 Å-2 : r0=10 Å )</span>
<span class="go">...</span>
<span class="go">353: PositionalRestraint( 1892 =&gt; ( 16.5471, 4.50102, 15.6589 ), k=150 kcal mol-1 Å-2 : r0=10 Å )</span>
<span class="go">354: PositionalRestraint( 1893 =&gt; ( 16.5471, 4.50102, 15.6589 ), k=150 kcal mol-1 Å-2 : r0=10 Å )</span>
<span class="go">355: PositionalRestraint( 1906 =&gt; ( 16.5471, 4.50102, 15.6589 ), k=150 kcal mol-1 Å-2 : r0=10 Å )</span>
<span class="go">356: PositionalRestraint( 1907 =&gt; ( 16.5471, 4.50102, 15.6589 ), k=150 kcal mol-1 Å-2 : r0=10 Å )</span>
<span class="go">357: PositionalRestraint( 1908 =&gt; ( 16.5471, 4.50102, 15.6589 ), k=150 kcal mol-1 Å-2 : r0=10 Å )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>has created half-harmonic restraints that affect all atoms within 10 Å of the
center of the first molecule, and that restrain those atoms to be within
a sphere of radius 10 Å centered on that molecule.</p>
<p>Note that the restraints only contain the indicies of the atoms that are
restrained, not the atoms themselves. You can get the atoms by looking up
those indicies from the <code class="docutils literal notranslate"><span class="pre">mols</span></code> molecular container from which the
atoms were selected. For example, here we get all of the atoms that are
subject to that spherical half-harmonic restraint;</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mols</span><span class="o">.</span><span class="n">atoms</span><span class="p">()[[</span><span class="n">restraint</span><span class="o">.</span><span class="n">atom</span><span class="p">()</span> <span class="k">for</span> <span class="n">restraint</span> <span class="ow">in</span> <span class="n">restraints</span><span class="p">]])</span>
<span class="go">SireMol::SelectorM&lt;SireMol::Atom&gt;( size=358</span>
<span class="go">0: MolNum(6) Atom( HH31:1  [  18.45,    3.49,   12.44] )</span>
<span class="go">1: MolNum(6) Atom( CH3:2   [  18.98,    3.45,   13.39] )</span>
<span class="go">2: MolNum(6) Atom( HH32:3  [  20.05,    3.63,   13.29] )</span>
<span class="go">3: MolNum(6) Atom( HH33:4  [  18.80,    2.43,   13.73] )</span>
<span class="go">4: MolNum(6) Atom( C:5     [  18.48,    4.55,   14.35] )</span>
<span class="go">...</span>
<span class="go">353: MolNum(630) Atom( H1:1893 [  14.92,    1.28,   17.05] )</span>
<span class="go">354: MolNum(630) Atom( H2:1894 [  15.19,   -0.21,   17.07] )</span>
<span class="go">355: MolNum(623) Atom( O:1907  [  21.65,    7.88,    9.79] )</span>
<span class="go">356: MolNum(623) Atom( H1:1908 [  22.33,    8.56,    9.83] )</span>
<span class="go">357: MolNum(623) Atom( H2:1909 [  21.07,    8.08,   10.53] )</span>
<span class="go">)</span>
</pre></div>
</div>
</section>
<section id="distance-or-bond-restraints">
<h2>Distance or Bond Restraints<a class="headerlink" href="#distance-or-bond-restraints" title="Link to this heading">#</a></h2>
<p>The <a class="reference internal" href="../../api/restraints.html#sire.restraints.distance" title="sire.restraints.distance"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.restraints.distance()</span></code></a> or <a class="reference internal" href="../../api/restraints.html#sire.restraints.bond" title="sire.restraints.bond"><code class="xref py py-func docutils literal notranslate"><span class="pre">sire.restraints.bond()</span></code></a> functions
are used to create bond or distance restraints. These are identical restraints,
so the functions are just synonyms of each other (they are the same function
with different names).</p>
<p>These functions take the set of molecules or system you want to simulate,
plus two search strings, lists of atom indexes, or molecule views holding
the pairs of atoms that you want to restrain, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">atoms0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atoms1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">restraints</span><span class="p">)</span>
<span class="go">BondRestraints( size=1</span>
<span class="go">0: BondRestraint( 0 &lt;=&gt; 1, k=150 kcal mol-1 Å-2 : r0=1.09 Å )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>or</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">bond</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">atoms0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atoms1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">restraints</span><span class="p">)</span>
<span class="go">BondRestraints( size=1</span>
<span class="go">0: BondRestraint( 0 &lt;=&gt; 1, k=150 kcal mol-1 Å-2 : r0=1.09 Å )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>creates a single harmonic distance (or bond) restraint that acts between
atoms 0 and 1. By default, the equilibrium distance (r0) is the current
distance between the atoms (1.09 Å), and the force constant (k) is
150 kcal mol-1 Å-2.</p>
<p>You can set these via the <code class="docutils literal notranslate"><span class="pre">k</span></code> and <code class="docutils literal notranslate"><span class="pre">r0</span></code> arguments, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">bond</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">atoms0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">atoms1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">k</span><span class="o">=</span><span class="s2">&quot;100 kcal mol-1 A-2&quot;</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="s2">&quot;1.5 A&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">restraints</span><span class="p">)</span>
<span class="go">BondRestraints( size=1</span>
<span class="go">0: BondRestraint( 0 &lt;=&gt; 1, k=100 kcal mol-1 Å-2 : r0=1.5 Å )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>You can specify as many atoms pairs as you like, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">bond</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">atoms0</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">atoms1</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">restraints</span><span class="p">)</span>
<span class="go">BondRestraints( size=3</span>
<span class="go">0: BondRestraint( 0 &lt;=&gt; 3, k=150 kcal mol-1 Å-2 : r0=1.71245 Å )</span>
<span class="go">1: BondRestraint( 1 &lt;=&gt; 4, k=150 kcal mol-1 Å-2 : r0=1.54643 Å )</span>
<span class="go">2: BondRestraint( 2 &lt;=&gt; 5, k=150 kcal mol-1 Å-2 : r0=2.48642 Å )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>You can specify the atoms using a search string, passing the atoms themselves,
or using the atom index, just as you could for the positional restraints.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">bond</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span>
<span class="gp">... </span>                                <span class="n">atoms0</span><span class="o">=</span><span class="n">mols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                                <span class="n">atoms1</span><span class="o">=</span><span class="n">mols</span><span class="p">[</span><span class="s2">&quot;water and element O&quot;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">restraints</span><span class="p">)</span>
<span class="go">BondRestraints( size=630</span>
<span class="go">0: BondRestraint( 0 &lt;=&gt; 22, k=150 kcal mol-1 Å-2 : r0=13.2847 Å )</span>
<span class="go">1: BondRestraint( 0 &lt;=&gt; 25, k=150 kcal mol-1 Å-2 : r0=10.8445 Å )</span>
<span class="go">2: BondRestraint( 0 &lt;=&gt; 28, k=150 kcal mol-1 Å-2 : r0=15.9183 Å )</span>
<span class="go">3: BondRestraint( 0 &lt;=&gt; 31, k=150 kcal mol-1 Å-2 : r0=13.5108 Å )</span>
<span class="go">4: BondRestraint( 0 &lt;=&gt; 34, k=150 kcal mol-1 Å-2 : r0=9.18423 Å )</span>
<span class="go">...</span>
<span class="go">625: BondRestraint( 0 &lt;=&gt; 1897, k=150 kcal mol-1 Å-2 : r0=9.52934 Å )</span>
<span class="go">626: BondRestraint( 0 &lt;=&gt; 1900, k=150 kcal mol-1 Å-2 : r0=12.7207 Å )</span>
<span class="go">627: BondRestraint( 0 &lt;=&gt; 1903, k=150 kcal mol-1 Å-2 : r0=10.8053 Å )</span>
<span class="go">628: BondRestraint( 0 &lt;=&gt; 1906, k=150 kcal mol-1 Å-2 : r0=6.04142 Å )</span>
<span class="go">629: BondRestraint( 0 &lt;=&gt; 1909, k=150 kcal mol-1 Å-2 : r0=17.1035 Å )</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the number of atoms in <code class="docutils literal notranslate"><span class="pre">atoms0</span></code> and <code class="docutils literal notranslate"><span class="pre">atoms1</span></code> are not equal, then
the smaller list will be extended to match by appending multiple copies
of the last atom. In this case, this duplicates the single atom in
<code class="docutils literal notranslate"><span class="pre">atoms0</span></code>, meaning that this has created distance restraints between
the first atom in the first molecule and the oxygen atoms in all of
the water molecules.</p>
</div>
</section>
<section id="using-restraints-in-minimisation-or-dynamics">
<h2>Using restraints in minimisation or dynamics<a class="headerlink" href="#using-restraints-in-minimisation-or-dynamics" title="Link to this heading">#</a></h2>
<p>You can use restraints in a minimisation or dynamics simulation by
passing them in via the <code class="docutils literal notranslate"><span class="pre">restraints</span></code> argument, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">positional</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="s2">&quot;resname ALA and element C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="s2">&quot;4fs&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="s2">&quot;25oC&quot;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">restraints</span><span class="o">=</span><span class="n">restraints</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;10ps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>runs a dynamics simulation using positional restraints on the carbon atoms
of the <code class="docutils literal notranslate"><span class="pre">ALA</span></code> residue, while</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">atoms0</span><span class="o">=</span><span class="n">mols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                                    <span class="n">atoms1</span><span class="o">=</span><span class="n">mols</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">r0</span><span class="o">=</span><span class="s2">&quot;5 A&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">minimisation</span><span class="p">(</span><span class="n">restraints</span><span class="o">=</span><span class="n">restraints</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>performs a minimisation where a distance restraint is applied between the
first atoms of the first two molecules, pulling them to be 5 Å apart.</p>
<p>You can pass in a list of restraints, meaning that you can use as
many as you wish during a simulation.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pos_rests</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">positional</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="s2">&quot;resname ALA and element C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst_rests</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="n">atoms0</span><span class="o">=</span><span class="n">mols</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">atoms1</span><span class="o">=</span><span class="n">mols</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">minimisation</span><span class="p">(</span><span class="n">restraints</span><span class="o">=</span><span class="p">[</span><span class="n">pos_rests</span><span class="p">,</span> <span class="n">dst_rests</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">()</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="s2">&quot;4fs&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="s2">&quot;25oC&quot;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">restraints</span><span class="o">=</span><span class="p">[</span><span class="n">pos_rests</span><span class="p">,</span> <span class="n">dst_rests</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;10ps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is a good idea to run minimisation before dynamics whenever you add
restraints to a system. This is because the restraints could put a lot
of energy into the system, causing blow-ups or <code class="docutils literal notranslate"><span class="pre">NaN</span></code> errors.</p>
</div>
</section>
<section id="using-restraints-in-the-low-level-api">
<h2>Using restraints in the low-level API<a class="headerlink" href="#using-restraints-in-the-low-level-api" title="Link to this heading">#</a></h2>
<p>You can use restraints in the low-level API by passing them in as a
<code class="docutils literal notranslate"><span class="pre">map</span></code> parameter using the key <code class="docutils literal notranslate"><span class="pre">restraints</span></code>, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">omm</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">convert</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span> <span class="s2">&quot;openmm&quot;</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="nb">map</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;restraints&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">pos_rests</span><span class="p">,</span> <span class="n">dst_rests</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">omm</span><span class="p">)</span>
<span class="go">openmm::Context( num_atoms=1915 integrator=VerletIntegrator timestep=1.0 fs platform=HIP )</span>
</pre></div>
</div>
<p>More information about the mappable options for the low-level API can be
found in the <a class="reference internal" href="../../cheatsheet/openmm.html"><span class="doc">detailed guide</span></a>.</p>
</section>
<section id="fixing-atoms-in-place">
<h2>Fixing atoms in place<a class="headerlink" href="#fixing-atoms-in-place" title="Link to this heading">#</a></h2>
<p>As well as restraining atoms, you also have the option of fixing atoms in
space during the simulation. Atoms which are fixed are not moved by
minimisation or the dynamics integrator. This can be useful if you, e.g.
want to freeze atoms outside a radius of a ligand binding site, or if you
want to minimise the solvent while keeping the solute fixed.</p>
<p>You can fix atoms by passing in the set of atoms to fix as the
<code class="docutils literal notranslate"><span class="pre">fixed</span></code> argument to the <a class="reference internal" href="../../api/mol.html#sire.mol.SelectorMol.minimisation" title="sire.mol.SelectorMol.minimisation"><code class="xref py py-meth docutils literal notranslate"><span class="pre">minimisation()</span></code></a> or
<a class="reference internal" href="../../api/mol.html#sire.mol.SelectorMol.dynamics" title="sire.mol.SelectorMol.dynamics"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dynamics()</span></code></a> functions, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">tutorial_url</span><span class="p">,</span> <span class="s2">&quot;ala.top&quot;</span><span class="p">,</span> <span class="s2">&quot;ala.crd&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="s2">&quot;4fs&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="s2">&quot;25oC&quot;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">fixed</span><span class="o">=</span><span class="n">mols</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;10ps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>will run dynamics where all of the atoms in <code class="docutils literal notranslate"><span class="pre">mols[0]</span></code> (the solute)
are fixed. You can pass in a molecular container containing all of the
atoms that should be fixed, or a search string, or the atom indexes
of the atoms. Here,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="s2">&quot;1fs&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="s2">&quot;25oC&quot;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">fixed</span><span class="o">=</span><span class="s2">&quot;element C&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;10ps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>we have run dynamics where all of the carbon atoms are fixed, while</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="s2">&quot;1fs&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="s2">&quot;25oC&quot;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">fixed</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;10ps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>would run dynamics where atoms at indicies 0, 2, 4, 6 and 8 are fixed.</p>
<p>You could even use search strings to fix atoms by distances. If you do this,
it is best to also add half-harmonic positional restraints that hold nearby
molecules within the sphere of mobile atoms, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">center</span> <span class="o">=</span> <span class="n">mols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radius</span> <span class="o">=</span> <span class="s2">&quot;10 A&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">restraints</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">restraints</span><span class="o">.</span><span class="n">positional</span><span class="p">(</span><span class="n">mols</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">atoms</span><span class="o">=</span><span class="n">mols</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;molecules within 10 of </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">],</span>
<span class="gp">... </span>                                      <span class="n">position</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">r0</span><span class="o">=</span><span class="n">radius</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">mols</span><span class="o">.</span><span class="n">dynamics</span><span class="p">(</span><span class="n">timestep</span><span class="o">=</span><span class="s2">&quot;1fs&quot;</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="s2">&quot;25oC&quot;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">fixed</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;not molecules within </span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">center</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;10ps&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<p>This implements the restraints in OpenMM by setting the masses of the fixed
atoms to zero. This signals the OpenMM integrator to skip over these
atoms and not move them.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Be careful using constraints with fixed atoms. If a constraint involves
a fixed atom and a mobile atom, then there is a high risk that the
constraint won’t be able to be satisfied during dynamics, and
<code class="docutils literal notranslate"><span class="pre">Particle</span> <span class="pre">coordinate</span> <span class="pre">is</span> <span class="pre">NaN</span></code> error or similar will occur.
It it safest to use a small timestep (e.g. 1 fs) when constraining
only parts of molecules.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While the fixed atoms are not moved by the integrator, they are still
included in the energy calculation. This means that the computational
cost of the simulation will still be high, and also that energies
will not be conserved. Make sure you use an integrator that provides
a heat bath (e.g. NVT or NPT integrators).</p>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="04_alchemical_restraints.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Alchemical Restraints</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="02_alchemical_dynamics.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Alchemical Dynamics</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Dec 15, 2023</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Restraints</a><ul>
<li><a class="reference internal" href="#positional-restraints">Positional Restraints</a></li>
<li><a class="reference internal" href="#distance-or-bond-restraints">Distance or Bond Restraints</a></li>
<li><a class="reference internal" href="#using-restraints-in-minimisation-or-dynamics">Using restraints in minimisation or dynamics</a></li>
<li><a class="reference internal" href="#using-restraints-in-the-low-level-api">Using restraints in the low-level API</a></li>
<li><a class="reference internal" href="#fixing-atoms-in-place">Fixing atoms in place</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=1b6071b6"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../../_static/js/custom.js?v=c9df2d0f"></script>
    </body>
</html>