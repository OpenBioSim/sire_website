<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Measuring Energies" href="03_energies.html" /><link rel="prev" title="Measuring Distances and Angles" href="01_measure.html" />

    <!-- Generated with Sphinx 5.3.0 and Furo 2022.12.07 -->
        <title>Measuring Trajectories - openbiosim - sire</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom_fonts.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom_style.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom_pygments.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --font-stack: Changa, sans-serif;
  --font-stack--monospace: Roboto Mono, monospace;
  --color-foreground-primary: #dddddd;
  --color-foreground-secondary: #cccccc;
  --color-foreground-muted: #d0d0d0;
  --color-foreground-border: #923eb1;
  --color-background-primary: #160f30;
  --color-background-secondary: #201146;
  --color-background-hover: #4f4fb0;
  --color-background-hover--transparent: #4f4fb000;
  --color-background-border: #403333;
  --color-background-item: #411a30;
  --color-announcement-background: #000000dd;
  --color-announcement-text: #eeebee;
  --color-admonition-title-background--note: #FFFFFF33;
  --color-admonition-title-background--warning: #FF000033;
  --color-admonition-background: #FFFFFF11;
  --color-brand-primary: #eeeeee;
  --color-brand-content: #00dfef;
  --color-highlight-on-target: #333300;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">openbiosim - sire</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div>
<div class="sidebar-search">
  <div class="version_container">
    <div class="version_label">Branch</div>
    <div id="version_box" class="version_box"></div>
  </div>
</div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart/index.html">Quick Start Guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">Tutorial</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part01.html">Part 1 - Loading and Saving</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part01/01_importing_sire.html">Importing sire</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/02_loading_a_molecule.html">Loading a molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/03_simple_indexing.html">Simple indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/04_saving_a_molecule.html">Saving a molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/05_loading_from_multiple_files.html">Loading from multiple files</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part01/06_supported_file_formats.html">Supported file formats</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part02.html">Part 2 - Indexing and Searching</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part02/01_indexing_atoms.html">Indexing Atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/02_indexing_residues.html">Indexing Residues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/03_indexing_chains.html">Indexing Chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/04_indexing_segments.html">Indexing Segments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/05_indexing_molecules.html">Indexing Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/06_indexing_bonds.html">Indexing Bonds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/07_indexing_angles.html">Indexing Angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/08_indexing_dihedrals.html">Indexing Dihedrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/09_indexing_impropers.html">Indexing Impropers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part02/10_searching.html">Searching</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../index_part03.html">Part 3 - Molecular Properties</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../part03/01_atom_properties.html">Atom Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/02_cursors.html">Cursors and Editing Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/03_residue_properties.html">Residue, Chain and Segment Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/04_molecule_properties.html">Molecule Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/05_bond_properties.html">Bond Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/06_angle_properties.html">Angle Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/07_dihedral_properties.html">Dihedral Views and Properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../part03/08_improper_properties.html">Improper Views and Properties</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../index_part04.html">Part 4 - Measurement, Trajectories and Movement</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="01_measure.html">Measuring Distances and Angles</a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#">Measuring Trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="03_energies.html">Measuring Energies</a></li>
<li class="toctree-l3"><a class="reference internal" href="04_energy_trajectories.html">Measuring Energies Across Trajectories</a></li>
<li class="toctree-l3"><a class="reference internal" href="05_movement.html">Moving Atoms and Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="06_move_internals.html">Moving Bonds, Angles and Dihedrals</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cheatsheet/index.html">Detailed Guides</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cheatsheet/search.html">Searching</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/index.html">Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api/sire.html">sire module</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/sire_modules.html">Sub-modules</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_base.html">sire.base</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/base.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_cas.html">sire.cas</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/cas.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_io.html">sire.io</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/io.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_maths.html">sire.maths</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/maths.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_mm.html">sire.mm</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/mm.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_mol.html">sire.mol</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/mol.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_search.html">sire.search</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/search.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_stream.html">sire.stream</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/stream.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_system.html">sire.system</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/system.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_units.html">sire.units</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/units.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_utils.html">sire.utils</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/utils.html">Public API</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/index_vol.html">sire.vol</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/vol.html">Public API</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">How to ask for help</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../contributing/index.html">Contributing</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/development.html">Developer’s guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/codestyle.html">Coding Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/packaging.html">Packaging releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/roadmap.html">Roadmap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html">Contributors</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../code_of_conduct.html">Code of Conduct</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgements.html">Acknowledgements</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="measuring-trajectories">
<h1>Measuring Trajectories<a class="headerlink" href="#measuring-trajectories" title="Permalink to this heading">#</a></h1>
<p>Sire has in-built support for trajectories. This allows you to measure
bonds, angles, dihedrals and other properties for across a range of
frames of a trajectory. This can be useful to see how these measurements
changed during, e.g. a molecular dynamics simulation.</p>
<p>For example, let’s load a trajectory contained in a DCD file.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sire</span> <span class="k">as</span> <span class="nn">sr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">tutorial_url</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;h7n9.pdb&quot;</span><span class="p">,</span> <span class="s2">&quot;h7n9.dcd&quot;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">mols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">num_frames</span><span class="p">())</span>
<span class="go">501</span>
</pre></div>
</div>
<p>You load trajectories in the same way as you load any other molecular file
in Sire. Just add the trajectory file (here <code class="docutils literal notranslate"><span class="pre">h7n9.dcd</span></code>) to the list of
files to load. The file type will be determined automatically, and the
trajectory frames loaded in order (e.g. if you pass in multiple trajectory
files to load).</p>
<p>Sire recognises two main types of molecular data;</p>
<ol class="arabic simple">
<li><p>Topology data - this is information about the structure or topology
of the molecules, e.g. how the atoms divide into residues, and how
these divide across molecules.</p></li>
<li><p>Frame data - this is information that is specific to an individual
trajectory frame, e.g. coordinates, velocities, space and time
information.</p></li>
</ol>
<p>Individual molecular input files contain topology data and/or frame data.
In this case, <code class="docutils literal notranslate"><span class="pre">h7n9.pdb</span></code> contains both topology and frame data, while
<code class="docutils literal notranslate"><span class="pre">h7n9.dcd</span></code> contains just frame data.</p>
<p>Sire will load the topology information from the first file in the list
of files that contains topology information (e.g. <code class="docutils literal notranslate"><span class="pre">h7n9.pdb</span></code>). It will
then load frames in order from all files that contain frame data
(so both <code class="docutils literal notranslate"><span class="pre">h7n9.pdb</span></code> and <code class="docutils literal notranslate"><span class="pre">h7n9.dcd</span></code>).</p>
<p>In this case, 501 frames have been loaded. These are the one frame from
<code class="docutils literal notranslate"><span class="pre">h7n9.pdb</span></code>, which is the first frame. And then the next 500 frames
are the five hundred loaded from <code class="docutils literal notranslate"><span class="pre">h7n9.dcd</span></code>.</p>
<p>In many cases you would only want to analyse the trajectory data contained
in the DCD file, and would not be interested in the frame data from the
PDB file. We can remove this frame data using the <code class="docutils literal notranslate"><span class="pre">delete_frame</span></code> function,
e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span><span class="o">.</span><span class="n">delete_frame</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">num_frames</span><span class="p">())</span>
<span class="go">500</span>
</pre></div>
</div>
<section id="iterating-over-trajectories">
<h2>Iterating over trajectories<a class="headerlink" href="#iterating-over-trajectories" title="Permalink to this heading">#</a></h2>
<p>You iterate over the frames in a trajectory using a
<a class="reference internal" href="../../api/mol.html#sire.mol.TrajectoryIterator" title="sire.mol.TrajectoryIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">sire.mol.TrajectoryIterator</span></code></a> that is returned by the
<code class="docutils literal notranslate"><span class="pre">.trajectory()</span></code> function.</p>
<p>For example, here we will iterate over all 500 frames and just print
out the first atom of the molecule.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">trajectory</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Atom( N:1     [  15.62,   42.18,   15.18] )</span>
<span class="go">Atom( N:1     [  15.24,   43.24,   15.65] )</span>
<span class="go">Atom( N:1     [  15.05,   42.39,   15.22] )</span>
<span class="go">Atom( N:1     [  16.16,   41.74,   14.25] )</span>
<span class="go">Atom( N:1     [  16.62,   41.16,   15.16] )</span>
<span class="go">Atom( N:1     [  14.37,   42.47,   15.84] )</span>
<span class="go">Atom( N:1     [  16.63,   42.29,   13.91] )</span>
<span class="gp">... </span><span class="n">etc</span><span class="o">.</span>
</pre></div>
</div>
<p>You can call <code class="docutils literal notranslate"><span class="pre">.trajectory()</span></code> to iterate over any view of a molecule
(or views of molecules). For example, we could loop over the first
atom directly,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">atom_frame</span> <span class="ow">in</span> <span class="n">mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">trajectory</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">atom_frame</span><span class="p">)</span>
<span class="go">Atom( N:1     [  15.62,   42.18,   15.18] )</span>
<span class="go">Atom( N:1     [  15.24,   43.24,   15.65] )</span>
<span class="go">Atom( N:1     [  15.05,   42.39,   15.22] )</span>
<span class="go">Atom( N:1     [  16.16,   41.74,   14.25] )</span>
<span class="go">Atom( N:1     [  16.62,   41.16,   15.16] )</span>
<span class="go">Atom( N:1     [  14.37,   42.47,   15.84] )</span>
<span class="go">Atom( N:1     [  16.63,   42.29,   13.91] )</span>
<span class="gp">... </span><span class="n">etc</span><span class="o">.</span>
</pre></div>
</div>
<p>or we could loop over the frames of the first residue, print out
its center of mass coordinates;</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">res_frame</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">residue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">trajectory</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">res_frame</span><span class="p">,</span> <span class="n">res_frame</span><span class="o">.</span><span class="n">coordinates</span><span class="p">())</span>
<span class="go">Residue( ARG:1   num_atoms=26 ) ( 14.7759 Å, 42.2632 Å, 18.201 Å )</span>
<span class="go">Residue( ARG:1   num_atoms=26 ) ( 14.368 Å, 43.886 Å, 18.7757 Å )</span>
<span class="go">Residue( ARG:1   num_atoms=26 ) ( 14.3506 Å, 42.9594 Å, 18.359 Å )</span>
<span class="go">Residue( ARG:1   num_atoms=26 ) ( 15.4561 Å, 41.4458 Å, 17.4479 Å )</span>
<span class="go">Residue( ARG:1   num_atoms=26 ) ( 15.3717 Å, 41.1966 Å, 18.1695 Å )</span>
<span class="go">Residue( ARG:1   num_atoms=26 ) ( 13.4568 Å, 43.847 Å, 18.778 Å )</span>
<span class="go">Residue( ARG:1   num_atoms=26 ) ( 15.1335 Å, 43.0555 Å, 17.4046 Å )</span>
<span class="go">etc.</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../../api/mol.html#sire.mol.TrajectoryIterator" title="sire.mol.TrajectoryIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrajectoryIterator</span></code></a> is itself indexable. This allows
you to slice the frames that are iterated over. Here, we will iterate
over just the first 5 frames of the trajectory</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">res_frame</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">residue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">res_frame</span><span class="p">,</span> <span class="n">res_frame</span><span class="o">.</span><span class="n">coordinates</span><span class="p">())</span>
<span class="go">Residue( ARG:1   num_atoms=26 ) ( 14.7759 Å, 42.2632 Å, 18.201 Å )</span>
<span class="go">Residue( ARG:1   num_atoms=26 ) ( 14.368 Å, 43.886 Å, 18.7757 Å )</span>
<span class="go">Residue( ARG:1   num_atoms=26 ) ( 14.3506 Å, 42.9594 Å, 18.359 Å )</span>
<span class="go">Residue( ARG:1   num_atoms=26 ) ( 15.4561 Å, 41.4458 Å, 17.4479 Å )</span>
<span class="go">Residue( ARG:1   num_atoms=26 ) ( 15.3717 Å, 41.1966 Å, 18.1695 Å )</span>
</pre></div>
</div>
</section>
<section id="measuring-bond-lengths-over-a-trajectory">
<h2>Measuring bond lengths over a trajectory<a class="headerlink" href="#measuring-bond-lengths-over-a-trajectory" title="Permalink to this heading">#</a></h2>
<p>Bonds, Angles, Dihedrals and Impropers are also molecular views,
and so you can iterate over their trajectories in the same way.</p>
<p>For example, the <code class="docutils literal notranslate"><span class="pre">H7N9</span></code> protein contains a number of disulfide bonds.</p>
<p>We can find these bonds using</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">bonds</span><span class="p">(</span><span class="s2">&quot;element S&quot;</span><span class="p">,</span> <span class="s2">&quot;element S&quot;</span><span class="p">))</span>
<span class="go">SelectorBond( size=9</span>
<span class="go">0: Bond( SG:177 =&gt; SG:5098 )</span>
<span class="go">1: Bond( SG:672 =&gt; SG:735 )</span>
<span class="go">2: Bond( SG:1479 =&gt; SG:1736 )</span>
<span class="go">3: Bond( SG:1586 =&gt; SG:2317 )</span>
<span class="go">4: Bond( SG:2343 =&gt; SG:2407 )</span>
<span class="go">5: Bond( SG:3041 =&gt; SG:3217 )</span>
<span class="go">6: Bond( SG:3062 =&gt; SG:3193 )</span>
<span class="go">7: Bond( SG:3641 =&gt; SG:3905 )</span>
<span class="go">8: Bond( SG:5163 =&gt; SG:5600 )</span>
<span class="go">)</span>
</pre></div>
</div>
<p>We can iterate over the trajectory frames for these bonds, and then
measure them. For example, lets iterate over the first ten frames of the
first <code class="docutils literal notranslate"><span class="pre">S-S</span></code> bond, and print it’s length.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">bond_frame</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">bonds</span><span class="p">(</span><span class="s2">&quot;element S&quot;</span><span class="p">,</span> <span class="s2">&quot;element S&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">bond_frame</span><span class="p">,</span> <span class="n">bond_frame</span><span class="o">.</span><span class="n">measure</span><span class="p">())</span>
<span class="go">Bond( SG:177 =&gt; SG:5098 ) 1.97428 Å</span>
<span class="go">Bond( SG:177 =&gt; SG:5098 ) 2.12148 Å</span>
<span class="go">Bond( SG:177 =&gt; SG:5098 ) 2.01916 Å</span>
<span class="go">Bond( SG:177 =&gt; SG:5098 ) 2.03011 Å</span>
<span class="go">Bond( SG:177 =&gt; SG:5098 ) 1.92681 Å</span>
<span class="go">Bond( SG:177 =&gt; SG:5098 ) 2.05971 Å</span>
<span class="go">Bond( SG:177 =&gt; SG:5098 ) 2.00386 Å</span>
<span class="go">Bond( SG:177 =&gt; SG:5098 ) 1.9727 Å</span>
<span class="go">Bond( SG:177 =&gt; SG:5098 ) 2.06847 Å</span>
<span class="go">Bond( SG:177 =&gt; SG:5098 ) 1.98437 Å</span>
</pre></div>
</div>
<p>We could have done this for all of the bonds, using…</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">bonds_frame</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">bonds</span><span class="p">(</span><span class="s2">&quot;element S&quot;</span><span class="p">,</span> <span class="s2">&quot;element S&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">bonds_frame</span><span class="p">,</span> <span class="n">bonds_frame</span><span class="o">.</span><span class="n">measures</span><span class="p">())</span>
<span class="go">SelectorBond( size=9</span>
<span class="go">0: Bond( SG:177 =&gt; SG:5098 )</span>
<span class="go">1: Bond( SG:672 =&gt; SG:735 )</span>
<span class="go">2: Bond( SG:1479 =&gt; SG:1736 )</span>
<span class="go">3: Bond( SG:1586 =&gt; SG:2317 )</span>
<span class="go">4: Bond( SG:2343 =&gt; SG:2407 )</span>
<span class="go">5: Bond( SG:3041 =&gt; SG:3217 )</span>
<span class="go">6: Bond( SG:3062 =&gt; SG:3193 )</span>
<span class="go">7: Bond( SG:3641 =&gt; SG:3905 )</span>
<span class="go">8: Bond( SG:5163 =&gt; SG:5600 )</span>
<span class="go">) [1.97428 Å, 2.03112 Å, 2.07281 Å, 2.0191 Å, 2.04427 Å, 2.06217 Å, 2.06375 Å, 1.98086 Å, 2.00846 Å]</span>
<span class="go">SelectorBond( size=9</span>
<span class="go">0: Bond( SG:177 =&gt; SG:5098 )</span>
<span class="go">1: Bond( SG:672 =&gt; SG:735 )</span>
<span class="go">2: Bond( SG:1479 =&gt; SG:1736 )</span>
<span class="go">3: Bond( SG:1586 =&gt; SG:2317 )</span>
<span class="go">4: Bond( SG:2343 =&gt; SG:2407 )</span>
<span class="go">5: Bond( SG:3041 =&gt; SG:3217 )</span>
<span class="go">6: Bond( SG:3062 =&gt; SG:3193 )</span>
<span class="go">7: Bond( SG:3641 =&gt; SG:3905 )</span>
<span class="go">8: Bond( SG:5163 =&gt; SG:5600 )</span>
<span class="go">) [2.12148 Å, 2.02085 Å, 2.01314 Å, 2.02394 Å, 2.03679 Å, 2.05127 Å, 2.13314 Å, 2.09479 Å, 2.01281 Å]</span>
<span class="go">SelectorBond( size=9</span>
<span class="go">0: Bond( SG:177 =&gt; SG:5098 )</span>
<span class="go">1: Bond( SG:672 =&gt; SG:735 )</span>
<span class="go">2: Bond( SG:1479 =&gt; SG:1736 )</span>
<span class="go">3: Bond( SG:1586 =&gt; SG:2317 )</span>
<span class="go">4: Bond( SG:2343 =&gt; SG:2407 )</span>
<span class="go">5: Bond( SG:3041 =&gt; SG:3217 )</span>
<span class="go">6: Bond( SG:3062 =&gt; SG:3193 )</span>
<span class="go">7: Bond( SG:3641 =&gt; SG:3905 )</span>
<span class="go">8: Bond( SG:5163 =&gt; SG:5600 )</span>
<span class="go">) [2.01916 Å, 2.07407 Å, 2.13044 Å, 2.05 Å, 1.94306 Å, 2.02388 Å, 1.99157 Å, 2.0498 Å, 2.11982 Å]</span>
<span class="go">etc...</span>
</pre></div>
</div>
<p>…but you can see that we quickly reach the limit of what can sensibly
be printed to the screen.</p>
</section>
<section id="creating-tables-of-measurements-using-pandas">
<h2>Creating tables of measurements using pandas<a class="headerlink" href="#creating-tables-of-measurements-using-pandas" title="Permalink to this heading">#</a></h2>
<p>To make things easier, the <code class="docutils literal notranslate"><span class="pre">.measures()</span></code> function on the
<a class="reference internal" href="../../api/mol.html#sire.mol.TrajectoryIterator" title="sire.mol.TrajectoryIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrajectoryIterator</span></code></a> will calculate all of the measures
across all of its frames, and will return the result as a dictionary.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">measurements</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">bonds</span><span class="p">(</span><span class="s2">&quot;element S&quot;</span><span class="p">,</span> <span class="s2">&quot;element S&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()</span><span class="o">.</span><span class="n">measures</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span>
<span class="go">{&#39;frame&#39;: array([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,</span>
<span class="go">        13,  14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,</span>
<span class="go">        26,  27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,</span>
<span class="go">        39,  40,  41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,</span>
<span class="go">        52,  53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,</span>
<span class="go">        65,  66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,</span>
<span class="go">        78,  79,  80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,</span>
<span class="go">        91,  92,  93,  94,  95,  96,  97,  98,  99, 100, 101, 102, 103,</span>
<span class="go">       104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116,</span>
<span class="go">       117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129,</span>
<span class="go">etc.</span>
</pre></div>
</div>
<p>The dictionary is keyed using an identifier for each bond. The values
are numpy arrays containing the measurements for each frame.</p>
<p>The dictionary also has two additional columns; the first is the index of the
frame, using key <code class="docutils literal notranslate"><span class="pre">frame</span></code>, and the second is the time of the frame, using
the key <code class="docutils literal notranslate"><span class="pre">time</span></code>.</p>
<p>This format is compatible with most table-based data analysis libraries.
A popular library is pandas. You can create a pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> from
this data by passing it into the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> constructor, e.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">     frame   time  SG:177=&gt;SG:5098  ...  SG:3062=&gt;SG:3193  SG:3641=&gt;SG:3905  SG:5163=&gt;SG:5600</span>
<span class="go">0        0    0.0         2.072818  ...          2.062594          2.021098          1.999742</span>
<span class="go">1        1    0.0         1.974279  ...          2.063749          1.980860          2.008463</span>
<span class="go">2        2    1.0         2.121478  ...          2.133144          2.094789          2.012815</span>
<span class="go">3        3    2.0         2.019160  ...          1.991572          2.049796          2.119825</span>
<span class="go">4        4    3.0         2.030114  ...          2.007170          2.034407          2.025154</span>
<span class="go">..     ...    ...              ...  ...               ...               ...               ...</span>
<span class="go">496    496  495.0         2.007979  ...          2.093643          2.129553          1.998281</span>
<span class="go">497    497  496.0         2.090167  ...          2.059819          2.061035          2.062557</span>
<span class="go">498    498  497.0         2.002520  ...          2.033194          2.083489          2.018089</span>
<span class="go">499    499  498.0         1.982953  ...          2.060742          2.037879          2.028096</span>
<span class="go">500    500  499.0         2.031625  ...          1.980140          2.012541          2.056832</span>

<span class="go">[501 rows x 11 columns]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You may need to install pandas. You can do this with <code class="docutils literal notranslate"><span class="pre">conda</span></code> or <code class="docutils literal notranslate"><span class="pre">mamba</span></code>,
e.g. <code class="docutils literal notranslate"><span class="pre">mamba</span> <span class="pre">install</span> <span class="pre">pandas</span></code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can set the index of the dataframe to the <code class="docutils literal notranslate"><span class="pre">frame</span></code> column using
<code class="docutils literal notranslate"><span class="pre">df.set_index(&quot;frame&quot;)</span></code></p>
</div>
<p>To make things easier, you can also ask the <code class="docutils literal notranslate"><span class="pre">.measures()</span></code> function
to return the measurements as a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> by setting <code class="docutils literal notranslate"><span class="pre">to_pandas</span></code>
to <code class="docutils literal notranslate"><span class="pre">True</span></code>, e.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">bonds</span><span class="p">(</span><span class="s2">&quot;element S&quot;</span><span class="p">,</span> <span class="s2">&quot;element S&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()</span><span class="o">.</span><span class="n">measures</span><span class="p">(</span><span class="n">to_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">     frame   time  SG:177=&gt;SG:5098  ...  SG:3062=&gt;SG:3193  SG:3641=&gt;SG:3905  SG:5163=&gt;SG:5600</span>
<span class="go">0        0    0.0         2.072818  ...          2.062594          2.021098          1.999742</span>
<span class="go">1        1    0.0         1.974279  ...          2.063749          1.980860          2.008463</span>
<span class="go">2        2    1.0         2.121478  ...          2.133144          2.094789          2.012815</span>
<span class="go">3        3    2.0         2.019160  ...          1.991572          2.049796          2.119825</span>
<span class="go">4        4    3.0         2.030114  ...          2.007170          2.034407          2.025154</span>
<span class="go">..     ...    ...              ...  ...               ...               ...               ...</span>
<span class="go">496    496  495.0         2.007979  ...          2.093643          2.129553          1.998281</span>
<span class="go">497    497  496.0         2.090167  ...          2.059819          2.061035          2.062557</span>
<span class="go">498    498  497.0         2.002520  ...          2.033194          2.083489          2.018089</span>
<span class="go">499    499  498.0         1.982953  ...          2.060742          2.037879          2.028096</span>
<span class="go">500    500  499.0         2.031625  ...          1.980140          2.012541          2.056832</span>

<span class="go">[501 rows x 11 columns]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The returned dataframe has had the <code class="docutils literal notranslate"><span class="pre">frame</span></code> column set as the index.</p>
</div>
</section>
<section id="changing-the-units-of-measurement">
<h2>Changing the units of measurement<a class="headerlink" href="#changing-the-units-of-measurement" title="Permalink to this heading">#</a></h2>
<p>The values returned by the <code class="docutils literal notranslate"><span class="pre">.measures()</span></code> function are returned as
floating point numbers in the default unit for the measurement. In this
case, the values are in angstroms, as these are the default length unit.</p>
<p>You can change the default units using the functions in <a class="reference internal" href="../../api/units.html#module-sire.units" title="sire.units"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sire.units</span></code></a>,
e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">set_length_unit</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">picometer</span><span class="p">)</span>
</pre></div>
</div>
<p>would change the default length units to picometers. Now, the lengths
returned by the <code class="docutils literal notranslate"><span class="pre">.measurements()</span></code> function will be in picometers;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">bonds</span><span class="p">(</span><span class="s2">&quot;element S&quot;</span><span class="p">,</span> <span class="s2">&quot;element S&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()</span><span class="o">.</span><span class="n">measures</span><span class="p">(</span><span class="n">to_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">     SG:177=&gt;SG:5098  SG:672=&gt;SG:735  SG:1479=&gt;SG:1736  ...  SG:3062=&gt;SG:3193  SG:3641=&gt;SG:3905  SG:5163=&gt;SG:5600</span>
<span class="go">0         197.427854      203.111583        207.281272  ...        206.374869        198.086011        200.846281</span>
<span class="go">1         212.147805      202.084501        201.313832  ...        213.314379        209.478942        201.281457</span>
<span class="go">2         201.916013      207.407315        213.043633  ...        199.157224        204.979606        211.982462</span>
<span class="go">3         203.011406      205.894323        210.216122  ...        200.717000        203.440735        202.515447</span>
<span class="go">4         192.681088      214.281803        202.062654  ...        210.174159        209.797178        206.317985</span>
<span class="go">..               ...             ...               ...  ...               ...               ...               ...</span>
<span class="go">495       200.797944      203.558625        210.275560  ...        209.364316        212.955313        199.828136</span>
<span class="go">496       209.016654      200.201860        209.533046  ...        205.981879        206.103546        206.255705</span>
<span class="go">497       200.251952      203.760592        204.149639  ...        203.319428        208.348883        201.808935</span>
<span class="go">498       198.295320      210.827007        199.950224  ...        206.074165        203.787857        202.809601</span>
<span class="go">499       203.162451      204.721804        202.524174  ...        198.013967        201.254053        205.683203</span>

<span class="go">[500 rows x 9 columns]</span>
</pre></div>
</div>
<p>You can reset to default Sire units using</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sr</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">set_internal_units</span><span class="p">()</span>
</pre></div>
</div>
<p>and you can get the default unit for any dimension by calling <code class="docutils literal notranslate"><span class="pre">.get_default()</span></code>
on a unit of that dimension, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">picometer</span><span class="o">.</span><span class="n">get_default</span><span class="p">())</span>
<span class="go">1 Å</span>
</pre></div>
</div>
<p>The dataframe returned by the <code class="docutils literal notranslate"><span class="pre">.measures()</span></code> has been modified to have
additional functions to return the units.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">time_unit</span><span class="p">())</span>
<span class="go">ps</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">measure_unit</span><span class="p">())</span>
<span class="go">Å</span>
</pre></div>
</div>
</section>
<section id="accessing-measurement-data-by-column">
<h2>Accessing measurement data by column<a class="headerlink" href="#accessing-measurement-data-by-column" title="Permalink to this heading">#</a></h2>
<p>Pandas dataframes are great, because they give you a lot of power to
calculate averages and other statistical properties from the measurements.</p>
<p>For example the <code class="xref py py-func docutils literal notranslate"><span class="pre">describe()</span></code> function returns a
quick statistical summary for each column;</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">bonds</span><span class="p">(</span><span class="s2">&quot;element S&quot;</span><span class="p">,</span> <span class="s2">&quot;element S&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()</span><span class="o">.</span><span class="n">measures</span><span class="p">(</span><span class="n">to_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="go">            frame        time  SG:177=&gt;SG:5098  ...  SG:3062=&gt;SG:3193  SG:3641=&gt;SG:3905  SG:5163=&gt;SG:5600</span>
<span class="go">count  501.000000  501.000000       501.000000  ...        501.000000        501.000000        501.000000</span>
<span class="go">mean   250.000000  249.001996         2.035907  ...          2.038938          2.033885          2.042897</span>
<span class="go">std    144.770508  144.767061         0.042161  ...          0.039444          0.041783          0.043834</span>
<span class="go">min      0.000000    0.000000         1.906496  ...          1.889959          1.898634          1.898571</span>
<span class="go">25%    125.000000  124.000000         2.009903  ...          2.012715          2.005647          2.014213</span>
<span class="go">50%    250.000000  249.000000         2.036705  ...          2.038681          2.033499          2.044481</span>
<span class="go">75%    375.000000  374.000000         2.063463  ...          2.066688          2.059552          2.074039</span>
<span class="go">max    500.000000  499.000000         2.155093  ...          2.185094          2.156298          2.172513</span>

<span class="go">[8 rows x 11 columns]</span>
</pre></div>
</div>
<p>You can access individual columns of the table by their column name.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;SG:177=&gt;SG:5098&quot;</span><span class="p">])</span>
<span class="go">0      1.974279</span>
<span class="go">1      2.121478</span>
<span class="go">2      2.019160</span>
<span class="go">3      2.030114</span>
<span class="go">4      1.926811</span>
<span class="go">         ...</span>
<span class="go">495    2.007979</span>
<span class="go">496    2.090167</span>
<span class="go">497    2.002520</span>
<span class="go">498    1.982953</span>
<span class="go">499    2.031625</span>
<span class="go">Name: SG:177=&gt;SG:5098, Length: 500, dtype: float64</span>
</pre></div>
</div>
<p>The column name was generated by the <code class="xref py py-func docutils literal notranslate"><span class="pre">sire.colname()</span></code> function. This
function generates a column name from any molecular view, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">colname</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">bonds</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">N:1=&gt;H1:2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">colname</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">atoms</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">N:1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">colname</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">dihedrals</span><span class="p">()[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">H1:2&lt;=N:1=CA:5=&gt;HA:6</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These column names will only be unique if the combination of
atom name and atom number is unique within a molecule.</p>
</div>
<p>You get the column that corresponds to a particular bond by
calling <code class="xref py py-func docutils literal notranslate"><span class="pre">colname()</span></code> on that bond, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bonds</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">bonds</span><span class="p">(</span><span class="s2">&quot;element S&quot;</span><span class="p">,</span> <span class="s2">&quot;element S&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">bonds</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()</span><span class="o">.</span><span class="n">measures</span><span class="p">(</span><span class="n">to_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sr</span><span class="o">.</span><span class="n">colname</span><span class="p">(</span><span class="n">bonds</span><span class="p">[</span><span class="mi">3</span><span class="p">])]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="go">count    500.000000</span>
<span class="go">mean       2.036311</span>
<span class="go">std        0.042506</span>
<span class="go">min        1.907295</span>
<span class="go">25%        2.010268</span>
<span class="go">50%        2.038025</span>
<span class="go">75%        2.067480</span>
<span class="go">max        2.164251</span>
<span class="go">Name: SG:1586=&gt;SG:2317, dtype: float64</span>
</pre></div>
</div>
<p>You can also access multiple columns using the <code class="xref py py-func docutils literal notranslate"><span class="pre">sire.colnames()</span></code> function,</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">sr</span><span class="o">.</span><span class="n">colnames</span><span class="p">(</span><span class="n">bonds</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="go">       SG:177=&gt;SG:5098  SG:672=&gt;SG:735  SG:1479=&gt;SG:1736</span>
<span class="go">count       501.000000      501.000000        501.000000</span>
<span class="go">mean          2.035907        2.040398          2.039843</span>
<span class="go">std           0.042161        0.043430          0.042046</span>
<span class="go">min           1.906496        1.879551          1.900181</span>
<span class="go">25%           2.009903        2.010126          2.011865</span>
<span class="go">50%           2.036705        2.041413          2.042487</span>
<span class="go">75%           2.063463        2.068816          2.065570</span>
<span class="go">max           2.155093        2.157295          2.171668</span>
</pre></div>
</div>
</section>
<section id="plotting-measurements">
<h2>Plotting measurements<a class="headerlink" href="#plotting-measurements" title="Permalink to this heading">#</a></h2>
<p>Another benefit of using pandas is that you can take advantage of it
in-built plotting capabilities. If you are using a Jupyter notebook
then you can use <code class="xref py py-func docutils literal notranslate"><span class="pre">pandas.DataFrame.plot()</span></code> to generate in-line
plots.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can install jupyter using mamba via <code class="docutils literal notranslate"><span class="pre">mamba</span> <span class="pre">install</span> <span class="pre">jupyter</span> <span class="pre">jupyterlab</span></code>.
Once installed, you can start a jupyter lab instance by running
<code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">lab</span></code></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You must also install matplotlib if you want to use pandas to
generate plots. You can install matplotlib using the
command <code class="docutils literal notranslate"><span class="pre">mamba</span> <span class="pre">install</span> <span class="pre">matplotlib</span></code></p>
</div>
<p>For example, you could plot all of the bond lengths using</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">sr</span><span class="o">.</span><span class="n">colnames</span><span class="p">(</span><span class="n">bonds</span><span class="p">))</span>
</pre></div>
</div>
<img alt="Graph of all of the bond measurements" src="../../_images/04_02_01.jpg" />
<p>You could use the pandas plotting functions to make this a bit prettier, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">sr</span><span class="o">.</span><span class="n">colnames</span><span class="p">(</span><span class="n">bonds</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time / </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">time_unit</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Size / </span><span class="si">{</span><span class="n">df</span><span class="o">.</span><span class="n">measure_unit</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
</pre></div>
</div>
<img alt="Graph of all of the bond measurements in a prettier format." src="../../_images/04_02_02.jpg" />
<p>To make things easier, the above code is automatically added to the
dataframe returned by the <code class="docutils literal notranslate"><span class="pre">.measures()</span></code> function as
<code class="docutils literal notranslate"><span class="pre">df.pretty_plot()</span></code>, e.g.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pretty_plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Graph of all of the bond measurements in a prettier format." src="../../_images/04_02_02.jpg" />
<p>You can specify the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> columns to use, e.g. here
we plot the sizes of the first two bonds against frame index.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pretty_plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;frame&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">sr</span><span class="o">.</span><span class="n">colnames</span><span class="p">(</span><span class="n">bonds</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
<img alt="Graph of the first two bonds against time" src="../../_images/04_02_03.jpg" />
<p>You could also collapse this all down to a single line, e.g. here
plotting the first two bonds from every 20th frame of the trajectory;</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bonds</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()[</span><span class="mi">0</span><span class="p">::</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">measures</span><span class="p">(</span><span class="n">to_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">pretty_plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Graph of the first two bonds against time" src="../../_images/04_02_04.jpg" />
</section>
<section id="measuring-angles-dihedrals-and-impropers">
<h2>Measuring angles, dihedrals and impropers<a class="headerlink" href="#measuring-angles-dihedrals-and-impropers" title="Permalink to this heading">#</a></h2>
<p>You can measure angles, dihedrals and impropers across trajectories
in the same way that you do for bonds. Simply call the <code class="docutils literal notranslate"><span class="pre">.trajectory()</span></code>
function on the molecule view and then either iterate through the
frames manually…</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">angles</span><span class="p">(</span><span class="s2">&quot;element S&quot;</span><span class="p">,</span> <span class="s2">&quot;element S&quot;</span><span class="p">,</span> <span class="s2">&quot;element C&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">angles</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()[</span><span class="mi">0</span><span class="p">::</span><span class="mi">100</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">measures</span><span class="p">())</span>
<span class="go">SelectorAngle( size=3</span>
<span class="go">0: Angle( CB:174 &lt;= SG:177 =&gt; SG:5098 )</span>
<span class="go">1: Angle( SG:177 &lt;= SG:5098 =&gt; CB:5095 )</span>
<span class="go">2: Angle( CB:669 &lt;= SG:672 =&gt; SG:735 )</span>
<span class="go">) [100.647°, 107.789°, 102.658°]</span>
<span class="go">SelectorAngle( size=3</span>
<span class="go">0: Angle( CB:174 &lt;= SG:177 =&gt; SG:5098 )</span>
<span class="go">1: Angle( SG:177 &lt;= SG:5098 =&gt; CB:5095 )</span>
<span class="go">2: Angle( CB:669 &lt;= SG:672 =&gt; SG:735 )</span>
<span class="go">) [108.425°, 108.255°, 102.161°]</span>
<span class="go">SelectorAngle( size=3</span>
<span class="go">0: Angle( CB:174 &lt;= SG:177 =&gt; SG:5098 )</span>
<span class="go">1: Angle( SG:177 &lt;= SG:5098 =&gt; CB:5095 )</span>
<span class="go">2: Angle( CB:669 &lt;= SG:672 =&gt; SG:735 )</span>
<span class="go">) [107.449°, 103.456°, 106.716°]</span>
<span class="go">SelectorAngle( size=3</span>
<span class="go">0: Angle( CB:174 &lt;= SG:177 =&gt; SG:5098 )</span>
<span class="go">1: Angle( SG:177 &lt;= SG:5098 =&gt; CB:5095 )</span>
<span class="go">2: Angle( CB:669 &lt;= SG:672 =&gt; SG:735 )</span>
<span class="go">) [108.96°, 102.244°, 105.909°]</span>
<span class="go">SelectorAngle( size=3</span>
<span class="go">0: Angle( CB:174 &lt;= SG:177 =&gt; SG:5098 )</span>
<span class="go">1: Angle( SG:177 &lt;= SG:5098 =&gt; CB:5095 )</span>
<span class="go">2: Angle( CB:669 &lt;= SG:672 =&gt; SG:735 )</span>
<span class="go">) [113.027°, 101.141°, 110.331°]</span>
<span class="go">SelectorAngle( size=3</span>
<span class="go">0: Angle( CB:174 &lt;= SG:177 =&gt; SG:5098 )</span>
<span class="go">1: Angle( SG:177 &lt;= SG:5098 =&gt; CB:5095 )</span>
<span class="go">2: Angle( CB:669 &lt;= SG:672 =&gt; SG:735 )</span>
<span class="go">) [106.493°, 103.807°, 101.657°]</span>
</pre></div>
</div>
<p>…or use the <code class="docutils literal notranslate"><span class="pre">.measures()</span></code> function and convert to a pandas dataframe.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">angles</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()</span><span class="o">.</span><span class="n">measures</span><span class="p">(</span><span class="n">to_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">   frame   time  CB:174&lt;=SG:177=&gt;SG:5098  SG:177&lt;=SG:5098=&gt;CB:5095  CB:669&lt;=SG:672=&gt;SG:735</span>
<span class="go">0        0    0.0               100.646778                107.789097              102.658280</span>
<span class="go">1        1    0.0               106.123591                102.032015              103.878155</span>
<span class="go">2        2    1.0               104.469532                 96.718841              106.618866</span>
<span class="go">3        3    2.0                96.850748                106.560527              109.500329</span>
<span class="go">4        4    3.0               111.521915                107.566346              102.349405</span>
<span class="go">..     ...    ...                      ...                       ...                     ...</span>
<span class="go">496    496  495.0               107.866246                101.751753              106.915247</span>
<span class="go">497    497  496.0               104.664555                105.813593              103.434050</span>
<span class="go">498    498  497.0                99.855355                103.378153              112.463535</span>
<span class="go">499    499  498.0               111.433986                105.148629              107.430144</span>
<span class="go">500    500  499.0               106.493204                103.807238              101.656993</span>

<span class="go">[501 rows x 5 columns]</span>
</pre></div>
</div>
<p>Plotting works in the same way too.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">angles</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()[</span><span class="mi">0</span><span class="p">::</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">measures</span><span class="p">(</span><span class="n">to_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">pretty_plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Graph of the first two bonds against time" src="../../_images/04_02_05.jpg" />
</section>
<section id="performing-arbitrary-measurements">
<h2>Performing arbitrary measurements<a class="headerlink" href="#performing-arbitrary-measurements" title="Permalink to this heading">#</a></h2>
<p>You can also perform arbitrary measurements across frames of
a trajectory. The simplest way to do this is to just iterate
over the desired frames. For example, lets calculate the distance
between the centers of mass of the first and last residues in
the molecule every 100 frames.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">residues</span> <span class="ow">in</span> <span class="n">mol</span><span class="o">.</span><span class="n">residues</span><span class="p">()</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()[</span><span class="mi">0</span><span class="p">::</span><span class="mi">100</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="n">sr</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">residues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">45.6897 Å</span>
<span class="go">43.1249 Å</span>
<span class="go">16.5617 Å</span>
<span class="go">48.1862 Å</span>
<span class="go">37.0401 Å</span>
<span class="go">60.8125 Å</span>
</pre></div>
</div>
<p>Another way to do this is to use the <code class="docutils literal notranslate"><span class="pre">.measures</span></code> function, this time
passing in the function to perform the measurement.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">residues</span><span class="p">()</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()</span><span class="o">.</span><span class="n">measures</span><span class="p">(</span>
<span class="gp">... </span>  <span class="k">lambda</span> <span class="n">residues</span><span class="p">:</span> <span class="n">sr</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">residues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
<span class="gp">... </span>  <span class="n">to_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="go">     frame   time     custom</span>
<span class="go">0        0    0.0  44.216253</span>
<span class="go">1        1    1.0  46.734178</span>
<span class="go">2        2    2.0  45.378243</span>
<span class="go">3        3    3.0  46.019010</span>
<span class="go">4        4    4.0  80.861715</span>
<span class="go">..     ...    ...        ...</span>
<span class="go">495    495  495.0  42.214334</span>
<span class="go">496    496  496.0  38.257463</span>
<span class="go">497    497  497.0  61.065931</span>
<span class="go">498    498  498.0  58.582622</span>
<span class="go">499    499  499.0  60.812486</span>

<span class="go">[500 rows x 3 columns]</span>
</pre></div>
</div>
<p>Notice how the custom measurement is placed into a column called
<code class="docutils literal notranslate"><span class="pre">custom</span></code>. You can control the name by passing in a dictionary
of column name / function pairs, e.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">residues</span><span class="p">()</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()</span><span class="o">.</span><span class="n">measures</span><span class="p">({</span>
<span class="gp">... </span>  <span class="s2">&quot;distance&quot;</span> <span class="p">:</span> <span class="k">lambda</span> <span class="n">residues</span><span class="p">:</span> <span class="n">sr</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">residues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
<span class="gp">... </span>  <span class="p">},</span> <span class="n">to_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="go">     frame   time   distance</span>
<span class="go">0        0    0.0  44.216253</span>
<span class="go">1        1    1.0  46.734178</span>
<span class="go">2        2    2.0  45.378243</span>
<span class="go">3        3    3.0  46.019010</span>
<span class="go">4        4    4.0  80.861715</span>
<span class="go">..     ...    ...        ...</span>
<span class="go">495    495  495.0  42.214334</span>
<span class="go">496    496  496.0  38.257463</span>
<span class="go">497    497  497.0  61.065931</span>
<span class="go">498    498  498.0  58.582622</span>
<span class="go">499    499  499.0  60.812486</span>

<span class="go">[500 rows x 3 columns]</span>
</pre></div>
</div>
<p>You can pass in as many column name / function pairs as you want to evaluate.
Here we will calculate the distance between the first and last residues,
and the distance between these two residues and the center of mass of the
molecule.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">residues</span><span class="p">()</span><span class="o">.</span><span class="n">trajectory</span><span class="p">()</span><span class="o">.</span><span class="n">measures</span><span class="p">({</span>
<span class="gp">... </span>  <span class="s2">&quot;distance&quot;</span> <span class="p">:</span> <span class="k">lambda</span> <span class="n">residues</span><span class="p">:</span> <span class="n">sr</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">residues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
<span class="gp">... </span>  <span class="s2">&quot;first_to_center&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">residues</span><span class="p">:</span> <span class="n">sr</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">residues</span><span class="o">.</span><span class="n">molecule</span><span class="p">()),</span>
<span class="gp">... </span>  <span class="s2">&quot;last_to_center&quot;</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">residues</span><span class="p">:</span> <span class="n">sr</span><span class="o">.</span><span class="n">measure</span><span class="p">(</span><span class="n">residues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">residues</span><span class="o">.</span><span class="n">molecule</span><span class="p">()),</span>
<span class="gp">... </span>  <span class="p">},</span> <span class="n">to_pandas</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="go">     frame   time   distance  first_to_center  last_to_center</span>
<span class="go">0        0    0.0  44.216253        25.547407       62.515619</span>
<span class="go">1        1    1.0  46.734178        25.095689       62.580996</span>
<span class="go">2        2    2.0  45.378243        25.544252       61.655505</span>
<span class="go">3        3    3.0  46.019010        26.016608       57.752940</span>
<span class="go">4        4    4.0  80.861715        25.535940       63.151461</span>
<span class="go">..     ...    ...        ...              ...             ...</span>
<span class="go">495    495  495.0  42.214334        26.030188       31.460664</span>
<span class="go">496    496  496.0  38.257463        26.851858       32.806361</span>
<span class="go">497    497  497.0  61.065931        27.685484       47.324784</span>
<span class="go">498    498  498.0  58.582622        26.512745       46.317341</span>
<span class="go">499    499  499.0  60.812486        26.131392       44.847973</span>

<span class="go">[500 rows x 5 columns]</span>
</pre></div>
</div>
<p>You can, of course, plot this just as you did for simple measurements.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">pretty_plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Graph of the first two bonds against time" src="../../_images/04_02_06.jpg" />
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="03_energies.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Measuring Energies</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="01_measure.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Measuring Distances and Angles</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Jan 09, 2023</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Measuring Trajectories</a><ul>
<li><a class="reference internal" href="#iterating-over-trajectories">Iterating over trajectories</a></li>
<li><a class="reference internal" href="#measuring-bond-lengths-over-a-trajectory">Measuring bond lengths over a trajectory</a></li>
<li><a class="reference internal" href="#creating-tables-of-measurements-using-pandas">Creating tables of measurements using pandas</a></li>
<li><a class="reference internal" href="#changing-the-units-of-measurement">Changing the units of measurement</a></li>
<li><a class="reference internal" href="#accessing-measurement-data-by-column">Accessing measurement data by column</a></li>
<li><a class="reference internal" href="#plotting-measurements">Plotting measurements</a></li>
<li><a class="reference internal" href="#measuring-angles-dihedrals-and-impropers">Measuring angles, dihedrals and impropers</a></li>
<li><a class="reference internal" href="#performing-arbitrary-measurements">Performing arbitrary measurements</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    <script src="../../_static/js/custom.js"></script>
    </body>
</html>